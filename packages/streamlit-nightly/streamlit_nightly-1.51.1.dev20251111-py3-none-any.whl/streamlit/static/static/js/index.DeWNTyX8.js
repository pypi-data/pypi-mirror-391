import{l as W,ak as _,s as $,r as a,a5 as q,u as G,a6 as H,e as K,j as u,Q as M,T as N,P as Q,W as J,$ as X}from"./index.DYhXnGrd.js";import{u as Y}from"./uniqueId.C5TjXzFq.js";import{I as Z}from"./InputInstructions.uVRDpXyr.js";import{u as tt}from"./useBasicWidgetState.BwrCWfLk.js";import{u as et,a as ot,b as it}from"./useUpdateUiValue.CrmWNRvq.js";import{u as at,T as st}from"./useTextInputAutoExpand.D5mVk0zp.js";import"./FormClearHelper.IrQMLaUB.js";import"./inputUtils.CptNuJwn.js";import"./base-input.NTfJQRys.js";const rt=(e,t)=>{let i="auto";if(e.heightConfig?.useStretch)i="100%";else if(e.heightConfig?.pixelHeight&&e.heightConfig.pixelHeight>0){const s=W(t.labelVisibility?.value)===_.Collapsed?2:30,l=e.heightConfig.pixelHeight-s;i=`${Math.max(0,l)}px`}return i},lt=$("div",{target:"e1r0q00f0"})({height:"100%",display:"flex",flexDirection:"column"}),S=(e,t)=>e.getStringValue(t)??t.default??null,nt=e=>e.default??null,dt=e=>e.value??null,ut=(e,t,i,s)=>{t.setStringValue(e,i.value,{fromUi:i.fromUi},s)},ct=({disabled:e,element:t,widgetMgr:i,fragmentId:s,outerElement:l})=>{const h=a.useRef(Y("text_area_")).current,{width:y,elementRef:I}=q(),[r,g]=a.useState(!1),[V,x]=a.useState(!1),n=l.heightConfig?.useContent??!1,v=l.heightConfig?.useStretch??!1,A=rt(l,t),C=a.useRef(null),[d,p]=a.useState(()=>S(i,t)??null),F=a.useCallback(()=>{p(t.default??null),g(!0)},[t]),[R,f]=tt({getStateFromWidgetMgr:S,getDefaultStateFromProto:nt,getCurrStateFromProto:dt,updateWidgetMgrState:ut,element:t,widgetMgr:i,fragmentId:s,onFormCleared:F});et(R,d,p,r);const o=G(),{height:k,maxHeight:L,updateScrollHeight:T}=at({textareaRef:C,dependencies:[t.placeholder]}),m=a.useCallback(()=>{g(!1),f({value:d,fromUi:!0})},[d,f]),P=a.useCallback(()=>{r&&m(),x(!1)},[r,m]),z=a.useCallback(()=>{x(!0)},[]),B=a.useCallback(()=>{n&&T()},[n,T]),D=ot({formId:t.formId,maxChars:t.maxChars,setDirty:g,setUiValue:p,setValueWithSource:f,additionalAction:B}),E=it(t.formId,m,r,i,s,!0),{placeholder:U,formId:b}=t,j=H({formId:b})?i.allowFormEnterToSubmit(b):r,w=V&&y>o.breakpoints.hideWidgetDetails;return K(lt,{className:"stTextArea","data-testid":"stTextArea",ref:I,children:[u(J,{label:t.label,disabled:e,labelVisibility:W(t.labelVisibility?.value),htmlFor:h,children:t.help&&u(M,{children:u(N,{content:t.help,placement:Q.TOP_RIGHT})})}),u(st,{inputRef:n?C:void 0,value:d??"",placeholder:U,onBlur:P,onFocus:z,onChange:D,onKeyDown:E,"aria-label":t.label,disabled:e,id:h,overrides:{Input:{style:{fontWeight:o.fontWeights.normal,lineHeight:o.lineHeights.inputWidget,height:n?k:A,maxHeight:n?L:"",minHeight:o.sizes.largestElementHeight,resize:v?"none":"vertical",paddingRight:o.spacing.md,paddingLeft:o.spacing.md,paddingBottom:o.spacing.md,paddingTop:o.spacing.md,"::placeholder":{color:o.colors.fadedText60}}},Root:{props:{"data-testid":"stTextAreaRootElement"},style:({$isFocused:O})=>{const c=X(o.colors,O);return{borderLeftWidth:o.sizes.borderWidth,borderRightWidth:o.sizes.borderWidth,borderTopWidth:o.sizes.borderWidth,borderBottomWidth:o.sizes.borderWidth,borderTopColor:c,borderRightColor:c,borderBottomColor:c,borderLeftColor:c,flexGrow:1}}}}}),w&&u(Z,{dirty:r,value:d??"",maxLength:t.maxChars,type:"multiline",inForm:H({formId:b}),allowEnterToSubmit:j})]})},Ht=a.memo(ct);export{Ht as default};
