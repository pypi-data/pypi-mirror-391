Metadata-Version: 2.4
Name: stegvault
Version: 0.3.2
Summary: Password manager using steganography to embed encrypted credentials in images
Author: StegVault Contributors
License: MIT
Project-URL: Homepage, https://github.com/kalashnikxvxiii-collab/stegvault
Project-URL: Repository, https://github.com/kalashnikxvxiii-collab/stegvault
Project-URL: Issues, https://github.com/kalashnikxvxiii-collab/stegvault/issues
Project-URL: Changelog, https://github.com/kalashnikxvxiii-collab/stegvault/blob/main/CHANGELOG.md
Keywords: steganography,password-manager,encryption,cryptography,security,LSB,XChaCha20-Poly1305,Argon2id
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: End Users/Desktop
Classifier: Topic :: Security :: Cryptography
Classifier: Topic :: Security
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Programming Language :: Python :: 3.14
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: PyNaCl>=1.5.0
Requires-Dist: argon2-cffi>=23.1.0
Requires-Dist: Pillow>=10.0.0
Requires-Dist: click>=8.1.0
Requires-Dist: numpy>=1.24.0
Requires-Dist: tomli>=2.0.0; python_version < "3.11"
Requires-Dist: tomli-w>=1.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.4.0; extra == "dev"
Requires-Dist: pytest-cov>=4.1.0; extra == "dev"
Requires-Dist: pytest-rerunfailures>=12.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: mypy>=1.5.0; extra == "dev"
Dynamic: license-file

# StegVault

> Secure password manager using steganography to embed encrypted credentials within images

[![Python](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![Version](https://img.shields.io/badge/version-0.3.2-blue.svg)](https://github.com/kalashnikxvxiii-collab/StegVault/releases/tag/v0.3.2)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Tests](https://img.shields.io/badge/tests-145_passing-brightgreen.svg)](tests/)
[![Coverage](https://img.shields.io/badge/coverage-87%25-brightgreen.svg)](tests/)

**StegVault** combines modern cryptography with steganography to create a secure, portable password backup system. Your master password is encrypted using battle-tested algorithms (XChaCha20-Poly1305 + Argon2id) and then hidden within ordinary PNG images using LSB steganography.

## Features

- ğŸ” **Strong Encryption**: XChaCha20-Poly1305 AEAD with Argon2id KDF
- ğŸ–¼ï¸ **Invisible Storage**: LSB steganography with pseudo-random pixel ordering
- ğŸ”’ **Zero-Knowledge**: All operations performed locally, no cloud dependencies
- âœ… **Authenticated**: AEAD tag ensures data integrity
- ğŸ§ª **Well-Tested**: 145 unit tests with 87% overall coverage (all passing)
- â±ï¸ **User-Friendly**: Progress indicators for long operations
- ğŸš€ **Easy to Use**: Simple CLI interface

## Quick Start

### Installation

```bash
# Install from PyPI (recommended)
pip install stegvault

# Or install from source
git clone https://github.com/kalashnikxvxiii-collab/stegvault.git
cd stegvault
pip install -e .
```

### Usage

#### 1. Check Image Capacity

```bash
stegvault check -i myimage.png
```

Output:
```
Image: myimage.png
Format: PNG
Mode: RGB
Size: 500x500 pixels

Capacity: 93750 bytes (91.55 KB)
Max password size: ~93686 bytes (93686 characters)

âœ“ Image has sufficient capacity for password storage.
```

#### 2. Create Backup

```bash
stegvault backup -i cover.png -o backup.png
```

You'll be prompted for:
- Master password (the password to encrypt and store)
- Encryption passphrase (keep this secret!)

#### 3. Restore Password

```bash
stegvault restore -i backup.png
```

You'll be prompted for your encryption passphrase, then your password is displayed.

## How It Works

### Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    StegVault Workflow                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        BACKUP CREATION                 PASSWORD RECOVERY
               â†“                                â†“
    1. User Input                    1. Load Stego Image
       â€¢ Master Password                 â€¢ backup.png
       â€¢ Passphrase                      â€¢ Enter Passphrase
       â€¢ Cover Image
                                      2. Extract Payload
    2. Encryption                        â€¢ LSB Extraction
       â€¢ Generate Salt (16B)             â€¢ Pseudo-random Order
       â€¢ Derive Key (Argon2id)           â€¢ Parse Binary Format
       â€¢ Encrypt (XChaCha20)
                                      3. Decryption
    3. Payload Format                    â€¢ Verify AEAD Tag
       â€¢ Magic: "SPW1"                   â€¢ Derive Key (Argon2id)
       â€¢ Salt + Nonce                    â€¢ Decrypt Ciphertext
       â€¢ Ciphertext + Tag
                                      4. Recover Password
    4. LSB Embedding                     â€¢ Display/Save Password
       â€¢ Pseudo-random Pixels
       â€¢ Modify LSB of R,G,B
       â€¢ Save Stego Image

    5. Output: backup.png
```

### Cryptographic Stack

| Component | Algorithm | Parameters |
|-----------|-----------|------------|
| **AEAD Cipher** | XChaCha20-Poly1305 | 256-bit key, 192-bit nonce |
| **KDF** | Argon2id | 3 iterations, 64MB memory, 4 threads |
| **Salt** | CSPRNG | 128 bits (16 bytes) |
| **Nonce** | CSPRNG | 192 bits (24 bytes) |
| **Tag** | Poly1305 | 128 bits (16 bytes) |

### Payload Format

Binary structure embedded in images:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Offset  â”‚  Size  â”‚  Field         â”‚  Description  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  0       â”‚  4B    â”‚  Magic Header  â”‚  "SPW1"       â”‚
â”‚  4       â”‚  16B   â”‚  Salt          â”‚  For Argon2id â”‚
â”‚  20      â”‚  24B   â”‚  Nonce         â”‚  For XChaCha20â”‚
â”‚  44      â”‚  4B    â”‚  CT Length     â”‚  Big-endian   â”‚
â”‚  48      â”‚  N     â”‚  Ciphertext    â”‚  Variable     â”‚
â”‚  48+N    â”‚  16B   â”‚  AEAD Tag      â”‚  (appended)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Steganography Technique

**LSB (Least Significant Bit) Embedding**:

1. **Pseudo-random Pixel Ordering**: Seed derived from salt ensures reproducible but unpredictable pixel sequence
2. **Distributed Embedding**: Payload bits spread across R, G, B channels
3. **Minimal Visual Impact**: Only LSB modified (imperceptible to human eye)

```python
# Simplified example
seed = int.from_bytes(salt[:4], 'big')
pixels = shuffle_pixels(image, seed)  # Pseudo-random order

for pixel in pixels:
    for channel in [R, G, B]:
        channel_value = (channel_value & 0xFE) | payload_bit
```

## Security Considerations

### âœ… Strong Security Features

- **Modern Cryptography**: XChaCha20-Poly1305 is a modern AEAD cipher resistant to various attacks
- **Strong KDF**: Argon2id winner of Password Hashing Competition, resistant to GPU/ASIC attacks
- **Authenticated Encryption**: Poly1305 MAC ensures integrity; tampering detected automatically
- **Detection Resistance**: Pseudo-random bit placement resists basic steganographic analysis
- **No Key Reuse**: Fresh nonce generated for each encryption

### âš ï¸ Limitations & Warnings

- **Not Invisible**: Advanced steganalysis may detect embedded data
- **No Deniability**: Payload has identifiable magic header
- **JPEG Lossy**: Recompressing JPEG images destroys payload (use PNG)
- **Both Required**: Losing either image OR passphrase = permanent data loss
- **Offline Attacks**: Attacker with image can attempt brute-force (mitigated by Argon2id)

### ğŸ”’ Best Practices

1. **Strong Passphrase**: Use 16+ character passphrase with mixed case, numbers, symbols
2. **Multiple Backups**: Store copies in different locations
3. **PNG Format**: Always use PNG (lossless) not JPEG (lossy)
4. **Verify Backups**: Test restore process after creating backup
5. **Secure Storage**: Protect image files as you would protect passwords

## Development

### Running Tests

```bash
# Run all tests
pytest

# Run with coverage
pytest --cov=stegvault --cov-report=html

# Run specific module tests
pytest tests/unit/test_crypto.py -v
```

### Code Quality

```bash
# Format code
black stegvault tests

# Type checking
mypy stegvault
```

### Project Structure

```
stegvault/
â”œâ”€â”€ stegvault/           # Source code
â”‚   â”œâ”€â”€ crypto/          # Cryptography (Argon2id + XChaCha20)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ core.py
â”‚   â”œâ”€â”€ stego/           # Steganography (PNG LSB)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ png_lsb.py
â”‚   â”œâ”€â”€ utils/           # Payload format handling
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ payload.py
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ cli.py           # Command-line interface
â”œâ”€â”€ tests/               # Test suite
â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ test_crypto.py     # 26 tests
â”‚   â”‚   â”œâ”€â”€ test_payload.py    # 22 tests
â”‚   â”‚   â””â”€â”€ test_stego.py      # 15 tests
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ docs/                # Documentation
â”œâ”€â”€ examples/            # Example images
â”œâ”€â”€ .gitignore
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ CONTRIBUTING.md
â”œâ”€â”€ LICENSE              # MIT License
â”œâ”€â”€ README.md            # This file
â”œâ”€â”€ ROADMAP.md
â”œâ”€â”€ pyproject.toml
â””â”€â”€ requirements.txt
```

## Roadmap

See [ROADMAP.md](ROADMAP.md) for planned features and development timeline.

### Coming Soon

- GUI application (Electron or Qt)
- JPEG DCT steganography (more robust)
- Multiple password vault support
- Image capacity auto-check
- Compression for large passwords
- Optional cloud storage integration

## Contributing

Contributions are welcome! Please read [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines.

### Quick Contribution Guide

1. Fork the repository
2. Create feature branch (`git checkout -b feature/amazing-feature`)
3. Make changes with tests
4. Commit (`git commit -m 'feat: add amazing feature'`)
5. Push (`git push origin feature/amazing-feature`)
6. Open Pull Request

## License

This project is licensed under the MIT License - see [LICENSE](LICENSE) file for details.

## Disclaimer

StegVault is provided "as-is" for educational and personal use. The authors are not responsible for any data loss or security breaches. Always maintain multiple backups of critical passwords.

**Security Notice**: While StegVault uses strong cryptography, no system is perfect. This tool is best used as a supplementary backup method alongside traditional password managers.

## Acknowledgments

- [PyNaCl](https://github.com/pyca/pynacl) - libsodium bindings for Python
- [argon2-cffi](https://github.com/hynek/argon2-cffi) - Argon2 password hashing
- [Pillow](https://github.com/python-pillow/Pillow) - Python Imaging Library
