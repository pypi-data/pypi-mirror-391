import{b as E}from"./B-Pwaivo.js";import{w as n,m as g}from"./C3xJX0nD.js";function l(s,a){const i=n((()=>{if(typeof sessionStorage>"u")return a;try{const o=sessionStorage.getItem(s);if(o)return JSON.parse(o)}catch(o){console.warn(`Failed to read ${s} from sessionStorage`,o)}return a})());return i.subscribe(o=>{if(!(typeof sessionStorage>"u"))try{sessionStorage.setItem(s,JSON.stringify(o))}catch(e){console.warn(`Failed to write ${s} to sessionStorage`,e)}}),i}const r=n([]),I=()=>({reversibleActions:r,addReversibleAction:s=>{r.update(a=>[s,...a].slice(0,50))},executeReversibleAction:async s=>{const a=g(r),d=a.find(i=>i.id===s);if(d){await d.execute();const i=a.findIndex(o=>o.id===s);r.update(o=>o.slice(i+1))}},clearReversibleActions:()=>{r.set([])},clearReversibleActionsByGroupId:s=>{r.update(a=>a.filter(d=>d.groupId!==s))},hasReversibleActions:()=>g(r).length>0}),h=n("samples"),u=n(new Set),p=n(new Set),S=n(new Set),A=n(0),b=n(0),w=n(!1),v=n(void 0),y=l("lightlyStudio_sampleSize",{width:6,height:6}),_=l("lightlyStudio_metadata_bounds",{}),x=l("lightlyStudio_metadata_values",{}),M=l("lightlyStudio_metadata_info",[]),T=n(void 0),B=n([]),f=n({}),R=n(!1),G=s=>{R.set(s)},C=n(!1),F=()=>{const s=I();return{tags:T,textEmbedding:v,setTextEmbedding:e=>{v.set(e)},selectedSampleIds:u,selectedSampleAnnotationCropIds:p,selectedAnnotationFilterIds:S,filteredAnnotationCount:A,filteredSampleCount:b,datasetVersions:f,hideAnnotations:w,classifiers:B,metadataBounds:_,metadataValues:x,metadataInfo:M,updateMetadataValues:e=>{x.set(e)},updateMetadataBounds:e=>{_.set(e)},updateMetadataInfo:e=>{M.set(e)},setHideAnnotations:e=>{w.set(e)},getDatasetVersion:async e=>{const t=g(f);if(t[e])return t[e];const{data:c}=await E({path:{dataset_id:e}});if(c!=null&&c.created_at){const m=new Date(c.created_at).getTime().toString();return f.update(z=>({...z,[e]:m})),m}return""},toggleSampleSelection:e=>{u.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedSamples:()=>{u.update(e=>(e.clear(),e))},toggleSampleAnnotationCropSelection:e=>{p.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedSampleAnnotationCrops:()=>{p.update(e=>(e.clear(),e))},lastGridType:h,setLastGridType:e=>{h.set(e)},setSelectedAnnotationFilterIds:e=>{S.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedAnnotationFilterIds:()=>{S.update(e=>(e.clear(),e))},setfilteredAnnotationCount:e=>{A.set(e)},setfilteredSampleCount:e=>{b.set(e)},sampleSize:y,updateSampleSize:e=>{y.set({width:e,height:e})},isEditingMode:R,setIsEditingMode:G,showPlot:C,setShowPlot:e=>{C.set(e)},...s}};export{l as a,F as u};
