import"./CWj6FrbW.js";import{p as X,f as W,n as j,a as H,c as A,r as I,g as l,b as ct,s as at,t as ft,am as At,u as kt,al as ut,Z as tt,ab as Ct}from"./C3xJX0nD.js";import{c as nt,a as T,f as F,t as Et}from"./CAPx0Bfm.js";import{s as O}from"./DoEId1MK.js";import{s as vt,r as K,p as ot,b as it}from"./xQhUoIl9.js";import{I as gt,P as Nt,f as _t,o as Vt,F as Bt,U as Rt,V as pt,W as wt,y as et,X as rt,Y as zt,Z as Yt,$ as Ft,J as Mt}from"./bQ1GK5by.js";import{a as ht,g as Ot,e as St,c as lt,s as Xt}from"./OutaaHH7.js";import{i as xt}from"./DmGM9V9Q.js";import{P as Ht}from"./gBp1tBnA.js";import{g as qt,u as Gt,h as Ut}from"./DuE3ODv7.js";import"./B-Pwaivo.js";import{s as st}from"./CpbA3HU7.js";import{f as Pt,a as Wt}from"./DELrRF6e.js";import{o as jt}from"./lrI25eI9.js";function Kt(a,t){X(t,!0);/**
 * @license @lucide/svelte v0.482.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let o=K(t,["$$slots","$$events","$$legacy"]);const d=[["path",{d:"m9 18 6-6-6-6"}]];gt(a,vt({name:"chevron-right"},()=>o,{get iconNode(){return d},children:(r,u)=>{var i=nt(),x=W(i);O(x,()=>t.children??j),T(r,i)},$$slots:{default:!0}})),H()}function He(a,t){X(t,!0);/**
 * @license @lucide/svelte v0.482.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let o=K(t,["$$slots","$$events","$$legacy"]);const d=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5"}],["path",{d:"M3 12A9 3 0 0 0 21 12"}]];gt(a,vt({name:"database"},()=>o,{get iconNode(){return d},children:(r,u)=>{var i=nt(),x=W(i);O(x,()=>t.children??j),T(r,i)},$$slots:{default:!0}})),H()}function qe(a,t){X(t,!0);/**
 * @license @lucide/svelte v0.482.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let o=K(t,["$$slots","$$events","$$legacy"]);const d=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}]];gt(a,vt({name:"house"},()=>o,{get iconNode(){return d},children:(r,u)=>{var i=nt(),x=W(i);O(x,()=>t.children??j),T(r,i)},$$slots:{default:!0}})),H()}function Qt(a,t){X(t,!0);/**
 * @license @lucide/svelte v0.482.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let o=K(t,["$$slots","$$events","$$legacy"]);const d=[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]];gt(a,vt({name:"zoom-in"},()=>o,{get iconNode(){return d},children:(r,u)=>{var i=nt(),x=W(i);O(x,()=>t.children??j),T(r,i)},$$slots:{default:!0}})),H()}function Lt(a,t){X(t,!0);/**
 * @license @lucide/svelte v0.482.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let o=K(t,["$$slots","$$events","$$legacy"]);const d=[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]];gt(a,vt({name:"zoom-out"},()=>o,{get iconNode(){return d},children:(r,u)=>{var i=nt(),x=W(i);O(x,()=>t.children??j),T(r,i)},$$slots:{default:!0}})),H()}function Jt(a){return new Nt([document.querySelectorAll(a)],[document.documentElement])}var $t=F("<nav><!></nav>");function Ge(a,t){X(t,!0);let o=ot(t,"ref",15),d=K(t,["$$slots","$$events","$$legacy","ref","class","children"]);var r=$t();ht(r,()=>({class:t.class,"aria-label":"breadcrumb",...d}));var u=A(r);O(u,()=>t.children??j),I(r),it(r,i=>o(i),()=>o()),T(a,r),H()}var te=F("<li><!></li>");function Ue(a,t){X(t,!0);let o=ot(t,"ref",15,null),d=K(t,["$$slots","$$events","$$legacy","ref","class","children"]);var r=te();ht(r,i=>({class:i,...d}),[()=>_t("inline-flex items-center gap-1.5",t.class)]);var u=A(r);O(u,()=>t.children??j),I(r),it(r,i=>o(i),()=>o()),T(a,r),H()}var ee=F("<li><!></li>");function We(a,t){X(t,!0);let o=ot(t,"ref",15,null),d=K(t,["$$slots","$$events","$$legacy","ref","class","children"]);var r=ee();ht(r,g=>({role:"presentation","aria-hidden":"true",class:g,...d}),[()=>_t("[&>svg]:size-3.5",t.class)]);var u=A(r);{var i=g=>{var f=nt(),M=W(f);O(M,()=>t.children??j),T(g,f)},x=g=>{Kt(g,{})};xt(u,g=>{t.children?g(i):g(x,!1)})}I(r),it(r,g=>o(g),()=>o()),T(a,r),H()}var ae=F("<a><!></a>");function je(a,t){X(t,!0);let o=ot(t,"ref",15,null),d=ot(t,"href",3,void 0),r=K(t,["$$slots","$$events","$$legacy","ref","class","href","child","children"]);const u=ct(()=>({class:_t("hover:text-foreground transition-colors",t.class),href:d(),...r})),i=Ot(),[x,g]=i;var f=nt(),M=W(f);{var C=w=>{var b=nt(),k=W(b);O(k,()=>t.child,()=>({props:l(u)})),T(w,b)},_=w=>{var b=ae();ht(b,Z=>({...Z}),[()=>g({...l(u)},[{attribute_name:"href",lang_attribute_name:"hreflang"}])]);var k=A(b);O(k,()=>t.children??j),I(b),it(b,Z=>o(Z),()=>o()),T(w,b)};xt(M,w=>{t.child?w(C):w(_,!1)})}T(a,f),H()}var ne=F("<ol><!></ol>");function Ke(a,t){X(t,!0);let o=ot(t,"ref",15,null),d=K(t,["$$slots","$$events","$$legacy","ref","class","children"]);var r=ne();ht(r,i=>({class:i,...d}),[()=>_t("text-muted-foreground flex flex-wrap items-center gap-1.5 break-words text-sm sm:gap-2.5",t.class)]);var u=A(r);O(u,()=>t.children??j),I(r),it(r,i=>o(i),()=>o()),T(a,r),H()}var oe=F("<span><!></span>");function Qe(a,t){X(t,!0);let o=ot(t,"ref",15,null),d=K(t,["$$slots","$$events","$$legacy","ref","class","children"]);var r=oe();ht(r,i=>({role:"link","aria-disabled":"true","aria-current":"page",class:i,...d}),[()=>_t("text-foreground font-normal",t.class)]);var u=A(r);O(u,()=>t.children??j),I(r),it(r,i=>o(i),()=>o()),T(a,r),H()}const Le=a=>`${Ht}/sample/${a}`,Je=({sampleId:a})=>{const t=qt({path:{sample_id:a}}),o=Gt(),d=Ut(t);return{refetch:()=>{o.invalidateQueries({queryKey:t.queryKey})},sample:d}},ie="bbox-change-annotation-details",$e=({annotation:a,addReversibleAction:t,updateAnnotation:o})=>{const d=Vt(a),r=async()=>{const u={annotation_id:a.annotation_id,dataset_id:a.dataset_id,bounding_box:d};await o(u)};t({id:`bbox-change-${a.annotation_id}-${Date.now()}`,description:`Revert bounding box change for annotation ${a.annotation_id}`,execute:r,timestamp:new Date,groupId:ie})};var re=F('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),se=F('<div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div>'),le=F('<div class="flex items-start gap-3"><span class="truncate text-sm font-medium"> </span> <pre class="min-w-[8rem] flex-1 overflow-x-auto whitespace-pre-wrap rounded bg-muted p-2 text-sm"> </pre></div>'),ue=F('<div class="flex items-start gap-3"><span class="truncate text-sm font-medium"> </span> <span class="min-w-[8rem] flex-1 break-all text-sm"> </span></div>'),ce=F('<div class="space-y-3 text-diffuse-foreground"></div>'),he=F("<!> <!>",1);function ta(a,t){X(t,!0);const o=ot(t,"showCustomMetadata",3,!0),d=ct(()=>[{id:"height",label:"Height:",value:Pt(t.sample.height)+"px"},{id:"width",label:"Width:",value:Pt(t.sample.width)+"px"},{id:"filename",label:"Filename:",value:t.sample.file_name},{id:"filepath",label:"Filepath:",value:t.sample.file_path_abs}]),r=ct(()=>{const f=[];if(t.sample.metadata_dict&&typeof t.sample.metadata_dict=="object"&&"data"in t.sample.metadata_dict){const M=t.sample.metadata_dict.data;M&&typeof M=="object"&&Object.entries(M).forEach(([C,_])=>{const w=Wt(_),b=typeof _=="object"&&_!==null&&!Array.isArray(_);f.push({id:`metadata_${C}`,label:`${C}:`,value:w,isComplex:b})})}return f});var u=he(),i=W(u);Bt(i,{title:"Sample details",children:(f,M)=>{var C=se();St(C,21,()=>l(d),({label:_,value:w,id:b})=>_,(_,w)=>{let b=()=>l(w).label,k=()=>l(w).value,Z=()=>l(w).id;var h=re(),E=W(h),B=A(E,!0);I(E);var N=at(E,2),Y=A(N,!0);I(N),ft(()=>{st(B,b()),lt(N,"data-testid",`sample-metadata-${Z()}`),st(Y,k())}),T(_,h)}),I(C),T(f,C)}});var x=at(i,2);{var g=f=>{Bt(f,{title:"Metadata",children:(M,C)=>{var _=ce();St(_,21,()=>l(r),({label:w,value:b,id:k,isComplex:Z})=>w,(w,b)=>{let k=()=>l(b).label,Z=()=>l(b).value,h=()=>l(b).id,E=()=>l(b).isComplex;var B=nt(),N=W(B);{var Y=m=>{var S=le(),P=A(S),q=A(P,!0);I(P);var Q=at(P,2),dt=A(Q,!0);I(Q),I(S),ft(()=>{lt(P,"title",k()),st(q,k()),st(dt,Z())}),T(m,S)},R=m=>{var S=ue(),P=A(S),q=A(P,!0);I(P);var Q=at(P,2),dt=A(Q,!0);I(Q),I(S),ft(()=>{lt(P,"title",k()),st(q,k()),lt(Q,"data-testid",`sample-metadata-${h()}`),st(dt,Z())}),T(m,S)};xt(N,m=>{E()?m(Y):m(R,!1)})}T(w,B)}),I(_),T(M,_)}})};xt(x,f=>{o()&&l(r).length>0&&f(g)})}T(a,u),H()}var de=1e-12;function Dt(a){return((a=Math.exp(a))+1/a)/2}function me(a){return((a=Math.exp(a))-1/a)/2}function fe(a){return((a=Math.exp(2*a))-1)/(a+1)}const ve=function a(t,o,d){function r(u,i){var x=u[0],g=u[1],f=u[2],M=i[0],C=i[1],_=i[2],w=M-x,b=C-g,k=w*w+b*b,Z,h;if(k<de)h=Math.log(_/f)/t,Z=function(m){return[x+m*w,g+m*b,f*Math.exp(t*m*h)]};else{var E=Math.sqrt(k),B=(_*_-f*f+d*k)/(2*f*o*E),N=(_*_-f*f-d*k)/(2*_*o*E),Y=Math.log(Math.sqrt(B*B+1)-B),R=Math.log(Math.sqrt(N*N+1)-N);h=(R-Y)/t,Z=function(m){var S=m*h,P=Dt(Y),q=f/(o*E)*(P*fe(t*S+Y)-me(Y));return[x+q*w,g+q*b,f*P/Dt(t*S+Y)]}}return Z.duration=h*1e3*t/Math.SQRT2,Z}return r.rho=function(u){var i=Math.max(.001,+u),x=i*i,g=x*x;return a(i,x,g)},r}(Math.SQRT2,2,4),yt=a=>()=>a;function ge(a,{sourceEvent:t,target:o,transform:d,dispatch:r}){Object.defineProperties(this,{type:{value:a,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:d,enumerable:!0,configurable:!0},_:{value:r}})}function Tt(a){a.stopImmediatePropagation()}function mt(a){a.preventDefault(),a.stopImmediatePropagation()}function _e(a){return(!a.ctrlKey||a.type==="wheel")&&!a.button}function ye(){var a=this;return a instanceof SVGElement?(a=a.ownerSVGElement||a,a.hasAttribute("viewBox")?(a=a.viewBox.baseVal,[[a.x,a.y],[a.x+a.width,a.y+a.height]]):[[0,0],[a.width.baseVal.value,a.height.baseVal.value]]):[[0,0],[a.clientWidth,a.clientHeight]]}function It(){return this.__zoom||pt}function pe(a){return-a.deltaY*(a.deltaMode===1?.05:a.deltaMode?1:.002)*(a.ctrlKey?10:1)}function xe(){return navigator.maxTouchPoints||"ontouchstart"in this}function be(a,t,o){var d=a.invertX(t[0][0])-o[0][0],r=a.invertX(t[1][0])-o[1][0],u=a.invertY(t[0][1])-o[0][1],i=a.invertY(t[1][1])-o[1][1];return a.translate(r>d?(d+r)/2:Math.min(0,d)||Math.max(0,r),i>u?(u+i)/2:Math.min(0,u)||Math.max(0,i))}function we(){var a=_e,t=ye,o=be,d=pe,r=xe,u=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],x=250,g=ve,f=Rt("start","zoom","end"),M,C,_,w=500,b=150,k=0,Z=10;function h(e){e.property("__zoom",It).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",q).filter(r).on("touchstart.zoom",Q).on("touchmove.zoom",dt).on("touchend.zoom touchcancel.zoom",Zt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(e,s,n,c){var v=e.selection?e.selection():e;v.property("__zoom",It),e!==v?Y(e,s,n,c):v.interrupt().each(function(){R(this,arguments).event(c).start().zoom(null,typeof s=="function"?s.apply(this,arguments):s).end()})},h.scaleBy=function(e,s,n,c){h.scaleTo(e,function(){var v=this.__zoom.k,y=typeof s=="function"?s.apply(this,arguments):s;return v*y},n,c)},h.scaleTo=function(e,s,n,c){h.transform(e,function(){var v=t.apply(this,arguments),y=this.__zoom,p=n==null?N(v):typeof n=="function"?n.apply(this,arguments):n,z=y.invert(p),D=typeof s=="function"?s.apply(this,arguments):s;return o(B(E(y,D),p,z),v,i)},n,c)},h.translateBy=function(e,s,n,c){h.transform(e,function(){return o(this.__zoom.translate(typeof s=="function"?s.apply(this,arguments):s,typeof n=="function"?n.apply(this,arguments):n),t.apply(this,arguments),i)},null,c)},h.translateTo=function(e,s,n,c,v){h.transform(e,function(){var y=t.apply(this,arguments),p=this.__zoom,z=c==null?N(y):typeof c=="function"?c.apply(this,arguments):c;return o(pt.translate(z[0],z[1]).scale(p.k).translate(typeof s=="function"?-s.apply(this,arguments):-s,typeof n=="function"?-n.apply(this,arguments):-n),y,i)},c,v)};function E(e,s){return s=Math.max(u[0],Math.min(u[1],s)),s===e.k?e:new wt(s,e.x,e.y)}function B(e,s,n){var c=s[0]-n[0]*e.k,v=s[1]-n[1]*e.k;return c===e.x&&v===e.y?e:new wt(e.k,c,v)}function N(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function Y(e,s,n,c){e.on("start.zoom",function(){R(this,arguments).event(c).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(c).end()}).tween("zoom",function(){var v=this,y=arguments,p=R(v,y).event(c),z=t.apply(v,y),D=n==null?N(z):typeof n=="function"?n.apply(v,y):n,L=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),V=v.__zoom,G=typeof s=="function"?s.apply(v,y):s,J=g(V.invert(D).concat(L/V.k),G.invert(D).concat(L/G.k));return function(U){if(U===1)U=G;else{var $=J(U),bt=L/$[2];U=new wt(bt,D[0]-$[0]*bt,D[1]-$[1]*bt)}p.zoom(null,U)}})}function R(e,s,n){return!n&&e.__zooming||new m(e,s)}function m(e,s){this.that=e,this.args=s,this.active=0,this.sourceEvent=null,this.extent=t.apply(e,s),this.taps=0}m.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,s){return this.mouse&&e!=="mouse"&&(this.mouse[1]=s.invert(this.mouse[0])),this.touch0&&e!=="touch"&&(this.touch0[1]=s.invert(this.touch0[0])),this.touch1&&e!=="touch"&&(this.touch1[1]=s.invert(this.touch1[0])),this.that.__zoom=s,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var s=et(this.that).datum();f.call(e,this.that,new ge(e,{sourceEvent:this.sourceEvent,target:h,transform:this.that.__zoom,dispatch:f}),s)}};function S(e,...s){if(!a.apply(this,arguments))return;var n=R(this,s).event(e),c=this.__zoom,v=Math.max(u[0],Math.min(u[1],c.k*Math.pow(2,d.apply(this,arguments)))),y=rt(e);if(n.wheel)(n.mouse[0][0]!==y[0]||n.mouse[0][1]!==y[1])&&(n.mouse[1]=c.invert(n.mouse[0]=y)),clearTimeout(n.wheel);else{if(c.k===v)return;n.mouse=[y,c.invert(y)],zt(this),n.start()}mt(e),n.wheel=setTimeout(p,b),n.zoom("mouse",o(B(E(c,v),n.mouse[0],n.mouse[1]),n.extent,i));function p(){n.wheel=null,n.end()}}function P(e,...s){if(_||!a.apply(this,arguments))return;var n=e.currentTarget,c=R(this,s,!0).event(e),v=et(e.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",L,!0),y=rt(e,n),p=e.clientX,z=e.clientY;Yt(e.view),Tt(e),c.mouse=[y,this.__zoom.invert(y)],zt(this),c.start();function D(V){if(mt(V),!c.moved){var G=V.clientX-p,J=V.clientY-z;c.moved=G*G+J*J>k}c.event(V).zoom("mouse",o(B(c.that.__zoom,c.mouse[0]=rt(V,n),c.mouse[1]),c.extent,i))}function L(V){v.on("mousemove.zoom mouseup.zoom",null),Ft(V.view,c.moved),mt(V),c.event(V).end()}}function q(e,...s){if(a.apply(this,arguments)){var n=this.__zoom,c=rt(e.changedTouches?e.changedTouches[0]:e,this),v=n.invert(c),y=n.k*(e.shiftKey?.5:2),p=o(B(E(n,y),c,v),t.apply(this,s),i);mt(e),x>0?et(this).transition().duration(x).call(Y,p,c,e):et(this).call(h.transform,p,c,e)}}function Q(e,...s){if(a.apply(this,arguments)){var n=e.touches,c=n.length,v=R(this,s,e.changedTouches.length===c).event(e),y,p,z,D;for(Tt(e),p=0;p<c;++p)z=n[p],D=rt(z,this),D=[D,this.__zoom.invert(D),z.identifier],v.touch0?!v.touch1&&v.touch0[2]!==D[2]&&(v.touch1=D,v.taps=0):(v.touch0=D,y=!0,v.taps=1+!!M);M&&(M=clearTimeout(M)),y&&(v.taps<2&&(C=D[0],M=setTimeout(function(){M=null},w)),zt(this),v.start())}}function dt(e,...s){if(this.__zooming){var n=R(this,s).event(e),c=e.changedTouches,v=c.length,y,p,z,D;for(mt(e),y=0;y<v;++y)p=c[y],z=rt(p,this),n.touch0&&n.touch0[2]===p.identifier?n.touch0[0]=z:n.touch1&&n.touch1[2]===p.identifier&&(n.touch1[0]=z);if(p=n.that.__zoom,n.touch1){var L=n.touch0[0],V=n.touch0[1],G=n.touch1[0],J=n.touch1[1],U=(U=G[0]-L[0])*U+(U=G[1]-L[1])*U,$=($=J[0]-V[0])*$+($=J[1]-V[1])*$;p=E(p,Math.sqrt(U/$)),z=[(L[0]+G[0])/2,(L[1]+G[1])/2],D=[(V[0]+J[0])/2,(V[1]+J[1])/2]}else if(n.touch0)z=n.touch0[0],D=n.touch0[1];else return;n.zoom("touch",o(B(p,z,D),n.extent,i))}}function Zt(e,...s){if(this.__zooming){var n=R(this,s).event(e),c=e.changedTouches,v=c.length,y,p;for(Tt(e),_&&clearTimeout(_),_=setTimeout(function(){_=null},w),y=0;y<v;++y)p=c[y],n.touch0&&n.touch0[2]===p.identifier?delete n.touch0:n.touch1&&n.touch1[2]===p.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(p=rt(p,this),Math.hypot(C[0]-p[0],C[1]-p[1])<Z)){var z=et(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return h.wheelDelta=function(e){return arguments.length?(d=typeof e=="function"?e:yt(+e),h):d},h.filter=function(e){return arguments.length?(a=typeof e=="function"?e:yt(!!e),h):a},h.touchable=function(e){return arguments.length?(r=typeof e=="function"?e:yt(!!e),h):r},h.extent=function(e){return arguments.length?(t=typeof e=="function"?e:yt([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),h):t},h.scaleExtent=function(e){return arguments.length?(u[0]=+e[0],u[1]=+e[1],h):[u[0],u[1]]},h.translateExtent=function(e){return arguments.length?(i[0][0]=+e[0][0],i[1][0]=+e[1][0],i[0][1]=+e[0][1],i[1][1]=+e[1][1],h):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},h.constrain=function(e){return arguments.length?(o=e,h):o},h.duration=function(e){return arguments.length?(x=+e,h):x},h.interpolate=function(e){return arguments.length?(g=e,h):g},h.on=function(){var e=f.on.apply(f,arguments);return e===f?h:e},h.clickDistance=function(e){return arguments.length?(k=(e=+e)*e,h):Math.sqrt(k)},h.tapDistance=function(e){return arguments.length?(Z=+e,h):Z},h}function ze(a,t){let o=a.scaleIndependentXForm;o||(o=a.scaleIndependentXForm=t.createSVGTransform(),a.transform.baseVal.appendItem(o));const d=a.parentNode;if(d){const r=d.getScreenCTM();if(r){const u=r.inverse().multiply(t.getScreenCTM());u.e=u.f=0,o.setMatrix(u)}}}var Me=F('<div class="pointer-events-auto absolute bottom-0 left-1 z-20 flex select-none items-center gap-1 rounded-lg bg-muted bg-opacity-80 shadow-md backdrop-blur-sm"><!> <div class="h-6 w-px bg-white bg-opacity-20"></div> <!> <div class="w-[32px] text-center text-sm text-muted-foreground" data-testid="zoom-level"> </div> <!></div>');function Te(a,t){var o=Me(),d=A(o);Mt(d,{variant:"ghost","data-testid":"zoom-reset",size:"sm",get onclick(){return t.onZoomReset},get disabled(){return t.isResetDisabled},children:(g,f)=>{At();var M=Et("Reset");T(g,M)},$$slots:{default:!0}});var r=at(d,4);Mt(r,{title:"zoom out",variant:"ghost",size:"icon","data-testid":"zoom-out",get onclick(){return t.onZoomOut},get disabled(){return t.isZoominDisabled},children:(g,f)=>{Lt(g,{class:"h-4 w-4"})},$$slots:{default:!0}});var u=at(r,2),i=A(u);I(u);var x=at(u,2);Mt(x,{title:"zoom in",variant:"ghost",size:"icon","data-testid":"zoom-in",get onclick(){return t.onZoomIn},get disabled(){return t.isZoomoutDisabled},children:(g,f)=>{Qt(g,{class:"h-4 w-4"})},$$slots:{default:!0}}),I(o),ft(g=>st(i,`${g??""}%`),[()=>Math.round(t.scale*100)]),T(a,o)}var ke=F('<div class="relative flex h-full w-full select-none items-center justify-center"><!> <svg class="z-10 h-full w-full" preserveAspectRatio="xMidYMid meet"><g><!></g></svg> <svg class="pointer-events-none absolute inset-0" preserveAspectRatio="xMidYMid meet"></svg></div>');function ea(a,t){X(t,!0);let o=ut(null),d=ut(null);const r=ot(t,"cursor",3,"auto");let u=ut(800),i=ut(600);kt(()=>{if(!l(o))return;tt(u,l(o).clientWidth,!0),tt(i,l(o).clientHeight,!0);const m=new ResizeObserver(()=>{l(o)&&(tt(u,l(o).clientWidth,!0),tt(i,l(o).clientHeight,!0))});return m.observe(l(o)),()=>m.disconnect()});const x=10,g=ct(()=>{const m={x:0,y:0,width:t.width,height:t.height};if(t.boundingBox){k();const{x:S,y:P,width:q,height:Q}=t.boundingBox;return{x:Math.round(Math.max(0,S-x)),y:Math.round(Math.max(0,P-x)),width:Math.round(Math.min(t.width-S,q+x*2)),height:Math.round(Math.min(t.height-P,Q+x*2))}}return m});let f=ut(Ct({k:1,x:0,y:0}));const M=ct(()=>{if(!l(o))return 1;const m=l(u)/t.width,S=l(i)/t.height,P=Math.min(m,S);return l(f).k*P}),C=ct(()=>{if(!l(o))return 1;let m=l(M);if(t.boundingBox){const S=t.width/l(g).width,P=t.height/l(g).height,q=Math.min(S,P);m*=q}return m});let _=ut(null);const w=()=>{l(o)&&(tt(_,we().on("zoom",m=>{tt(f,m.transform,!0)}).filter(m=>(!m.ctrlKey||m.type==="wheel")&&!m.button&&!(m.type==="mousedown"&&m.button===2)).wheelDelta(m=>-m.deltaY*.002),!0),et(l(o)).call(l(_)).on("dblclick.zoom",null))},b=m=>{if(!l(o)||!l(_))return;const S=m?1.5:.75;et(l(o)).transition().duration(300).call(l(_).scaleBy,S)},k=()=>{!l(o)||!l(_)||et(l(o)).transition().duration(300).call(l(_).transform,pt)},Z=()=>{tt(f,{k:1,x:0,y:0},!0),l(o)&&l(_)&&et(l(o)).call(l(_).transform,pt)};jt(()=>{var m;w(),(m=t.registerResetFn)==null||m.call(t,Z)}),kt(()=>{l(f).k,Jt(".unscaled").each(function(){ze(this,l(d))})});var h=ke(),E=A(h);Te(E,{get scale(){return l(M)},onZoomIn:()=>b(!0),onZoomOut:()=>b(!1),onZoomReset:k});var B=at(E,2),N=A(B),Y=A(N);O(Y,()=>t.zoomableContent,()=>({scale:l(C)})),I(N),I(B),it(B,m=>tt(o,m),()=>l(o));var R=at(B,2);lt(R,"viewBox","0 0 1024 768"),it(R,m=>tt(d,m),()=>l(d)),I(h),ft(()=>{Xt(B,`cursor: ${r()};`),lt(B,"viewBox",`${l(g).x} ${l(g).y} ${l(g).width} ${l(g).height}`),lt(N,"transform",`translate(${l(f).x}, ${l(f).y}) scale(${l(f).k})`)}),T(a,h),H()}export{Ge as B,He as D,qe as H,ta as S,ea as Z,Ke as a,Ue as b,je as c,We as d,Qe as e,$e as f,ie as g,Le as h,Je as u};
