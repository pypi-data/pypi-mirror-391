import"../chunks/CWj6FrbW.js";import{p as pe,al as g,ab as ze,u as ye,g as e,b as f,Z as d,c as m,s as G,f as B,r as u,t as de,a as be,w as He,m as Se,am as We}from"../chunks/C3xJX0nD.js";import{f as I,c as J,a as l}from"../chunks/CAPx0Bfm.js";import{i as N,a as Te,s as fe}from"../chunks/DmGM9V9Q.js";import{a as Ne,S as qe,e as Fe,s as ne,u as Oe,k as je,b as Ke}from"../chunks/OutaaHH7.js";import{h as Qe,i as U,s as Re,j as Ve,k as Ae,l as Be,n as Ie,L as Ge}from"../chunks/bQ1GK5by.js";import{p as C,r as Ee,b as ke}from"../chunks/xQhUoIl9.js";import{r as Ye,u as Ze}from"../chunks/DuE3ODv7.js";import{S as De}from"../chunks/ConpFqMd.js";import{u as Je}from"../chunks/CWV1Rpwv.js";import"../chunks/QWEcxSok.js";import"../chunks/B-Pwaivo.js";import"../chunks/BVTSFVWH.js";import"../chunks/69_IOA4Y.js";import"../chunks/lrI25eI9.js";import"../chunks/gBp1tBnA.js";import{I as Ue}from"../chunks/DCQF8zEA.js";import{s as D}from"../chunks/DoEId1MK.js";import{s as Xe}from"../chunks/CpbA3HU7.js";const $e=Re(),et=Ve();var tt=I("<div><!></div>"),it=I("<div><!></div>"),at=I("<div><!></div>"),rt=I("<div><!></div>"),st=I("<div><!></div>"),ot=I("<div><!> <div><!> <!></div> <!></div>");function lt(q,i){pe(i,!0);let h=C(i,"height",3,"100%"),F=C(i,"width",3,"100%"),p=C(i,"stickyIndices",19,()=>[]),P=C(i,"overScan",3,1),b=C(i,"marginLeft",3,0),o=C(i,"marginTop",3,0),K=C(i,"layout",3,"vertical"),w=C(i,"scrollPosition",15,0),ie=C(i,"scrollAlignment",3,"auto"),z=C(i,"scrollBehavior",3,"auto"),me=C(i,"getKey",3,t=>t),ae=Ee(i,["$$slots","$$events","$$legacy","itemCount","itemSize","height","width","stickyIndices","overScan","marginLeft","marginTop","layout","scrollPosition","scrollAlignment","scrollBehavior","getKey","onscroll","header","item","placeholder","footer"]),M=g(void 0),O=g(ze(w())),X=g(0),T=g(0),E=g(0),ce=g(0),$=g(0),ee=g(0),Y=g(ze([])),Q=!1,te=!1,R=g(!1);function ue(t,r=ie(),x=z()){c(ge(t,r),x)}function he(t,r=z()){c(t,r)}const ge=(t,r)=>{const x=e(v)?o()+e(X):b()+e(T),S=t*i.itemSize+x,W=S-e(A)+i.itemSize+x;let a;switch(r){case"start":a=S;break;case"center":a=S-(e(A)-i.itemSize)/2;break;case"end":a=W;break;default:a=Math.max(W,Math.min(S,w()));break}return Math.max(0,Math.min(e(se)-e(A),a))},c=(t,r=z())=>{e(M)&&(Q=!0,e(M).scrollTo({[e(v)?"top":"left"]:t,behavior:r}),Q=!1)},V=t=>{e(M)&&!Q&&!te&&(Q=!0,e(M).scrollTo({top:t,behavior:z()}),Q=!1)},re=t=>{const r=t*i.itemSize;return`position: absolute; transform: translate3d(${e(v)?`${b()}px, ${r+o()}px`:`${e(T)+r+b()}px, ${o()}px`}, 0px); ${e(xe)} will-change: transform;`},_e=t=>{te=!0,Q||(e(v)?(d(O,Math.max(0,t.currentTarget.scrollTop-e(X)),!0),w(t.currentTarget.scrollTop)):(d(O,Math.max(0,t.currentTarget.scrollLeft-e(T)),!0),w(t.currentTarget.scrollLeft)),e(oe)(e(O))),$e(()=>{te=!1})};let v=f(()=>K()==="vertical"),se=f(()=>i.itemCount*i.itemSize),xe=f(()=>e(v)?`height: ${i.itemSize}px; width: ${b()>0?`${e(ee)-b()}px`:"100%"};`:`height: ${o()>0?`${e(ce)-o()}px`:"100%"}; width: ${i.itemSize}px;`),A=f(()=>e(v)?e(E):e($));ye(()=>{e(A)&&d(Y,Qe(i.itemCount,i.itemSize,e(A),P(),e(O)),!0)}),ye(()=>{e(M)&&V(w())});let oe=f(()=>et(e(A),{fast:()=>{d(R,!0)},slow:()=>{d(R,!1)}}));var k={scrollToIndex:ue,scrollToPosition:he},_=ot(),le=t=>{var r;_e(t),(r=i.onscroll)==null||r.call(i,t)};Ne(_,t=>({onscroll:le,...ae,[qe]:t}),[()=>({position:"relative",overflow:"auto",height:typeof h()=="number"?`${h()}px`:h(),width:typeof F()!="number"?F():`${F()}px`})]);var L=m(_);{var j=t=>{var r=J(),x=B(r);{var S=a=>{var s=tt(),n=m(s);D(n,()=>i.header),u(s),U(s,"offsetHeight",y=>d(X,y)),l(a,s)},W=a=>{var s=it();ne(s,"",{},{position:"absolute"});var n=m(s);D(n,()=>i.header),u(s),U(s,"offsetWidth",y=>d(T,y)),l(a,s)};N(x,a=>{e(v)?a(S):a(W,!1)})}l(t,r)};N(L,t=>{i.header&&t(j)})}var H=G(L,2);let ve;var we=m(H);{var Ce=t=>{const r=f(()=>Math.max(...p().filter(a=>a<e(Y)[0])));var x=J(),S=B(x);{var W=a=>{var s=at();let n;var y=m(s);D(y,()=>i.item,()=>({index:e(r),style:""})),u(s),de(Z=>n=ne(s,"",n,Z),[()=>({position:"sticky",top:e(v)?`${o()}px`:"0px",left:e(v)?"0px":`${b()}px`,"z-index":"1"})]),l(a,s)};N(S,a=>{e(r)>=0&&a(W)})}l(t,x)};N(we,t=>{p().length&&e(Y).length&&t(Ce)})}var Pe=G(we,2);Fe(Pe,17,()=>e(Y),t=>me()(t),(t,r)=>{const x=f(()=>re(e(r)));var S=J(),W=B(S);{var a=n=>{var y=J(),Z=B(y);D(Z,()=>i.item,()=>({index:e(r),style:e(x)})),l(n,y)},s=n=>{var y=J(),Z=B(y);D(Z,()=>i.placeholder,()=>({index:e(r),style:e(x)})),l(n,y)};N(W,n=>{!e(R)||!i.placeholder?n(a):n(s,!1)})}l(t,S)}),u(H);var Me=G(H,2);{var Le=t=>{var r=J(),x=B(r);{var S=a=>{var s=rt(),n=m(s);D(n,()=>i.footer),u(s),l(a,s)},W=a=>{var s=st();let n;var y=m(s);D(y,()=>i.footer),u(s),de(Z=>n=ne(s,"",n,Z),[()=>({position:"absolute",top:"0px",left:`${e(T)+i.itemCount*i.itemSize+b()}px`})]),l(a,s)};N(x,a=>{e(v)?a(S):a(W,!1)})}l(t,r)};N(Me,t=>{i.footer&&t(Le)})}return u(_),ke(_,t=>d(M,t),()=>e(M)),de(t=>ve=ne(H,"",ve,t),[()=>({height:e(v)?`${e(se)}px`:"100%",width:e(v)?"100%":`${e(se)}px`})]),U(_,"offsetHeight",t=>d(E,t)),U(_,"clientHeight",t=>d(ce,t)),U(_,"offsetWidth",t=>d($,t)),U(_,"clientWidth",t=>d(ee,t)),l(q,_),be(k)}const nt=(...q)=>{const i=Ye(...q),h=Ae({...i,getNextPageParam:o=>o.nextCursor||void 0}),F=Ze(),p=()=>{F.invalidateQueries({queryKey:i.queryKey})},P=He([]);return h.subscribe(o=>{if(o.isSuccess){const K=o.data.pages.flatMap(w=>w.data);P.set(K)}}),{data:P,loadMore:()=>{Se(h).hasNextPage&&!Se(h).isFetchingNextPage&&Se(h).fetchNextPage()},query:h,refresh:p}};var dt=I('<div class="flex flex-row items-center gap-10"><!> <div class="flex-1 text-sm text-foreground"> </div></div>');function ct(q,i){pe(i,!0);const h=()=>fe(P,"$gridViewSampleRenderingStore",F),[F,p]=Te(),{gridViewSampleRenderingStore:P}=Oe();let b=f(h);var o=dt(),K=m(o);Be(K,{get sample(){return i.item.sample},get objectFit(){return e(b)}});var w=G(K,2),ie=m(w,!0);u(w),u(o),de(()=>Xe(ie,i.item.text)),l(q,o),be(),p()}var vt=I('<div class="flex h-full w-full items-center justify-center"><!> <div>Loading samples...</div></div>'),ft=I("<div><!></div>"),mt=I('<div class="flex justify-center p-4"><!></div>'),ut=I("<!> <!>",1),ht=I('<div class="flex flex-1 flex-col space-y-4"><div class="my-2 flex items-center space-x-4"><div class="flex-1"><div class="text-2xl font-semibold">Captions</div></div> <div class="w-4/12"><!></div></div> <!> <div class="h-full w-full flex-1 overflow-hidden"><!></div></div>');function gt(q,i){pe(i,!0);const h=()=>fe(e(K),"$data",P),F=()=>fe(me,"$sampleSize",P),p=()=>fe(e(w),"$query",P),[P,b]=Te(),o=f(()=>nt({path:{dataset_id:i.datasetId}})),K=f(()=>e(o).data),w=f(()=>e(o).query),ie=f(()=>e(o).loadMore);let z=g(null);const{sampleSize:me}=Je();let ae=g(0),M=g(0),O=g(0),X=g(0);ye(()=>{if(!e(z))return;d(M,e(X)/F().width),d(O,e(M)-E),d(ae,e(z).clientHeight,!0);const c=new ResizeObserver(()=>{e(z)&&d(ae,e(z).clientHeight,!0)});return c.observe(e(z)),()=>{c.disconnect()}});let T=f(h);const E=16,ce=f(()=>e(ae)+E);var $=ht(),ee=m($),Y=G(m(ee),2),Q=m(Y);Ue(Q,{}),u(Y),u(ee);var te=G(ee,2);De(te,{class:"mb-4 bg-border-hard"});var R=G(te,2),ue=m(R);{var he=c=>{var V=vt(),re=m(V);Ie(re,{}),We(2),u(V),l(c,V)},ge=c=>{var V=J(),re=B(V);{var _e=v=>{{const se=(oe,k)=>{let _=()=>k==null?void 0:k().index,le=()=>k==null?void 0:k().style;var L=ft();Ke(L,1,`pb-[${E}]`);var j=m(L);ct(j,{get item(){return e(T)[_()]}}),u(L),de(()=>ne(L,le())),l(oe,L)},xe=oe=>{var k=ut(),_=B(k);je(_,()=>e(T).length,j=>{{let H=f(()=>!p().hasNextPage||p().isFetchingNextPage);Ge(j,{get onIntersect(){return e(ie)},get disabled(){return e(H)}})}});var le=G(_,2);{var L=j=>{var H=mt(),ve=m(H);Ie(ve,{}),u(H),l(j,H)};N(le,j=>{p().isFetchingNextPage&&j(L)})}l(oe,k)};let A=f(()=>e(O)+E);lt(v,{get itemCount(){return e(T).length},get height(){return e(ce)},get itemSize(){return e(A)},class:"dark:[color-scheme:dark]",get style(){return`--sample-width: ${e(O)??""}px; --sample-height: ${e(O)??""}px;`},item:se,footer:xe,$$slots:{item:!0,footer:!0}})}};N(re,v=>{p().isSuccess&&e(T).length>0&&v(_e)},!0)}l(c,V)};N(ue,c=>{p().isPending&&e(T).length===0?c(he):c(ge,!1)})}u(R),ke(R,c=>d(z,c),()=>e(z)),u($),U(R,"clientWidth",c=>d(X,c)),l(q,$),be(),b()}function Ft(q,i){const{datasetId:h}=i.data;gt(q,{get datasetId(){return h}})}export{Ft as component};
