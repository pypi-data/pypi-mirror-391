import"../chunks/CWj6FrbW.js";import{p as he,f as A,n as vt,a as _e,am as Ke,g as e,b as o,s as g,c as p,r as f,t as fe,m as ye,u as ft,Z as i,al as F,ab as ct,$ as ut}from"../chunks/C3xJX0nD.js";import{c as ue,a as r,f as T,t as qe,d as Ce}from"../chunks/CAPx0Bfm.js";import{s as Re}from"../chunks/DoEId1MK.js";import{i as z,s as Q,a as Le}from"../chunks/DmGM9V9Q.js";import{p as we}from"../chunks/BVTSFVWH.js";import{I as ht,o as Zt,p as Gt,q as Vt,r as jt,t as Te,v as Kt,w as _t,_ as qt,x as Wt,y as Jt,z as Qt,C as pt,B as bt,D as ea,R as ta,n as aa,E as na,F as xt,G as oa,H as sa,J as ra,K as la,M as ia,N as da}from"../chunks/bQ1GK5by.js";import{u as Qe}from"../chunks/CWV1Rpwv.js";import{u as St,k as ca,t as Se,c as J,e as et,b as ua,i as wt}from"../chunks/OutaaHH7.js";import"../chunks/QWEcxSok.js";import"../chunks/B-Pwaivo.js";import"../chunks/69_IOA4Y.js";import{a as ma,c as ga,g as va}from"../chunks/lrI25eI9.js";import"../chunks/gBp1tBnA.js";import{e as mt}from"../chunks/SiegjVo0.js";import{s as yt,r as At,p as We,b as gt}from"../chunks/xQhUoIl9.js";import{S as fa}from"../chunks/ConpFqMd.js";import{r as Be}from"../chunks/7XnHnNk_.js";import{s as Je}from"../chunks/CpbA3HU7.js";import{B as ha,a as _a,b as Me,c as Ve,H as pa,d as je,D as ba,e as xa,u as $t,f as Sa,g as wa,Z as ya,h as Aa,S as $a}from"../chunks/nl6F34Ly.js";import{a as Ia,b as Pa,d as ka,e as Ea}from"../chunks/DuE3ODv7.js";function Ma(u,t){he(t,!0);/**
 * @license @lucide/svelte v0.482.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let v=At(t,["$$slots","$$events","$$legacy"]);const d=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["circle",{cx:"10",cy:"12",r:"2"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22"}]];ht(u,yt({name:"file-image"},()=>v,{get iconNode(){return d},children:(n,c)=>{var s=ue(),h=A(s);Re(h,()=>t.children??vt),r(n,s)},$$slots:{default:!0}})),_e()}function Ba(u,t){he(t,!0);/**
 * @license @lucide/svelte v0.482.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let v=At(t,["$$slots","$$events","$$legacy"]);const d=[["path",{d:"M18 22H4a2 2 0 0 1-2-2V6"}],["path",{d:"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18"}],["circle",{cx:"12",cy:"8",r:"2"}],["rect",{width:"16",height:"16",x:"6",y:"2",rx:"2"}]];ht(u,yt({name:"images"},()=>v,{get iconNode(){return d},children:(n,c)=>{var s=ue(),h=A(s);Re(h,()=>t.children??vt),r(n,s)},$$slots:{default:!0}})),_e()}var Ca=T('<!> <span class="hidden sm:inline">Home</span>',1),Ra=T('<!> <span class="max-w-[150px] truncate"> </span>',1),La=T('<!> <span class="hidden sm:inline">Samples</span>',1),Ta=T('<!> <span class="max-w-[200px] truncate"><!></span>',1),Da=T("<!> <!> <!> <!> <!> <!> <!>",1);function Na(u,t){he(t,!0);const v=()=>Q(c,"$filteredSampleCount",d),[d,n]=Le(),{filteredSampleCount:c}=Qe();ha(u,{class:"mb-2","data-testid":"sample-details-breadcrumb",children:(s,h)=>{_a(s,{children:(D,ee)=>{var B=Da(),$=A(B);Me($,{children:(y,X)=>{{let x=o(()=>Be.toHome());Ve(y,{get href(){return e(x)},class:"flex items-center gap-2",children:(N,P)=>{var b=Ca(),_=A(b);pa(_,{class:"h-4 w-4"}),Ke(2),r(N,b)},$$slots:{default:!0}})}},$$slots:{default:!0}});var G=g($,2);je(G,{});var I=g(G,2);Me(I,{children:(y,X)=>{{let x=o(()=>Be.toSamples(t.dataset.dataset_id));Ve(y,{get href(){return e(x)},class:"flex items-center gap-2",children:(N,P)=>{var b=Ra(),_=A(b);ba(_,{class:"h-4 w-4"});var C=g(_,2),j=p(C,!0);f(C),fe(()=>Je(j,t.dataset.name)),r(N,b)},$$slots:{default:!0}})}},$$slots:{default:!0}});var m=g(I,2);je(m,{});var V=g(m,2);Me(V,{children:(y,X)=>{{let x=o(()=>Be.toSamples(t.dataset.dataset_id));Ve(y,{get href(){return e(x)},class:"flex items-center gap-2",children:(N,P)=>{var b=La(),_=A(b);Ba(_,{class:"h-4 w-4"}),Ke(2),r(N,b)},$$slots:{default:!0}})}},$$slots:{default:!0}});var re=g(V,2);je(re,{});var le=g(re,2);Me(le,{children:(y,X)=>{xa(y,{class:"flex items-center gap-2",children:(x,N)=>{var P=Ta(),b=A(P);Ma(b,{class:"h-4 w-4"});var _=g(b,2),C=p(_);{var j=U=>{var ne=qe();fe(()=>Je(ne,`Sample ${t.sampleIndex+1} of ${v()??""}`)),r(U,ne)},me=U=>{var ne=qe("Sample");r(U,ne)};z(C,U=>{t.sampleIndex!==void 0?U(j):U(me,!1)})}f(_),r(x,P)},$$slots:{default:!0}})},$$slots:{default:!0}}),r(D,B)},$$slots:{default:!0}})},$$slots:{default:!0}}),_e(),n()}function Ha(u,t){he(t,!0);const v=()=>Q(e(G),"$annotationResp",c),d=()=>Q(e(re),"$sample",c),n=()=>Q(B,"$showAnnotationTextLabelsStore",c),[c,s]=Le(),h=We(t,"isResizable",3,!1),{addReversibleAction:D,clearReversibleActionsByGroupId:ee}=Qe(),{showAnnotationTextLabelsStore:B}=St(),$=o(()=>jt({datasetId:t.datasetId,annotationId:t.annotationId})),G=o(()=>e($).annotation),I=o(()=>e($).updateAnnotation);let m=o(()=>v().data);const V=o(()=>$t({sampleId:t.sampleId})),re=o(()=>e(V).sample);let le=o(()=>v().data?Zt(v().data):void 0);const y=P=>{(async()=>{try{await e(I)({annotation_id:t.annotationId,dataset_id:t.datasetId,bounding_box:P}),Sa({annotation:e(m),addReversibleAction:D,updateAnnotation:e(I)})}catch(_){console.error("Failed to update annotation:",_.message)}})()};ma(()=>{ee(wa)});var X=ue(),x=A(X);{var N=P=>{var b=ue(),_=A(b);ca(_,()=>e(le),C=>{Gt(C,{get groupId(){return e(m).annotation_id},get onSelect(){return t.toggleAnnotationSelection},get box(){return e(le)},get isSelected(){return t.isSelected},children:(j,me)=>{{let U=o(()=>({x:0,y:0,width:d().data.width,height:d().data.height}));Vt(j,{get annotation(){return e(m)},get showLabel(){return n()},get imageWidth(){return d().data.width},get constraintBox(){return e(U)},get isResizable(){return h()},onBoundingBoxChanged:y})}},$$slots:{default:!0}})}),r(P,b)};z(x,P=>{e(m)&&d().data&&e(le)&&P(N)})}r(u,X),_e(),s()}const Fa=({datasetId:u})=>{const t=Te(Ia());return t.subscribe(()=>{}),{createAnnotation:d=>new Promise((n,c)=>{ye(t).mutate({path:{dataset_id:u},body:d},{onSuccess:s=>{n(s)},onError:s=>{c(s)}})})}},za=()=>{const u=Te(Pa());return u.subscribe(()=>{}),{createLabel:v=>new Promise((d,n)=>{ye(u).mutate({body:v},{onSuccess:c=>{d(c)},onError:c=>{n(c)}})})}},Xa=({datasetId:u})=>{const t=Te(ka());return t.subscribe(()=>{}),{deleteAnnotation:d=>new Promise((n,c)=>{ye(t).mutate({path:{dataset_id:u,annotation_id:d}},{onSuccess:()=>{n()},onError:s=>{c(s)}})})}},Ua=({datasetId:u})=>{const t=Te(Ea());return t.subscribe(()=>{}),{removeTagFromSample:(d,n)=>new Promise((c,s)=>{ye(t).mutate({path:{dataset_id:u,sample_id:d,tag_id:n}},{onSuccess:()=>c(),onError:h=>s(h)})})}};var Ya=Ce('<line x1="0" stroke-width="1" vector-effect="non-scaling-stroke" stroke-dasharray="5,5" opacity="0.6"></line><line y1="0" vector-effect="non-scaling-stroke" stroke-width="1" stroke-dasharray="5,5" opacity="0.6"></line>',1),Oa=Ce('<rect class="select-none" fill="transparent" role="button" style="outline: 0;cursor: crosshair;" tabindex="0"></rect>'),Za=Ce("<g><!><!><!></g><!>",1),Ga=Ce("<image></image><!>",1),Va=T('<div class="h-full w-full overflow-hidden"><div class="sample relative h-full w-full"><div class="absolute right-4 top-2 z-30"><!></div> <!> <!></div></div>'),ja=T('<div class="flex h-full w-full flex-col space-y-4"><div class="flex w-full items-center"><!></div> <!> <div class="flex min-h-0 flex-1 gap-4"><div class="flex-1"><!></div> <div class="relative w-[375px]"><!></div></div></div>');function Ka(u,t){he(t,!0);const v=()=>Q(P,"$labels",h),d=()=>Q(_,"$isEditingMode",h),n=()=>Q(e(X),"$sample",h),c=()=>Q(ee,"$selectedSampleIds",h),s=()=>Q(G,"$isHidden",h),[h,D]=Le(),{selectedSampleIds:ee,toggleSampleSelection:B}=Qe(),$=t.dataset.dataset_id,{isHidden:G,handleKeyEvent:I}=Kt(),{settingsStore:m}=St(),{deleteAnnotation:V}=Xa({datasetId:$}),{removeTagFromSample:re}=Ua({datasetId:$}),le=()=>{va(Be.toSamples($))},y=o(()=>$t({sampleId:t.sampleId})),X=o(()=>e(y).sample),x=o(()=>e(y).refetch),{createAnnotation:N}=Fa({datasetId:$}),P=_t(),{createLabel:b}=za(),{isEditingMode:_}=we.data.globalStorage;let C=F(!1);const j=async({x:a,y:l,width:Y,height:q,labelName:S})=>{if(!v().data)return;let O=v().data.find(L=>L.annotation_label_name===S);O||(O=await b({annotation_label_name:S}));try{const L=await N({parent_sample_id:t.sampleId,annotation_type:"object_detection",x:Math.round(a),y:Math.round(l),width:Math.round(Y),height:Math.round(q),annotation_label_id:O.annotation_label_id});return e(x)(),i(k,L.annotation_id,!0),Se.success("Annotation created successfully"),L}catch(L){Se.error("Failed to create annotation. Please try again."),console.error("Error creating annotation:",L);return}},me=a=>{switch(a.key){case ye(m).key_go_back:d()?e(K)&&i(K,!1):le();break;case" ":a.preventDefault(),a.stopPropagation(),console.log("space pressed in sample details"),d()?i(C,!0):B(t.sampleId);break}I(a)},U=a=>{a.key===" "&&i(C,!1),I(a)};let ne=o(()=>Aa(t.sampleId)),k=F(void 0),H=F(void 0);ga(()=>{var a;i(k,void 0),i(pe,void 0),(a=e(H))==null||a(),i(K,!1),i(oe,void 0)});const ie=a=>{e(C)||(e(k)===a?i(k,void 0):i(k,a,!0))};let pe=F(void 0),te=F(!1),E=F(null),R=F(null),M=F(null);const Ae=()=>{i(te,!1),i(E,null),i(M,null)};let K=F(!1);const $e=10,ge=()=>{if(!e(R))return;const a=Jt(e(R));let l=null;const Y=Qt().on("start",q=>{if(!e(K))return;i(te,!0);const S=e(R).getBoundingClientRect(),O=q.sourceEvent.clientX,L=q.sourceEvent.clientY,W=(O-S.left)/S.width*n().data.width,Z=(L-S.top)/S.height*n().data.height;l={x:W,y:Z},i(E,{x:W,y:Z,width:0,height:0},!0),i(M,{x:W,y:Z},!0)}).on("drag",q=>{if(!e(E)||!e(te)||!l)return;const S=e(R).getBoundingClientRect(),O=q.sourceEvent.clientX,L=q.sourceEvent.clientY;let W=(O-S.left)/S.width*n().data.width,Z=(L-S.top)/S.height*n().data.height;const ze=n().data.width,Xe=n().data.height;W=Math.max(0,Math.min(W,ze)),Z=Math.max(0,Math.min(Z,Xe));const ve=Math.min(l.x,W),be=Math.min(l.y,Z),Ue=Math.abs(W-l.x),nt=Math.abs(Z-l.y);i(E,{x:ve,y:be,width:Ue,height:nt},!0),i(M,{x:W,y:Z},!0)}).on("end",()=>{!e(E)||!e(te)||(e(E).width>$e&&e(E).height>$e&&e(oe)&&j({x:e(E).x,y:e(E).y,width:e(E).width,height:e(E).height,labelName:e(oe).label}),Ae(),l=null)});return a.call(Y),a.on("mousemove",De),()=>{Y.on("start",null).on("drag",null).on("end",null)}},de=a=>{if(!e(R)||e(te))return;const l=e(R).getBoundingClientRect(),Y=a.clientX,q=a.clientY,S=(Y-l.left)/l.width*n().data.width,O=(q-l.top)/l.height*n().data.height;i(M,{x:S,y:O},!0),a.stopPropagation(),a.preventDefault()},De=qt.throttle(de,50);ft(()=>{ge(),e(X).subscribe(a=>{if(a.isSuccess&&a.data){let l=Wt(a.data);i(Ne,l,!0)}else i(Ne,[],!0)})});let oe=F(void 0),Ne=F(ct([])),Ie=F(ct(new Set));const It=a=>{const l=new Set(e(Ie));l.has(a)?l.delete(a):l.add(a),i(Ie,l,!0)},Pt=o(()=>e(Ne).filter(a=>!e(Ie).has(a.annotation_id))),He=o(()=>e(oe)?na(e(oe).label,1).color:"blue"),kt=async a=>{if(!n().data)return;(async()=>{try{await V(a),Se.success("Annotation deleted successfully"),e(x)(),e(k)===a&&i(k,void 0)}catch(Y){Se.error("Failed to delete annotation. Please try again."),console.error("Error deleting annotation:",Y)}})()},Et=async a=>{try{await re(t.sampleId,a),Se.success("Tag removed successfully"),e(x)()}catch(l){Se.error("Failed to remove tag. Please try again."),console.error("Error removing tag from sample:",l)}},Mt=o(()=>e(C)?"grab":e(Fe)?"crosshair":"auto"),Bt=o(()=>d()&&!e(C)),Fe=o(()=>e(K)&&!e(C)&&e(oe)!==void 0);let tt=F(null);var at=ue();mt("keydown",ut,me),mt("keyup",ut,U);var Ct=A(at);{var Rt=a=>{var l=ja(),Y=p(l),q=p(Y);Na(q,{get dataset(){return t.dataset},get sampleIndex(){return t.sampleIndex}}),f(Y);var S=g(Y,2);fa(S,{class:"mb-4 bg-border-hard"});var O=g(S,2),L=p(O),W=p(L);pt(W,{className:"h-full",children:(ve,be)=>{bt(ve,{className:"h-full",children:(Ue,nt)=>{var Ye=Va(),Oe=p(Ye),Ze=p(Oe),Tt=p(Ze);{let ce=o(()=>c().has(t.sampleId));ea(Tt,{onSelect:()=>B(t.sampleId),get isSelected(){return e(ce)}})}f(Ze);var ot=g(Ze,2);{var Dt=ce=>{var xe=ue(),Pe=A(xe);Re(Pe,()=>t.children),r(ce,xe)};z(ot,ce=>{t.children&&ce(Dt)})}var Nt=g(ot,2);ya(Nt,{get width(){return n().data.width},get height(){return n().data.height},get cursor(){return e(Mt)},get boundingBox(){return e(pe)},registerResetFn:xe=>i(H,xe,!0),zoomableContent:xe=>{var Pe=Ga(),st=A(Pe),Ht=g(st);{var Ft=Ge=>{var rt=Za(),ke=A(rt);let lt;var it=p(ke);et(it,17,()=>e(Pt),w=>w.annotation_id,(w,ae)=>{{let se=o(()=>e(k)===e(ae).annotation_id);Ha(w,{get annotationId(){return e(ae).annotation_id},get sampleId(){return t.sampleId},get datasetId(){return $},get isResizable(){return e(Bt)},get isSelected(){return e(se)},toggleAnnotationSelection:ie})}});var dt=g(it);{var zt=w=>{ta(w,{get bbox(){return e(E)},get colorStroke(){return e(He)},colorFill:"rgba(0, 123, 255, 0.1)",style:"outline: 0;",opacity:.8,scale:1})};z(dt,w=>{e(E)&&e(te)&&e(oe)&&w(zt)})}var Xt=g(dt);{var Ut=w=>{var ae=Ya(),se=A(ae),Ee=g(se);fe(()=>{J(se,"y1",e(M).y),J(se,"x2",n().data.width),J(se,"y2",e(M).y),J(se,"stroke",e(He)),J(Ee,"x1",e(M).x),J(Ee,"x2",e(M).x),J(Ee,"y2",n().data.height),J(Ee,"stroke",e(He))}),r(w,ae)};z(Xt,w=>{e(M)&&e(Fe)&&w(Ut)})}f(ke);var Yt=g(ke);{var Ot=w=>{var ae=Oa();gt(ae,se=>i(R,se),()=>e(R)),fe(()=>{J(ae,"width",n().data.width),J(ae,"height",n().data.height)}),r(w,ae)};z(Yt,w=>{e(Fe)&&w(Ot)})}fe(w=>lt=ua(ke,0,"",null,lt,w),[()=>({invisible:s()})]),r(Ge,rt)};z(Ht,Ge=>{n().data&&Ge(Ft)})}fe(()=>J(st,"href",e(ne))),r(xe,Pe)},$$slots:{zoomableContent:!0}}),f(Oe),gt(Oe,ce=>i(tt,ce),()=>e(tt)),f(Ye),r(Ue,Ye)},$$slots:{default:!0}})},$$slots:{default:!0}}),f(L);var Z=g(L,2),ze=p(Z);{var Xe=ve=>{nn(ve,{get sample(){return n().data},get annotationsIdsToHide(){return e(Ie)},get selectedAnnotationId(){return e(k)},onAnnotationClick:ie,onToggleShowAnnotation:It,onDeleteAnnotation:kt,onRemoveTag:Et,get onUpdate(){return e(x)},get addAnnotationEnabled(){return e(K)},set addAnnotationEnabled(be){i(K,be,!0)},get addAnnotationLabel(){return e(oe)},set addAnnotationLabel(be){i(oe,be,!0)}})};z(ze,ve=>{n().data&&ve(Xe)})}f(Z),f(O),f(l),r(a,l)},Lt=a=>{aa(a,{})};z(Ct,a=>{n().data?a(Rt):a(Lt,!1)})}r(u,at),_e(),D()}var qa=T('<div class="mb-2 gap-2 rounded-sm bg-card px-4 py-3 text-left align-baseline text-diffuse-foreground transition-colors"><span class="text-sm"> </span></div>'),Wa=T('<div class="flex flex-col items-start justify-start"></div>');function Ja(u,t){xt(u,{title:"Captions",children:(v,d)=>{var n=Wa();et(n,21,()=>t.captions,wt,(c,s)=>{let h=()=>e(s).text;var D=qa(),ee=p(D),B=p(ee,!0);f(ee),f(D),fe(()=>Je(B,h())),r(c,D)}),f(n),r(v,n)}})}var Qa=T('<label class="flex w-full flex-col gap-3 text-muted-foreground"><div class="text-sm">Select or create a label for a new annotation.</div> <!></label>'),en=T('<div class="items-left mb-2 flex flex-col justify-between space-y-2 bg-muted p-2"><div class="mb-2 w-full"><!></div> <!></div>'),tn=T('<div class="flex flex-col gap-3 space-y-4"><!> <div class="flex flex-col gap-2"></div></div>'),an=T('<div class="flex h-full min-h-0 flex-col space-y-4 overflow-y-auto dark:[color-scheme:dark]"><!> <!> <!> <!></div>');function nn(u,t){he(t,!0);const v=()=>Q($,"$annotationLabels",n),d=()=>Q(B,"$isEditingMode",n),[n,c]=Le();let s=We(t,"addAnnotationEnabled",15,!1),h=We(t,"addAnnotationLabel",15,void 0);const D=o(()=>t.sample.tags.map(m=>({tagId:m.tag_id,name:m.name}))??[]),ee=o(()=>t.sample.annotations?[...t.sample.annotations].sort((m,V)=>m.annotation_label.annotation_label_name.localeCompare(V.annotation_label.annotation_label_name)):[]),{isEditingMode:B}=we.data.globalStorage,$=_t(),G=o(()=>da(v().data||[]));ft(()=>{if(t.selectedAnnotationId){const m=document.querySelector(`button[data-annotation-id="${t.selectedAnnotationId}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}});const I=o(()=>t.sample.captions?t.sample.captions.map(m=>({text:m.text})):[]);pt(u,{className:"h-full",children:(m,V)=>{bt(m,{className:"h-full flex flex-col",children:(re,le)=>{var y=an(),X=p(y);oa(X,{get tags(){return e(D)},get onClick(){return t.onRemoveTag}});var x=g(X,2);xt(x,{title:"Annotations",children:(_,C)=>{var j=tn(),me=p(j);{var U=k=>{var H=en(),ie=p(H),pe=p(ie);{let R=o(()=>s()?"default":"outline");ra(pe,{title:"Add annotation",get variant(){return e(R)},"data-testid":"create-rectangle",class:"w-full",onclick:()=>{s(!s())},children:(M,Ae)=>{Ke();var K=qe("Add annotation");r(M,K)},$$slots:{default:!0}})}f(ie);var te=g(ie,2);{var E=R=>{var M=Qa(),Ae=g(p(M),2);{const K=(ge,de)=>{let De=()=>de==null?void 0:de().inputValue;ia(ge,{get label(){return De()}})};let $e=o(()=>e(G).find(ge=>{var de;return ge.value===((de=h())==null?void 0:de.value)}));la(Ae,{get items(){return e(G)},get selectedItem(){return e($e)},name:"annotation-label",label:"Choose or create a label",className:"w-full",contentClassName:"w-full",placeholder:"Select or create a label",onSelect:ge=>{h(ge)},notFound:K,$$slots:{notFound:!0}})}f(M),r(R,M)};z(te,R=>{s()&&R(E)})}f(H),r(k,H)};z(me,k=>{d()&&k(U)})}var ne=g(me,2);et(ne,21,()=>e(ee),wt,(k,H)=>{{let ie=o(()=>t.selectedAnnotationId===e(H).annotation_id),pe=o(()=>t.annotationsIdsToHide.has(e(H).annotation_id));sa(k,{get annotation(){return e(H)},get isSelected(){return e(ie)},onClick:()=>t.onAnnotationClick(e(H).annotation_id),onDeleteAnnotation:()=>t.onDeleteAnnotation(e(H).annotation_id),get isHidden(){return e(pe)},onToggleShowAnnotation:te=>{te.stopPropagation(),t.onToggleShowAnnotation(e(H).annotation_id)},get onUpdate(){return t.onUpdate}})}}),f(ne),f(j),r(_,j)}});var N=g(x,2);$a(N,{get sample(){return t.sample}});var P=g(N,2);{var b=_=>{Ja(_,{get captions(){return e(I)}})};z(P,_=>{e(I)&&_(b)})}f(y),r(re,y)},$$slots:{default:!0}})},$$slots:{default:!0}}),_e(),c()}var on=T('<div class="flex h-full w-full space-x-4 px-4 pb-4" data-testid="sample-details"><div class="h-full w-full space-y-6 rounded-[1vw] bg-card p-4"><!></div></div>');function Pn(u,t){he(t,!0);const v=o(()=>we.params.sampleId),d=we.data.dataset,n=o(()=>Number(we.params.sampleIndex));var c=on(),s=p(c),h=p(s);Ka(h,{get sampleId(){return e(v)},get dataset(){return d},get sampleIndex(){return e(n)},children:(D,ee)=>{var B=ue(),$=A(B);{var G=I=>{var m=ue(),V=A(m);Re(V,()=>t.children),r(I,m)};z($,I=>{t.children&&I(G)})}r(D,B)},$$slots:{default:!0}}),f(s),f(c),r(u,c),_e()}export{Pn as component};
