# {{ metadata.report_title }}

**Company:** {{ dd.company_name }}
**Version:** {{ gg.version }}
**Report Generated:** {{ metadata.generated_date }}
**Generated By:** PyTemplify v{{ gg.version }}

---

## Executive Summary

Company: {{ dd.company_name }} - Founded {{ dd.founded_year }}
Total Departments: {{ dd.departments | length }}

### Key Metrics

| Metric | Value |
|--------|-------|
| **Total Employees** | {{ dd.total_employees }} |
| **Total Departments** | {{ dd.departments | length }} |
| **Company Age** | {{ 2025 - dd.founded_year }} years |
| **Total Budget** | ${{ "{:,}".format(dd.departments | map(attribute='budget') | sum) }} |
| **Total Salary Expense** | ${{ "{:,}".format(dd.total_salary_expense) }} |
| **Avg. Department Size** | {{ "%.1f" | format(dd.average_department_size) }} employees |
| **Largest Department** | {{ dd.largest_department }} |

### Budget Analysis

- **Total Budget Allocated:** ${{ "{:,}".format(dd.total_budget) }}
- **Total Salary Expense:** ${{ "{:,}".format(dd.total_salary_expense) }}
- **Remaining Budget:** ${{ "{:,}".format(dd.total_budget - dd.total_salary_expense) }}
- **Salary as % of Budget:** {{ "%.1f" | format((dd.total_salary_expense / dd.total_budget * 100)) }}%

---

## Department Overview

{% for dept in dd.departments -%}
### {{ loop.index }}. {{ dept.department_name }} Department

{{ dept.department_summary }}

**Manager:** {{ dept.manager_name }}

| Metric | Value |
|--------|-------|
| Employees | {{ dept.employee_count }} |
| Budget | ${{ "{:,}".format(dept.budget) }} |
| Total Salaries | ${{ "{:,}".format(dept.employees | map(attribute='salary') | sum) }} |
| Average Salary | ${{ "{:,}".format((dept.employees | map(attribute='salary') | sum / dept.employee_count) | int) }} |
| Budget per Employee | ${{ "{:,}".format(dept.budget / dept.employee_count | int) }} |
| Highest Paid | {{ dept.employees | sort(attribute='salary') | last | attr('name') }} |
| Size Category | {% if dept.employees | length > 5 %}üè¢ Large Department{% else %}üè™ Standard Department{% endif %} |

**Team Members:**

{% for emp in dept.employees -%}
- **{{ emp.name }}** - {{ emp.title }}
  - Salary: {{ emp.formatted_salary }}
  - Annual Cost: {{ emp.formatted_annual_cost }}
  - Service: {{ emp.years_of_service }} years
  - Level: {{ emp.seniority_level }}{% if emp.is_senior %} ‚≠ê{% endif %}
{% endfor %}

---

{% endfor %}

## Statistics by Seniority

{% set senior_count = [] -%}
{% set mid_count = [] -%}
{% set junior_count = [] -%}

{% for dept in dd.departments -%}
  {% for emp in dept.employees -%}
    {% if emp.title | lower in ["senior engineer", "principal engineer", "senior", "principal"] -%}
      {% set _ = senior_count.append(1) -%}
    {% elif emp.title | lower in ["engineer", "representative", "manager", "director"] -%}
      {% set _ = mid_count.append(1) -%}
    {% else -%}
      {% set _ = junior_count.append(1) -%}
    {% endif -%}
  {% endfor -%}
{% endfor -%}

{% set total_emps = dd.departments | map(attribute='employee_count') | sum -%}
- **Senior/Principal Level:** {{ senior_count | length }} ({{ "%.0f" | format(senior_count | length / total_emps * 100) }}%)
- **Mid-Level:** {{ mid_count | length }} ({{ "%.0f" | format(mid_count | length / total_emps * 100) }}%)
- **Junior Level:** {{ junior_count | length }} ({{ "%.0f" | format(junior_count | length / total_emps * 100) }}%)

---

*Report generated by {{ metadata.report_title }} - PyTemplify with Data Helpers*
