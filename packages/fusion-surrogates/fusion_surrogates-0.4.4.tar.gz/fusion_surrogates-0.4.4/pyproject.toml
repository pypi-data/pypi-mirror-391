[build-system]
requires = [
  "setuptools>=64",
  "setuptools-scm>=8",
  "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "fusion_surrogates"
description = "Transport surrogate models for Tokamak fusion."
version = "0.4.4"
readme = "README.md"
requires-python = ">=3.11"
license = "Apache-2.0"
license-files = ["LICENSE"]
authors = [{name = "DeepMind"}]
classifiers = [
    "Intended Audience :: Science/Research",
]

dependencies = [
    "absl-py>=2.0.0",
    "flax>=0.7.5",
    "immutabledict",
    "jax>=0.4.31",
    "numpy>2",
    "setuptools;python_version>='3.11'",
]

[project.optional-dependencies]

tglfnnukaea = [
    "tglfnn_ukaea==0.1.0",
]

testing = [
    # Self-refernce to the optional dependency.
    "fusion_surrogates[tglfnnukaea]",
    # Extra dependencies for testing.
    "chex",
    "isort",
    "jaxonnxruntime",
    "onnx",
    "pytest",
    "pytest-xdist",
    "pylint>=2.6.0",
    "pyink",
]

[tool.setuptools.packages.find]
include = ["fusion_surrogates*"]

[tool.isort]
profile = "google"
known_third_party = 'fusion_surrogates'

[tool.pyink]
# Formatting configuration to follow Google style-guide
line-length = 80
unstable = true
target-version = []
pyink-indentation = 2
pyink-use-majority-quotes = true
pyink-annotation-pragmas = [
  "noqa",
  "pylint:",
  "type: ignore",
  "pytype:",
  "mypy:",
  "pyright:",
  "pyre-",
]
