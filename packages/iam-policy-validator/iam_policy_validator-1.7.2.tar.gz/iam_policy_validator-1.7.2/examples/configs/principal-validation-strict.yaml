# Strict Principal Validation Configuration
# This config blocks all public access and uses whitelist mode

settings:
  enable_builtin_checks: true
  fail_on_severity:
    - error
    - critical
    - high

principal_validation:
  enabled: true
  severity: critical  # Treat as critical security issue

  # Block all dangerous principals
  blocked_principals:
    - "*"  # Public access
    - "arn:aws:iam::*:root"  # All AWS accounts (too broad)

  # Whitelist mode: ONLY these principals are allowed
  allowed_principals:
    - "arn:aws:iam::123456789012:*"  # My own account
    - "arn:aws:iam::987654321098:role/TrustedPartnerRole"  # Specific partner role

  # Require org ID for any cross-account access
  require_conditions_for:
    "arn:aws:iam::*:*":
      - "aws:PrincipalOrgID"

  # Allow common AWS service principals
  allowed_service_principals:
    - "cloudfront.amazonaws.com"
    - "s3.amazonaws.com"
    - "apigateway.amazonaws.com"
    - "lambda.amazonaws.com"
    - "logs.amazonaws.com"
