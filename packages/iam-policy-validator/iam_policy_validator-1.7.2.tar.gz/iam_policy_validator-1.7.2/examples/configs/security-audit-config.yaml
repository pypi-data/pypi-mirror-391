# Security Audit Configuration
# Maximum strictness for security audits and compliance checks
# Fails on all severity levels for comprehensive reporting

settings:
  fail_fast: false  # Report all issues, don't stop early
  max_concurrent: 10
  enable_builtin_checks: true
  parallel_execution: true

  # AWS services configuration
  aws_services_dir: null
  cache_enabled: true
  cache_ttl_hours: 168

  # Fail on ALL severity levels for audit purposes
  fail_on_severity:
    - error
    - warning
    - critical
    - high
    - medium
    - low

# AWS Validation - Maximum strictness
sid_uniqueness:
  enabled: true
  severity: error

policy_size:
  enabled: true
  severity: error

action_validation:
  enabled: true
  severity: error

condition_key_validation:
  enabled: true
  severity: error
  validate_aws_global_keys: true
  warn_on_global_condition_keys: true  # Enable all warnings

condition_type_mismatch:
  enabled: true
  severity: error

set_operator_validation:
  enabled: true
  severity: error

mfa_condition_antipattern:
  enabled: true
  severity: high  # Upgrade from warning to high

resource_validation:
  enabled: true
  severity: error

principal_validation:
  enabled: true
  severity: critical  # Upgrade to critical for audits
  # Strict principal validation
  blocked_principals:
    - "*"
    - "arn:aws:iam::*:root"  # Block all cross-account root access

policy_type_validation:
  enabled: true
  severity: error

action_resource_constraint:
  enabled: true
  severity: error

action_resource_matching:
  enabled: true
  severity: high  # Upgrade from medium

# Security Best Practices - Maximum strictness
wildcard_action:
  enabled: true
  severity: critical  # Upgrade to critical

wildcard_resource:
  enabled: true
  severity: critical  # Upgrade to critical

full_wildcard:
  enabled: true
  severity: critical

service_wildcard:
  enabled: true
  severity: critical  # Upgrade to critical
  # Only allow absolutely safe services
  allowed_services:
    - logs
    - cloudwatch

sensitive_action:
  enabled: true
  severity: critical  # Upgrade to critical
  # Check ALL categories
  # categories: []  # Empty means all categories
  # Use category-specific severities
  category_severities:
    credential_exposure: critical
    data_access: high
    priv_esc: critical
    resource_exposure: high

# Maximum condition enforcement
action_condition_enforcement:
  enabled: true
  severity: critical  # Upgrade to critical
  # Uses all 6 requirements (5 default + 1 optional)
  # To enable all requirements in Python:
  #   from iam_validator.core.config import get_all_requirements
  #   requirements = list(get_all_requirements().values())
