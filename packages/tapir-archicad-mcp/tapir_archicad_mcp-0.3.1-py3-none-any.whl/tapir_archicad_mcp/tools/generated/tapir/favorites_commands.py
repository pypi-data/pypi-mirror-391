# This file is auto-generated by generate_tools.py. DO NOT EDIT.
import logging
from pydantic import ValidationError
from multiconn_archicad.basic_types import Port
from tapir_archicad_mcp.context import multi_conn_instance
from tapir_archicad_mcp.tools.tool_registry import register_tool_for_dispatch

from multiconn_archicad.models.tapir.commands import (
    ApplyFavoritesToElementDefaultsParameters,
ApplyFavoritesToElementDefaultsResult,
CreateFavoritesFromElementsParameters,
CreateFavoritesFromElementsResult,
GetFavoritesByTypeParameters,
GetFavoritesByTypeResult
)


log = logging.getLogger()

def apply_favorites_to_element_defaults(port: int, params: ApplyFavoritesToElementDefaultsParameters) -> ApplyFavoritesToElementDefaultsResult:
    """
    Apply the given favorites to element defaults.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="ApplyFavoritesToElementDefaults",
            parameters=params.model_dump(mode='json')
        )
        return ApplyFavoritesToElementDefaultsResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for ApplyFavoritesToElementDefaults result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing ApplyFavoritesToElementDefaults on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    apply_favorites_to_element_defaults,
    name="favorites_apply_favorites_to_element_defaults",
    title="ApplyFavoritesToElementDefaults",
    description="Apply the given favorites to element defaults.",
    params_model=ApplyFavoritesToElementDefaultsParameters,
    result_model=ApplyFavoritesToElementDefaultsResult
)


def create_favorites_from_elements(port: int, params: CreateFavoritesFromElementsParameters) -> CreateFavoritesFromElementsResult:
    """
    Create favorites from the given elements.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="CreateFavoritesFromElements",
            parameters=params.model_dump(mode='json')
        )
        return CreateFavoritesFromElementsResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for CreateFavoritesFromElements result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing CreateFavoritesFromElements on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    create_favorites_from_elements,
    name="favorites_create_favorites_from_elements",
    title="CreateFavoritesFromElements",
    description="Create favorites from the given elements.",
    params_model=CreateFavoritesFromElementsParameters,
    result_model=CreateFavoritesFromElementsResult
)


def get_favorites_by_type(port: int, params: GetFavoritesByTypeParameters) -> GetFavoritesByTypeResult:
    """
    Returns a list of the names of all favorites with the given element type
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="GetFavoritesByType",
            parameters=params.model_dump(mode='json')
        )
        return GetFavoritesByTypeResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for GetFavoritesByType result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing GetFavoritesByType on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    get_favorites_by_type,
    name="favorites_get_favorites_by_type",
    title="GetFavoritesByType",
    description="Returns a list of the names of all favorites with the given element type",
    params_model=GetFavoritesByTypeParameters,
    result_model=GetFavoritesByTypeResult
)
