import{d as B,R as z,ae as g,h as r,q as P,o as u,m,c as i,a as f,l as a,n as l,bm as q,bn as D,bo as G,bp as L,bq as N,br as $,bs as A,aw as S,e as J,v as K,bt as M,ah as x,bu as Y,al as H,bv as Q,bw as W,bx as X,by as Z,bz as ee,bg as h,i as k,k as o,a6 as le,bA as U,bB as te,bC as se,bD as ne,bE as ae,bF as oe,bG as ue}from"./index-Dhxp3bbZ.js";import{u as re}from"./usePageTitle-Dn837hxV.js";const ie={class:"flow-run-graphs__graph-panel-container"},fe={class:"flow-run-graphs__graphs"},ce={class:"flow-run-graphs__panel p-background"},pe=B({__name:"FlowRunGraphs",props:{flowRun:{}},setup(O){const v=z(),d=g(),n=g(!1),e=g(null),w=r(()=>({root:{"flow-run-graphs--fullscreen":n.value,"flow-run-graphs--show-panel":e.value?.kind==="task-run"||e.value?.kind==="flow-run"}})),c=async({nodeId:p,since:s,until:t})=>{const b={anyResource:{id:[`prefect.flow-run.${p}`]},event:{excludePrefix:["prefect.log.write","prefect.task-run."]},occurred:{since:s,until:t}},{events:_}=await v.events.getEvents(b);return _};return(p,s)=>(u(),P("div",{class:S(["flow-run-graphs",w.value.root])},[m("div",ie,[m("div",fe,[a(l(q),{fullscreen:n.value,"onUpdate:fullscreen":s[0]||(s[0]=t=>n.value=t),viewport:d.value,"onUpdate:viewport":s[1]||(s[1]=t=>d.value=t),selected:e.value,"onUpdate:selected":s[2]||(s[2]=t=>e.value=t),"flow-run":p.flowRun,"fetch-events":c,class:"flow-run-graphs__flow-run"},null,8,["fullscreen","viewport","selected","flow-run"])]),m("div",ce,[e.value?.kind==="task-run"||e.value?.kind==="flow-run"?(u(),i(l(D),{key:0,selection:e.value,"onUpdate:selection":s[3]||(s[3]=t=>e.value=t),floating:n.value},null,8,["selection","floating"])):f("",!0)])]),e.value&&e.value.kind==="event"?(u(),i(l(G),{key:0,selection:e.value,"onUpdate:selection":s[4]||(s[4]=t=>e.value=t)},null,8,["selection"])):f("",!0),e.value&&e.value.kind==="events"?(u(),i(l(L),{key:1,selection:e.value,"onUpdate:selection":s[5]||(s[5]=t=>e.value=t)},null,8,["selection"])):f("",!0),e.value&&e.value.kind==="artifacts"?(u(),i(l(N),{key:2,selection:e.value,"onUpdate:selection":s[6]||(s[6]=t=>e.value=t)},null,8,["selection"])):f("",!0),e.value?.kind==="state"?(u(),i(l($),{key:3,selection:e.value,"onUpdate:selection":s[7]||(s[7]=t=>e.value=t)},null,8,["selection"])):f("",!0),a(l(A),{selection:e.value,"onUpdate:selection":s[8]||(s[8]=t=>e.value=t)},null,8,["selection"])],2))}}),we=B({__name:"FlowRun",setup(O){const v=J(),d=K("flowRunId"),{flowRun:n,subscription:e}=M(d,{interval:5e3}),w=r(()=>x(n.value?.parameters??{})),c=r(()=>n.value?.stateType?Y(n.value.stateType):!0),p=r(()=>x(n.value?.jobVariables??{})),s=r(()=>[{label:"Logs"},{label:"Task Runs",hidden:c.value},{label:"Subflow Runs",hidden:c.value},{label:"Artifacts",hidden:c.value},{label:"Details"},{label:"Parameters"},{label:"Job Variables"}]),t=H("tab","Logs"),{tabs:b}=Q(s,t),_=r(()=>[d.value]),{filter:F}=W({flowRuns:{parentFlowRunId:_}});function j(){v.push(h.runs())}X(n);const E=r(()=>n.value?`Flow Run: ${n.value.name}`:"Flow Run");return re(E),Z(()=>{e.error&&ee(e.error).isInRange("clientError")&&v.replace(h[404]())}),(C,R)=>{const y=k("p-code-highlight"),I=k("p-tabs"),T=k("p-layout-default");return l(n)?(u(),i(T,{key:l(n).id,class:"flow-run"},{header:o(()=>[a(l(ue),{"flow-run-id":l(n).id,onDelete:j},null,8,["flow-run-id"])]),default:o(()=>[c.value?f("",!0):(u(),i(pe,{key:0,"flow-run":l(n)},null,8,["flow-run"])),a(I,{selected:l(t),"onUpdate:selected":R[0]||(R[0]=V=>le(t)?t.value=V:null),tabs:l(b)},{details:o(()=>[a(l(oe),{"flow-run":l(n)},null,8,["flow-run"])]),logs:o(()=>[a(l(ae),{"flow-run":l(n)},null,8,["flow-run"])]),artifacts:o(()=>[a(l(ne),{"flow-run":l(n)},null,8,["flow-run"])]),"task-runs":o(()=>[a(l(se),{"flow-run-id":l(n).id},null,8,["flow-run-id"])]),"subflow-runs":o(()=>[a(l(te),{filter:l(F)},null,8,["filter"])]),parameters:o(()=>[a(l(U),{"text-to-copy":w.value},{default:o(()=>[a(y,{lang:"json",text:w.value,class:"flow-run__parameters"},null,8,["text"])]),_:1},8,["text-to-copy"])]),"job-variables":o(()=>[a(l(U),{"text-to-copy":p.value},{default:o(()=>[a(y,{lang:"json",text:p.value,class:"flow-run__job-variables"},null,8,["text"])]),_:1},8,["text-to-copy"])]),_:1},8,["selected","tabs"])]),_:1})):f("",!0)}}});export{we as default};
//# sourceMappingURL=FlowRun-B_ygpwt3.js.map
