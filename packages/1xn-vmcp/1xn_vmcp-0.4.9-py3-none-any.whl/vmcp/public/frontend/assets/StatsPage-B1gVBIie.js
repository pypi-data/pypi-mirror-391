import{j as e}from"./ui-DTFgKa_e.js";import{r as a}from"./vendor-Dje7enk0.js";import{c as T,q as p,u as ue,d as he,O as ge,B as N,S as $,I as fe,z as pe,o as je,s as Ne,a as be,M as ve}from"./index-0yrTELIs.js";import{C as g,a as f,d as P,b as A,c as L}from"./card-HakkjSnQ.js";import{B as q}from"./badge-DYcv9hhs.js";import{a as E,C as we}from"./checkbox-B7a3BiW-.js";import{S as D}from"./searchable-select-7_jTkAQF.js";import{R as J}from"./refresh-cw-trgQJQ0C.js";import{A as ye}from"./activity-C4FDIIx4.js";import{Z as ke}from"./zap-C10tSVHS.js";import{C as Q}from"./chevron-down-BUL9fqa3.js";import{C as Ce}from"./clock-ClsemTc6.js";import{F as Se}from"./file-text-CdJnDdiQ.js";import"./check-Co6QAt8M.js";const _e=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],v=T("bot",_e);const Te=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Me=T("chevron-left",Te);const Fe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Z=T("funnel",Fe);const Re=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Pe=T("target",Re),I=a.forwardRef(({className:l,...t},n)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:n,className:p("w-full caption-bottom text-sm",l),...t})}));I.displayName="Table";const G=a.forwardRef(({className:l,...t},n)=>e.jsx("thead",{ref:n,className:p("[&_tr]:border-b",l),...t}));G.displayName="TableHeader";const K=a.forwardRef(({className:l,...t},n)=>e.jsx("tbody",{ref:n,className:p("[&_tr:last-child]:border-0",l),...t}));K.displayName="TableBody";const Ae=a.forwardRef(({className:l,...t},n)=>e.jsx("tfoot",{ref:n,className:p("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...t}));Ae.displayName="TableFooter";const _=a.forwardRef(({className:l,...t},n)=>e.jsx("tr",{ref:n,className:p("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...t}));_.displayName="TableRow";const d=a.forwardRef(({className:l,...t},n)=>e.jsx("th",{ref:n,className:p("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",l),...t}));d.displayName="TableHead";const i=a.forwardRef(({className:l,...t},n)=>e.jsx("td",{ref:n,className:p("p-4 align-middle [&:has([role=checkbox])]:pr-0",l),...t}));i.displayName="TableCell";const Le=a.forwardRef(({className:l,...t},n)=>e.jsx("caption",{ref:n,className:p("mt-4 text-sm text-muted-foreground",l),...t}));Le.displayName="TableCaption";const U=({data:l,label:t,maxChars:n})=>{const[M,w]=a.useState(!1),j=JSON.stringify(l,null,2),y=j.length>n,o=y?j.substring(0,n)+"...":j;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t}),y&&e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>w(!0),className:"h-6 px-2 text-xs hover:bg-muted",children:"Show More"})]}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto whitespace-pre-wrap border border-border",children:o})]}),e.jsx(ve,{isOpen:M,onClose:()=>w(!1),title:t,size:"xl",children:e.jsx("pre",{className:"text-sm bg-muted p-4 rounded overflow-x-auto whitespace-pre-wrap border border-border max-h-[70vh] overflow-y-auto",children:j})})]})};function We(){ue();const{error:l}=he(),[t,n]=a.useState(null),[M,w]=a.useState(!0),[j,y]=a.useState(!1),[o,W]=a.useState(1),[C]=a.useState(20),[m,z]=a.useState([]),[x,B]=a.useState([]),[u,O]=a.useState([]),[k,V]=a.useState(""),[r,X]=a.useState({index:!0,client:!0,timestamp:!0,method:!0,vmcp:!0,mcpServer:!0,operationId:!0,arguments:!0,result:!0,activeConfig:!0}),[F,Y]=a.useState(!0),[R,ee]=a.useState(!0),[De,Ie]=a.useState(0),b=async(s=1,c={})=>{try{w(!0);const S=localStorage.getItem("access_token");if(!S){l("Please log in to view stats");return}const h=await be.getStats({page:s,limit:C,...c},S);if(h.success&&h.data){const de={...h.data,pagination:{...h.data.pagination,total_pages:h.data.pagination.pages??h.data.pagination.total_pages},logs:h.data.logs.sort((me,xe)=>new Date(xe.timestamp).getTime()-new Date(me.timestamp).getTime())};n(de),W(s)}else l(h.error||"Failed to fetch stats")}catch(S){console.error("Error fetching stats:",S),l("Failed to fetch stats")}finally{w(!1),y(!1)}},se=()=>{y(!0);const s={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0,search:k||void 0};b(o,s)},te=()=>{const s={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0,search:k||void 0};b(1,s)},H=s=>{if(t&&s!==o&&s>=1&&s<=t.pagination.total_pages){const c={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0,search:k||void 0};b(s,c)}},ae=()=>{const s={agent_name:m.length>0?m.join(","):void 0,vmcp_name:x.length>0?x.join(","):void 0,method:u.length>0?u.join(","):void 0,search:k||void 0};b(1,s)},re=()=>{z([]),B([]),O([]),V(""),b(1,{})};a.useEffect(()=>{b(1,{})},[]);const le=s=>new Date(s).toLocaleString(),ne=s=>{const c=s.toLowerCase();return c.includes("claude")?e.jsx(v,{className:"h-4 w-4 text-orange-600"}):c.includes("visual studio")||c.includes("vscode")||c.includes("vs code")?e.jsx(v,{className:"h-4 w-4 text-blue-600"}):c.includes("cursor")?e.jsx(v,{className:"h-4 w-4 text-purple-600"}):c.includes("gemini")?e.jsx(v,{className:"h-4 w-4 text-yellow-600"}):e.jsx(v,{className:"h-4 w-4 text-blue-600"})},ce=s=>s.includes("tool")?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s.includes("resource")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s.includes("prompt")?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",oe=s=>{X(c=>({...c,[s]:!c[s]}))},ie=[{key:"index",label:"#"},{key:"client",label:"Client"},{key:"timestamp",label:"Timestamp"},{key:"method",label:"Method"},{key:"vmcp",label:"vMCP"},{key:"mcpServer",label:"MCP Server"},{key:"operationId",label:"Operation ID"},{key:"arguments",label:"Arguments"},{key:"result",label:"Result"},{key:"activeConfig",label:"Active Config"}];return M?e.jsx("div",{className:"min-h-screen text-foreground flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading stats..."})]})}):e.jsxs("div",{className:"min-h-screen mx-auto p-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(ge,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Statistics"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Comprehensive analytics and logs overview"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(N,{onClick:se,disabled:j,variant:"outline",size:"sm",children:[e.jsx(J,{className:`h-4 w-4 mr-2 ${j?"animate-spin":""}`}),"Refresh"]})})]})}),t&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-2 mb-4",children:[e.jsx(g,{children:e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsx(ye,{className:"h-3 w-3 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Total Logs"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_logs.toLocaleString()})]})]})})}),e.jsx(g,{children:e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx(v,{className:"h-3 w-3 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Active Clients"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_agents})]})]})})}),e.jsx(g,{children:e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-purple-100 dark:bg-purple-900 flex items-center justify-center",children:e.jsx($,{className:"h-3 w-3 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"vMCPs"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_vmcps})]})]})})}),e.jsx(g,{children:e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-orange-100 dark:bg-orange-900 flex items-center justify-center",children:e.jsx(ke,{className:"h-3 w-3 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Tool Calls"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_tool_calls.toLocaleString()})]})]})})}),e.jsx(g,{children:e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-cyan-100 dark:bg-cyan-900 flex items-center justify-center",children:e.jsx(Pe,{className:"h-3 w-3 text-cyan-600 dark:text-cyan-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Avg Tools/Call"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.avg_tools_per_call})]})]})})})]}),e.jsxs(g,{className:"mb-4",children:[e.jsxs(P,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>Y(!F),children:[e.jsxs(A,{className:"text-foreground flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Filters & Search"]}),F?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(E,{className:"h-4 w-4"})]}),e.jsx(L,{className:"text-muted-foreground",children:"Filter logs by client, vMCP, method, or search across all fields"})]}),!F&&e.jsxs(f,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"vMCP Name"}),e.jsx(D,{options:t?.filter_options?.vmcp_names||[],value:x,onValueChange:B,placeholder:"Select vMCPs...",searchPlaceholder:"Search vMCPs...",emptyText:"No vMCPs found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Client Name"}),e.jsx(D,{options:t?.filter_options?.agent_names||[],value:m,onValueChange:z,placeholder:"Select clients...",searchPlaceholder:"Search clients...",emptyText:"No clients found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Method"}),e.jsx(D,{options:t?.filter_options?.methods||[],value:u,onValueChange:O,placeholder:"Select methods...",searchPlaceholder:"Search methods...",emptyText:"No methods found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Search"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(fe,{placeholder:"Search logs...",value:k,onChange:s=>V(s.target.value),className:"bg-background border-border text-foreground"}),e.jsx(N,{onClick:ae,size:"sm",children:e.jsx(pe,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{onClick:te,className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Apply Filters"]}),e.jsx(N,{onClick:re,variant:"outline",className:"flex items-center gap-2",children:"Clear Filters"})]})]})]}),e.jsxs(g,{className:"mb-4",children:[e.jsxs(P,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>ee(!R),children:[e.jsxs(A,{className:"text-foreground flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Column Visibility"]}),R?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(E,{className:"h-4 w-4"})]}),e.jsx(L,{className:"text-muted-foreground",children:"Select which columns to display in the logs table"})]}),!R&&e.jsx(f,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:ie.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(we,{id:s.key,checked:r[s.key],onCheckedChange:()=>oe(s.key)}),e.jsx("label",{htmlFor:s.key,className:"text-sm font-medium text-foreground cursor-pointer",children:s.label})]},s.key))})})]}),e.jsxs(g,{children:[e.jsxs(P,{children:[e.jsx(A,{className:"text-foreground",children:"System Logs"}),e.jsx(L,{className:"text-muted-foreground",children:"Detailed view of all system activities with filtering and pagination"})]}),e.jsxs(f,{children:[e.jsxs("div",{className:"w-full overflow-hidden",children:[e.jsx("div",{className:"sticky top-0 bg-background z-30 border-b border-border",children:e.jsx(I,{className:"min-w-full",children:e.jsx(G,{children:e.jsxs(_,{className:"border-border",children:[r.index&&e.jsx(d,{className:"text-muted-foreground w-[2%] bg-background",children:"#"}),r.client&&e.jsx(d,{className:"text-muted-foreground w-[8%] bg-background",children:"Client"}),r.timestamp&&e.jsx(d,{className:"text-muted-foreground w-[12%] bg-background",children:"Timestamp"}),r.method&&e.jsx(d,{className:"text-muted-foreground w-[10%] bg-background",children:"Method"}),r.vmcp&&e.jsx(d,{className:"text-muted-foreground w-[12%] bg-background",children:"vMCP"}),r.mcpServer&&e.jsx(d,{className:"text-muted-foreground w-[10%] bg-background",children:"MCP Server"}),r.operationId&&e.jsx(d,{className:"text-muted-foreground w-[13%] bg-background",children:"Operation ID"}),r.arguments&&e.jsx(d,{className:"text-muted-foreground w-[15%] bg-background",children:"Arguments"}),r.result&&e.jsx(d,{className:"text-muted-foreground w-[15%] bg-background",children:"Result"}),r.activeConfig&&e.jsx(d,{className:"text-muted-foreground w-[10%] bg-background",children:"Active Config"})]})})})}),e.jsx("div",{id:"logs-table-container",className:"h-[700px] overflow-auto",children:e.jsx(I,{className:"min-w-full",children:e.jsx(K,{children:t&&t.logs&&t.logs.length>0?t.logs.map((s,c)=>e.jsxs(_,{className:"border-border hover:bg-muted/50",children:[r.index&&e.jsx(i,{className:"text-foreground font-medium text-center w-[5%]",children:(o-1)*C+c+1}),r.client&&e.jsx(i,{className:"text-foreground w-[8%]",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[ne(s.agent_name),e.jsx("span",{className:"text-sm font-medium truncate",children:s.agent_name})]})}),r.timestamp&&e.jsx(i,{className:"text-foreground w-[12%]",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate",children:le(s.timestamp)})]})}),r.method&&e.jsx(i,{className:"text-foreground w-[10%]",children:e.jsx(q,{className:`text-xs ${ce(s.method)}`,children:s.method})}),r.vmcp&&e.jsx(i,{className:"text-foreground w-[12%]",children:e.jsx("div",{className:"truncate",children:s.vmcp_name?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-3 w-3 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-sm font-mono truncate",children:s.vmcp_name})]}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),r.mcpServer&&e.jsx(i,{className:"text-foreground w-[10%]",children:e.jsx("div",{className:"truncate",children:s.mcp_server?e.jsx(q,{variant:"secondary",className:"bg-muted text-foreground truncate max-w-full",children:s.mcp_server}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),r.operationId&&e.jsx(i,{className:"text-foreground w-[13%]",children:e.jsx("span",{className:"text-sm font-mono truncate block",children:s.operation_id||"N/A"})}),r.arguments&&e.jsx(i,{className:"text-foreground w-[15%]",children:e.jsx("div",{className:"truncate",children:s.arguments?e.jsx(U,{data:s.arguments,label:"Arguments",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No arguments"})})}),r.result&&e.jsx(i,{className:"text-foreground w-[15%]",children:e.jsx("div",{className:"truncate",children:s.result?e.jsx(U,{data:s.result,label:"Result",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No result"})})}),r.activeConfig&&e.jsx(i,{className:"text-foreground w-[10%]",children:e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{children:[s.total_tools||0," tools"]}),e.jsxs("div",{children:[s.total_prompts||0," prompts"]}),e.jsxs("div",{children:[s.total_resources||0," resources"]})]})})]},c)):e.jsx(_,{children:e.jsxs(i,{colSpan:Object.values(r).filter(Boolean).length,className:"text-center py-8",children:[e.jsx(Se,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No logs found"}),e.jsx("p",{className:"text-muted-foreground",children:"Logs will appear here when agents make requests."})]})})})})})]}),t&&t.pagination.total>0&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(o-1)*C+1," to ",Math.min(o*C,t.pagination.total)," of ",t.pagination.total," logs"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>H(o-1),disabled:o===1,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-muted-foreground px-3",children:["Page ",o," of ",t.pagination.total_pages]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>H(o+1),disabled:o>=t.pagination.total_pages,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:["Next",e.jsx(Ne,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]})}export{We as default};
//# sourceMappingURL=StatsPage-B1gVBIie.js.map
