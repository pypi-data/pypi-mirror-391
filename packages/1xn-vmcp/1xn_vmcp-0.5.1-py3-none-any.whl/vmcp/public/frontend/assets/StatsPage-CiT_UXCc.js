import{j as e}from"./ui-DTFgKa_e.js";import{r as n}from"./vendor-Dje7enk0.js";import{c as _,p as b,u as de,d as me,N as xe,B as p,S as H,I as ue,y as he,n as ge,r as fe,a as pe,M as je}from"./index-pMK5HuNj.js";import{C as h,a as g,d as P,b as A,c as L}from"./card-CvylzpgM.js";import{B as $}from"./badge-CEEkW8_A.js";import{a as E,C as Ne}from"./checkbox-LCtAaU9P.js";import{S as D}from"./searchable-select-Ctp9XzhC.js";import{R as q}from"./refresh-cw-UJQ8yzFb.js";import{A as be}from"./activity-BcmFcUJK.js";import{Z as ve}from"./zap-BMO6GBQT.js";import{C as J}from"./chevron-down-DQ5AwFcd.js";import{F as ye}from"./file-text-JPw771lk.js";import"./check-CFHtpoo7.js";const ke=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],N=_("bot",ke);const we=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ce=_("chevron-left",we);const Se=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Q=_("funnel",Se);const _e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Me=_("target",_e);function Te({className:r,...t}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:b("w-full caption-bottom text-sm",r),...t})})}function Fe({className:r,...t}){return e.jsx("thead",{"data-slot":"table-header",className:b("[&_tr]:border-b",r),...t})}function Pe({className:r,...t}){return e.jsx("tbody",{"data-slot":"table-body",className:b("[&_tr:last-child]:border-0",r),...t})}function I({className:r,...t}){return e.jsx("tr",{"data-slot":"table-row",className:b("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",r),...t})}function i({className:r,...t}){return e.jsx("th",{"data-slot":"table-head",className:b("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...t})}function o({className:r,...t}){return e.jsx("td",{"data-slot":"table-cell",className:b("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...t})}const Z=({data:r,label:t,maxChars:w})=>{const[M,v]=n.useState(!1),f=JSON.stringify(r,null,2),y=f.length>w,c=y?f.substring(0,w)+"...":f;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t}),y&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>v(!0),className:"h-6 px-2 text-xs hover:bg-muted",children:"Show More"})]}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto whitespace-pre-wrap border border-border",children:c})]}),e.jsx(je,{isOpen:M,onClose:()=>v(!1),title:t,size:"xl",children:e.jsx("pre",{className:"text-sm bg-muted p-4 rounded overflow-x-auto whitespace-pre-wrap border border-border max-h-[70vh] overflow-y-auto",children:f})})]})};function Ze(){de();const{error:r}=me(),[t,w]=n.useState(null),[M,v]=n.useState(!0),[f,y]=n.useState(!1),[c,U]=n.useState(1),[C]=n.useState(20),[d,R]=n.useState([]),[m,V]=n.useState([]),[x,z]=n.useState([]),[k,B]=n.useState(""),[a,G]=n.useState({index:!0,client:!0,timestamp:!0,method:!0,vmcp:!0,mcpServer:!1,operationId:!1,arguments:!0,result:!0,activeConfig:!1}),[T,K]=n.useState(!0),[F,W]=n.useState(!0),[Ae,Le]=n.useState(0),j=async(s=1,l={})=>{try{v(!0);const S=localStorage.getItem("access_token");if(!S){r("Please log in to view stats");return}const u=await pe.getStats({page:s,limit:C,...l},S);if(u.success&&u.data){const ce={...u.data,pagination:{...u.data.pagination,total_pages:u.data.pagination.pages??u.data.pagination.total_pages},logs:u.data.logs.sort((oe,ie)=>new Date(ie.timestamp).getTime()-new Date(oe.timestamp).getTime())};w(ce),U(s)}else r(u.error||"Failed to fetch stats")}catch(S){console.error("Error fetching stats:",S),r("Failed to fetch stats")}finally{v(!1),y(!1)}},X=()=>{y(!0);const s={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:k||void 0};j(c,s)},Y=()=>{const s={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:k||void 0};j(1,s)},O=s=>{if(t&&s!==c&&s>=1&&s<=t.pagination.total_pages){const l={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:k||void 0};j(s,l)}},ee=()=>{const s={agent_name:d.length>0?d.join(","):void 0,vmcp_name:m.length>0?m.join(","):void 0,method:x.length>0?x.join(","):void 0,search:k||void 0};j(1,s)},se=()=>{R([]),V([]),z([]),B(""),j(1,{})};n.useEffect(()=>{j(1,{})},[]);const te=s=>new Date(s).toLocaleString(),ae=s=>{const l=s.toLowerCase();return l.includes("claude")?e.jsx(N,{className:"h-4 w-4 text-orange-600"}):l.includes("visual studio")||l.includes("vscode")||l.includes("vs code")?e.jsx(N,{className:"h-4 w-4 text-blue-600"}):l.includes("cursor")?e.jsx(N,{className:"h-4 w-4 text-purple-600"}):l.includes("gemini")?e.jsx(N,{className:"h-4 w-4 text-yellow-600"}):e.jsx(N,{className:"h-4 w-4 text-blue-600"})},re=s=>s.includes("tool")?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":s.includes("resource")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":s.includes("prompt")?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",le=s=>{G(l=>({...l,[s]:!l[s]}))},ne=[{key:"index",label:"#"},{key:"client",label:"Client"},{key:"timestamp",label:"Timestamp"},{key:"method",label:"Method"},{key:"vmcp",label:"vMCP"},{key:"mcpServer",label:"MCP Server"},{key:"operationId",label:"Operation ID"},{key:"arguments",label:"Arguments"},{key:"result",label:"Result"},{key:"activeConfig",label:"Active Config"}];return M?e.jsx("div",{className:"min-h-screen text-foreground flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading stats..."})]})}):e.jsxs("div",{className:"min-h-screen mx-auto p-4",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-primary/20 flex items-center justify-center",children:e.jsx(xe,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Statistics"}),e.jsx("p",{className:"text-muted-foreground",children:"MCP analytics and logs"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(p,{onClick:X,disabled:f,variant:"outline",size:"sm",children:[e.jsx(q,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Refresh"]})})]})}),t&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 mb-4",children:[e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsx(be,{className:"h-3 w-3 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Total Logs"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_logs.toLocaleString()})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx(N,{className:"h-3 w-3 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Active Clients"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_agents})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-purple-100 dark:bg-purple-900 flex items-center justify-center",children:e.jsx(H,{className:"h-3 w-3 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"vMCPs"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_vmcps})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-orange-100 dark:bg-orange-900 flex items-center justify-center",children:e.jsx(ve,{className:"h-3 w-3 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Tool Calls"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.total_tool_calls.toLocaleString()})]})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-6 w-6 rounded bg-cyan-100 dark:bg-cyan-900 flex items-center justify-center",children:e.jsx(Me,{className:"h-3 w-3 text-cyan-600 dark:text-cyan-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground truncate",children:"Avg Tools/Call"}),e.jsx("p",{className:"text-sm font-bold text-foreground",children:t.stats.avg_tools_per_call})]})]})})})]}),e.jsxs(h,{className:"mb-4",children:[e.jsxs(P,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>K(!T),children:[e.jsxs(A,{className:"text-foreground flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Filters & Search"]}),T?e.jsx(J,{className:"h-4 w-4"}):e.jsx(E,{className:"h-4 w-4"})]}),e.jsx(L,{className:"text-muted-foreground",children:"Filter logs by client, vMCP, method, or search across all fields"})]}),!T&&e.jsxs(g,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"vMCP Name"}),e.jsx(D,{options:t?.filter_options?.vmcp_names||[],value:m,onValueChange:V,placeholder:"Select vMCPs...",searchPlaceholder:"Search vMCPs...",emptyText:"No vMCPs found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Client Name"}),e.jsx(D,{options:t?.filter_options?.agent_names||[],value:d,onValueChange:R,placeholder:"Select clients...",searchPlaceholder:"Search clients...",emptyText:"No clients found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Method"}),e.jsx(D,{options:t?.filter_options?.methods||[],value:x,onValueChange:z,placeholder:"Select methods...",searchPlaceholder:"Search methods...",emptyText:"No methods found"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Search"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{placeholder:"Search logs...",value:k,onChange:s=>B(s.target.value),className:"bg-background border-border text-foreground"}),e.jsx(p,{onClick:ee,size:"sm",children:e.jsx(he,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{onClick:Y,className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Apply Filters"]}),e.jsx(p,{onClick:se,variant:"outline",className:"flex items-center gap-2",children:"Clear Filters"})]})]})]}),e.jsxs(h,{className:"mb-4",children:[e.jsxs(P,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>W(!F),children:[e.jsxs(A,{className:"text-foreground flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5"}),"Column Visibility"]}),F?e.jsx(J,{className:"h-4 w-4"}):e.jsx(E,{className:"h-4 w-4"})]}),e.jsx(L,{className:"text-muted-foreground",children:"Select which columns to display in the logs table"})]}),!F&&e.jsx(g,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:ne.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{id:s.key,checked:a[s.key],onCheckedChange:()=>le(s.key)}),e.jsx("label",{htmlFor:s.key,className:"text-sm font-medium text-foreground cursor-pointer",children:s.label})]},s.key))})})]}),e.jsxs(h,{children:[e.jsxs(P,{children:[e.jsx(A,{className:"text-foreground",children:"System Logs"}),e.jsx(L,{className:"text-muted-foreground",children:"Detailed view of all system activities with filtering and pagination"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"w-full overflow-hidden",children:e.jsxs(Te,{className:"min-w-full",children:[e.jsx(Fe,{children:e.jsxs(I,{className:"border-border",children:[a.index&&e.jsx(i,{className:"text-muted-foreground bg-background max-w-[10px]",children:"#"}),a.client&&e.jsx(i,{className:"text-muted-foreground  bg-background",children:"Client"}),a.timestamp&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"Timestamp"}),a.method&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"Method"}),a.vmcp&&e.jsx(i,{className:"text-muted-foreground  bg-background",children:"vMCP"}),a.mcpServer&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"MCP Server"}),a.operationId&&e.jsx(i,{className:"text-muted-foreground  bg-background",children:"Operation ID"}),a.arguments&&e.jsx(i,{className:"text-muted-foreground bg-background flex-2",children:"Arguments"}),a.result&&e.jsx(i,{className:"text-muted-foreground  bg-background flex-1",children:"Result"}),a.activeConfig&&e.jsx(i,{className:"text-muted-foreground bg-background",children:"Active Config"})]})}),e.jsx(Pe,{children:t&&t.logs&&t.logs.length>0?t.logs.map((s,l)=>e.jsxs(I,{className:"border-border hover:bg-muted/50",children:[a.index&&e.jsx(o,{className:"text-foreground font-medium text-center max-w-[10px] text-truncate",children:(c-1)*C+l+1}),a.client&&e.jsx(o,{className:"text-foreground ",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[ae(s.agent_name),e.jsx("span",{className:"text-sm font-medium truncate",children:s.agent_name})]})}),a.timestamp&&e.jsx(o,{className:"text-foreground",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("span",{className:"text-xs truncate",children:te(s.timestamp)})})}),a.method&&e.jsx(o,{className:"text-foreground",children:e.jsx($,{className:`text-xs ${re(s.method)}`,children:s.method})}),a.vmcp&&e.jsx(o,{className:"text-foreground",children:e.jsx("div",{className:"truncate",children:s.vmcp_name?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-3 w-3 text-primary"}),e.jsx("span",{className:"text-sm font-mono truncate",children:s.vmcp_name})]}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),a.mcpServer&&e.jsx(o,{className:"text-foreground",children:e.jsx("div",{className:"truncate",children:s.mcp_server?e.jsx($,{variant:"secondary",className:"bg-muted text-foreground truncate max-w-full",children:s.mcp_server}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})})}),a.operationId&&e.jsx(o,{className:"text-foreground",children:e.jsx("span",{className:"text-sm font-mono truncate block",children:s.operation_id||"N/A"})}),a.arguments&&e.jsx(o,{className:"text-foreground",children:e.jsx("div",{className:"truncate",children:s.arguments?e.jsx(Z,{data:s.arguments,label:"",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No arguments"})})}),a.result&&e.jsx(o,{className:"text-foreground",children:e.jsx("div",{className:"truncate",children:s.result?e.jsx(Z,{data:s.result,label:"Result",maxChars:100}):e.jsx("span",{className:"text-muted-foreground",children:"No result"})})}),a.activeConfig&&e.jsx(o,{className:"text-foreground",children:e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{children:[s.total_tools||0," tools"]}),e.jsxs("div",{children:[s.total_prompts||0," prompts"]}),e.jsxs("div",{children:[s.total_resources||0," resources"]})]})})]},l)):e.jsx(I,{children:e.jsxs(o,{colSpan:Object.values(a).filter(Boolean).length,className:"text-center py-8",children:[e.jsx(ye,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No logs found"}),e.jsx("p",{className:"text-muted-foreground",children:"Logs will appear here when agents make requests."})]})})})]})}),t&&t.pagination.total>0&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(c-1)*C+1," to ",Math.min(c*C,t.pagination.total)," of ",t.pagination.total," logs"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>O(c-1),disabled:c===1,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-muted-foreground px-3",children:["Page ",c," of ",t.pagination.total_pages]}),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>O(c+1),disabled:c>=t.pagination.total_pages,className:"border-border bg-card text-foreground hover:bg-muted disabled:opacity-50",children:["Next",e.jsx(fe,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]})}export{Ze as default};
//# sourceMappingURL=StatsPage-CiT_UXCc.js.map
