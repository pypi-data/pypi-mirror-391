when:
  event: [push, manual]
  path:
    include: ["*.rs", "*.toml", "*.yaml", "*.py"]
steps:
  test_rust:
    image: rust
    commands:
      - apt update
      - apt install -y protobuf-compiler
      - cargo test --release


  test_python:
    image: ghcr.io/astral-sh/uv:trixie
    commands:
      - apt update
      - apt install -y protobuf-compiler rustup
      - rustup default stable
      - rustup target add wasm32-unknown-unknown
      - uv run pytest
