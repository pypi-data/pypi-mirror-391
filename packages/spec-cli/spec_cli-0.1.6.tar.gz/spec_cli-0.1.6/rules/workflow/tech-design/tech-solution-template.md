技术文档模板

模板撰写约束：

（1）图形说明：

- 统一使用 mermaid 语法
- 数据表设计，需要使用mermaid ER图；流程，需要使用 mermaid 流程图；对于架构，需要使用架构图。
- 列表、枚举，需要使用表格

（2）伪代码说明

- 禁止生成实际代码，文档中涉及的每个类/接口/方法/属性，只需要包含必要的注释即可（职责、业务逻辑、边界条件、输入/输出说明）。
- 方法注释上的入参、出参需要发到注释的最后。类的属性注释必须放到属性上。

```
/**
 * 热推活动管理领域服务
 * 职责: 管理热推活动的展示逻辑
 */
public class FeaturedActivityManager {
    /**
     * 获取有效的热推活动列表
     * 业务逻辑:
     * 1. 过滤已结束的活动
     * 2. 按热推排序升序排列
     * 3. 如果热推活动区无活动, 返回空列表
     * @param allFeaturedActivities 所有热推活动
     * @return 有效的热推活动列表
     */
    public List<FeaturedActivity> getValidFeaturedActivities(List<FeaturedActivity> allFeaturedActivities){
    }
  
    /**
     * 判断是否展示热推活动区
     * 业务逻辑: 活动总数 >= 5 且 有效热推活动数 > 0
     * @param totalActivityCount 活动总数
     * @param validFeaturedCount 有效热推活动数
     * @return true/false
     */
    public boolean shouldDisplayFeaturedZone(Integer totalActivityCount, Integer validFeaturedCount){
    }
}

```

# Epic1：

模板说明：

- 适用于使用 DDD 开发的项目，模板仅聚焦业务功能实现
- 输出必须使用代码设计句式：新增{对象}：{对象名}，以{实现某逻辑}
  - 对象范围：类、接口、属性、方法、枚举、常量、配置项、脚本
  - 如需修改原有{对象}，以版本升级方式实现（示例：{类名}V2/{方法名}V2），并给出兼容说明：{兼容说明}
- 表达方式：文字描述、类图、时序图、组件图、上下文图、ER 图、表格、伪代码
- 图形说明：
  - 数据表设计，需要使用ER图 {mermaid erDiagram}
  - 列表、枚举，需要使用表格
  - 对于流程，需要使用mermaid 流程图。对于架构，需要使用架构图。
- 占位符约定：花括号{}内为动态内容，请替换为具体值（示例：{聚合名称}、{接口名称}、{表名称}）
- 不包含：安全与权限模型、非功能性指标与容量评估、测试方案、迁移与发布回滚方案、风险与应对、里程碑与估算

## 架构设计

段落说明：

- 限界上下文划分
  - 上下文列表：{上下文名称列表}
  - 上下文关系：{关系描述-上游/下游/共享内核/防腐层}
  - 每个上下文职责与契约摘要：{上下文名称} → {职责简述}，对外接口/事件：{契约列表}
- 领域模型视图
  - 聚合清单：{聚合名称列表}，聚合根：{聚合根类名}，不变式：{不变式列表}
  - 实体与值对象：{实体名称列表}、{值对象名称列表}，关系：{关系说明-1:N/N:N}
  - 状态机：状态集合：{状态列表}，迁移规则：{迁移条件与触发事件}
- 分层与组件
  - 应用层组件：{应用服务列表}，职责：{职责摘要}
  - 领域层组件：{领域服务列表}，职责：{职责摘要}
  - 基础设施层组件：{仓储接口列表}/{适配器列表}，职责：{职责摘要}
  - 外部系统集成点：{系统名称}，方式：{REST/gRPC/消息}，契约：{接口/主题名称}
- 交互与流程
  - 关键用例时序：{用例名称} → {调用链文字描述-步骤1…步骤N}  → {mermaid 时序图}
  - 异常分支：{分支名称与处理语义}
- 数据设计
  - ER图
  - 新增表：{表名称列表}，用途：{用途摘要}
  - 表结构：主键：{主键字段}，唯一约束：{唯一字段列表}，外键：{外键关系}，必填/默认：{字段约束描述}
  - 字典/枚举：{枚举名称} → {值域与语义}
- 输入输出契约
  - 对外接口列表：{接口名称}，协议：{HTTP/gRPC/消息}，方法/路径或 RPC 名：{方法或路径/RPC名}
  - 请求参数：{请求字段列表与语义}，响应结构：{响应字段列表与语义}
  - 业务码语义：{业务码列表与含义}，版本策略：{字段兼容/弃用约定}

## 用户故事1.1：

段落说明：

- 触发条件：{触发条件}
- 前置条件：{前置条件}
- 后置条件：{后置条件}
- 主流程：{mermaid 流程图}
  - 步骤1：{用户或系统动作1}
  - 步骤2：{用户或系统动作2}
  - …
- 异常分支：{异常分支列表-超时/无数据/冲突/重复提交等}
- 业务规则与不变式：{规则列表-字段校验/跨实体约束/时间窗}
- 输入输出契约：请求：{请求字段列表}，响应：{响应字段列表}，事件：{事件名称与载荷结构}
- 状态机：状态集合：{状态列表}，迁移条件：{迁移条件}，并发更新：{冲突检测/合并策略}
- 幂等与重复提交：幂等键：{幂等键字段}，去重窗口：{时间窗口}，重复请求行为：{行为定义}
- 数据读写点：读取：{实体/表清单}，写入：{实体/表清单}，写入原则：{原子性边界}
- 依赖契约：接口/主题：{依赖接口或事件列表}，版本兼容：{兼容说明}
- 验收标准（功能语义）：Given：{前置}，When：{触发}，Then：{期望结果}

### 任务1.1.1：XXX领域对象设计

- 新增{对象}：{聚合/实体/值对象名称}，以封装{核心业务逻辑}
- 字段与约束：{字段名}：{类型/必填/唯一/格式/取值范围}
- 标识策略：{ID策略-雪花/自增/业务键}
- 关联关系：{同聚合引用}/{跨聚合引用策略}
- 状态机：{状态枚举与迁移方法}
- 工厂与规格：新增{对象}：{工厂类名}，以{创建并校验初始不变式}；新增{对象}：{Specification名称}，以{校验规则}

### 任务1.1.2：YYY领域对象设计

- 新增{对象}：{领域对象名称}，以实现{特定业务规则}
- 值对象/枚举：{名称} → {值域/比较与等价性}
- 计算/聚合逻辑：{派生字段或算法描述}
- 不变式与校验：{跨字段/跨实体规则实现}

### 任务1.1.3：AAA领域仓储接口设计

- 新增{对象}：{仓储接口名称}，以{抽象持久化与查询能力}
- 方法签名与语义：
  - 保存：{save方法签名与语义}
  - 加载：{getById/列表查询-参数与语义}
  - 查询：{过滤条件/排序/分页参数约定}
- 事务语义（功能一致性）：{读写边界与可见性期望}
- 版本兼容：{新增字段或模型变更的兼容策略}

### 任务1.1.4：BBB领域服务设计

- 新增{对象}：{领域服务类/接口名称}，以{实现跨实体/聚合的业务规则}
- 方法列表：{方法名}({入参定义}) → {出参定义}，语义：{说明}
- 业务算法：{校验/匹配/合并/派生计算}
- 领域事件：新增{对象}：{事件类名}，以{表达领域事实}；触发条件：{条件}，载荷：{字段列表}

### 任务1.1.5：AAA仓储接口实现

- 新增{对象}：{仓储实现类/Mapper名称}，以{映射领域模型到持久化模型}
- 映射规则：{实体↔表映射/枚举存储策略}
- 方法实现：{保存/更新/查询实现与异常分支}
- 幂等与重复写入：{业务键去重/合并策略}

### 任务1.1.6：CCC数据库表设计

- 新增{对象}：{表名称/视图名称/字典名称}，以{支撑数据持久化与查询}
- 字段定义：{字段名}：{类型/非空/默认值/唯一/外键}
- 归属关系：{表↔聚合/上下文对应关系}
- 初始化数据：{枚举/字典初始值与语义}

### 任务1.1.7：DDD Dao实现

- 新增{对象}：{Dao/Repository实现名称}，以{提供数据访问方法}
- 方法列表：{CRUD/条件查询/批量操作参数与返回约定}
- 一致性语义：{本地事务边界与功能可见性要求}
- 错误语义：{数据不存在/冲突的功能反馈}

### 任务1.1.8：EEE接口访问实现

- 新增{对象}：{REST/gRPC/消息适配器名称}，以{暴露用例的应用服务}
- 协议与寻址：{HTTP/gRPC/消息主题}，方法/路径或 RPC 名：{方法或路径/RPC名}
- 入参校验：{请求字段与校验规则}，响应结构：{响应字段与语义}
- 业务码语义：{码与含义}，版本策略：{字段兼容/弃用约定}
- 幂等与重复请求：{幂等键字段/重复提交行为定义}

# Epic2：

模板说明：

- 适用于使用非 DDD（三层架构）开发的项目，模板仅聚焦业务功能实现
- 输出必须使用代码设计句式：新增{对象}：{对象名}，以{实现某逻辑}
  - 对象范围：类、接口、属性、方法、枚举、常量、配置项、脚本
  - 修改以版本升级方式实现（示例：{类名}V2/{方法名}V2），并给出兼容说明：{兼容说明}
- 表达方式：文字描述、类图、时序图、组件图、ER 图、表格、伪代码
- 占位符约定：花括号{}内为动态内容，请替换为具体值（示例：{Controller名称}、{Service名称}、{表名称}）
- 不包含：安全与权限模型、非功能性指标与容量评估、测试方案、迁移与发布回滚方案、风险与应对、里程碑与估算

## 架构设计

段落说明：

- 分层与模块职责
  - 表示层（Controller/Handler）：{模块名称列表与职责摘要}
  - 业务层（Service）：{模块名称列表与职责摘要}
  - 数据层（Repository/Dao/Mapper）：{模块名称列表与职责摘要}
  - 数据模型（Entity/DTO/VO）：{模型列表与用途}
- 模块依赖与调用关系：{自上而下的依赖方向描述}
- 交互与流程
  - 关键用例时序：{用例名称} → {从请求到数据访问的调用链文字描述}
  - 异常分支：{分支名称与处理语义}
- 数据设计
  - 新增表：{表名称列表}，用途：{用途摘要}
  - 表约束：主键：{主键字段}，唯一约束：{唯一字段列表}，外键：{外键关系}，必填/默认：{字段约束描述}
  - 模型到持久化映射：{Entity↔表映射规则}，DTO/VO：{接口字段映射}
- 接口契约
  - 对外接口列表：{接口名称}，协议：{HTTP/gRPC/消息}，方法/路径或 RPC 名：{方法或路径/RPC名}
  - 请求参数：{请求字段列表与语义}，响应结构：{响应字段列表与语义}
  - 业务码语义：{业务码列表与含义}，版本策略：{字段兼容/弃用约定}

## 用户故事2.1：

段落说明：

- 触发条件：{触发条件}
- 前置条件：{前置条件}
- 后置条件：{后置条件}
- 主流程： { mermaid 流程图}
  - 步骤1：{用户或系统动作1}
  - 步骤2：{用户或系统动作2}
  - …
- 异常分支：{异常分支列表-超时/无数据/冲突/重复提交等}
- 输入输出：请求：{请求字段列表与分页/过滤规则}，响应：{响应字段列表}
- 业务规则：{字段校验/跨对象约束/计算/匹配/合并逻辑}
- 幂等与重复提交：幂等键：{幂等键字段}，重复请求行为：{行为定义}
- 数据读写点：读取：{模型/表清单}，写入：{模型/表清单}，写入原则：{原子性边界}
- 依赖契约：接口/主题：{依赖接口或事件列表}，版本兼容：{兼容说明}
- 验收标准（功能语义）：Given：{前置}，When：{触发}，Then：{期望结果}

### 任务2.1.1 AAA数据模型设计

- 新增{对象}：{Entity/DTO/VO名称}，以{承载业务数据与语义}
- 字段与约束：{字段名}：{类型/必填/唯一/格式/取值范围}
- 映射关系：Entity↔{表名称}，DTO/VO↔{接口名称} 的映射规则：{规则说明}
- 生命周期或状态机（如需）：{状态列表与迁移条件}

### 任务2.1.2 BBB数据模型设计

- 新增{对象}：{补充模型/枚举/字典名称}，以{支持场景的取值与规则}
- 计算/派生字段：{来源与更新时机}
- 关联关系：{一对多/多对多引用与约束}

### 任务2.1.3 CCC服务设计

- 新增{对象}：{Service类/接口名称}，以{实现业务流程与规则}
- 方法列表：{方法名}({入参定义}) → {出参定义}，语义：{说明}
- 操作原子性与更新合并/冲突处理：{功能一致性语义}
- 幂等与重复提交：{幂等键与去重逻辑}

### 任务2.1.4 DDD Dao设计

- 新增{对象}：{Repository/Mapper/Dao接口名称}，以{提供数据访问能力}
- 方法定义：{CRUD/条件查询/分页/排序/过滤参数与约定}
- 数据一致性语义：{读取与更新的可见性期望}
- 错误语义：{不存在/冲突/部分更新的处理规则}

### 任务2.1.5 EEE接口访问实现

- 新增{对象}：{Controller/Handler/Adapter名称}，以{暴露REST/gRPC/消息接口}
- 协议与寻址：{HTTP/gRPC/消息主题}，方法/路径或 RPC 名：{方法或路径/RPC名}
- 入参校验：{请求字段与校验规则}，响应结构：{响应字段与语义}
- 业务码语义：{码与含义}，版本策略：{字段兼容/弃用约定}
- 幂等与重复请求：{Idempotency-Key字段/重复提交行为定义}

> 说明：
>
> - 模板仅关注业务功能实现相关内容
> - 所有代码设计描述统一使用“新增{对象}：{对象名}，以{实现某逻辑}”；修改使用版本升级方式并注明兼容约定
> - 请用实际值替换全部占位符，以便系统或大模型据此生成技术方案
