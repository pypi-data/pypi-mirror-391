# MCP工具数据格式指南

## 概述
本文档详细说明各个MCP工具的数据输入格式要求，帮助大模型正确调用工具。

## 1. VAR/SVAR模型工具

### 数据格式
```python
# 多元时间序列数据格式
data = [
    [var1_t1, var2_t1, var3_t1],  # 时间点1的所有变量值
    [var1_t2, var2_t2, var3_t2],  # 时间点2的所有变量值
    [var1_t3, var2_t3, var3_t3],  # 时间点3的所有变量值
    # ...
]

# 变量名称（可选）
variables = ["GDP", "Inflation", "Interest"]
```

### 示例调用
```python
{
  "data": [[1.0, 2.5, 1.8], [1.2, 2.7, 2.0], [1.4, 2.9, 2.2]],
  "model_type": "var",
  "lags": 1,
  "variables": ["GDP", "Inflation", "Interest"],
  "output_format": "json"
}
```

## 2. 联立方程模型工具

### 数据格式说明
联立方程模型需要三个主要数据组件：

#### 因变量数据 (y_data)
- **格式**: 二维列表，每个子列表代表一个方程的因变量时间序列
- **要求**: 所有方程的观测数量必须相同

```python
# 两个方程的示例
y_data = [
    [1.0, 1.2, 1.4, 1.6],  # 方程1的因变量
    [2.0, 2.2, 2.4, 2.6]   # 方程2的因变量
]
```

#### 自变量数据 (x_data)
- **格式**: 二维列表，每个子列表代表一个观测的所有自变量值
- **要求**: 观测数量必须与因变量相同

```python
# 4个观测，每个观测有2个自变量
x_data = [
    [1.5, 2.5],  # 观测1的自变量
    [1.7, 2.7],  # 观测2的自变量
    [1.9, 2.9],  # 观测3的自变量
    [2.1, 3.1]   # 观测4的自变量
]
```

#### 工具变量数据 (instruments)
- **格式**: 二维列表，每个子列表代表一个观测的所有工具变量值
- **要求**: 观测数量必须与其他变量相同

```python
# 4个观测，每个观测有2个工具变量
instruments = [
    [1.8, 2.8],  # 观测1的工具变量
    [2.0, 3.0],  # 观测2的工具变量
    [2.2, 3.2],  # 观测3的工具变量
    [2.4, 3.4]   # 观测4的工具变量
]
```

### 示例调用
```python
{
  "y_data": [[1.0, 1.2, 1.4, 1.6], [2.0, 2.2, 2.4, 2.6]],
  "x_data": [[1.5, 2.5], [1.7, 2.7], [1.9, 2.9], [2.1, 3.1]],
  "instruments": [[1.8, 2.8], [2.0, 3.0], [2.2, 3.2], [2.4, 3.4]],
  "equation_names": ["Demand", "Supply"],
  "instrument_names": ["Income", "Price"],
  "constant": true,
  "output_format": "json"
}
```

## 3. 动态面板数据模型工具

### 数据格式说明
动态面板数据需要四个主要数据组件：

#### 因变量数据 (y_data)
- **格式**: 一维列表，所有个体的因变量时间序列

```python
y_data = [1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8]
```

#### 自变量数据 (x_data)
- **格式**: 二维列表，每个子列表代表一个自变量的时间序列
- **重要**: 每个自变量的观测数量必须与因变量相同

```python
# 1个自变量，10个观测
x_data = [[1.5, 1.7, 1.9, 2.1, 2.3, 2.5, 2.7, 2.9, 3.1, 3.3]]

# 2个自变量，10个观测
x_data = [
    [1.5, 1.7, 1.9, 2.1, 2.3, 2.5, 2.7, 2.9, 3.1, 3.3],  # 自变量1
    [2.5, 2.7, 2.9, 3.1, 3.3, 3.5, 3.7, 3.9, 4.1, 4.3]   # 自变量2
]
```

#### 个体标识符 (entity_ids)
- **格式**: 一维列表，标识每个观测属于哪个个体

```python
# 2个个体，每个个体5个时间点
entity_ids = [1, 1, 1, 1, 1, 2, 2, 2, 2, 2]
```

#### 时间标识符 (time_periods)
- **格式**: 一维列表，标识每个观测的时间点

```python
# 10个观测，时间从1到5重复两次
time_periods = [1, 2, 3, 4, 5, 1, 2, 3, 4, 5]
```

### 示例调用
```python
{
  "y_data": [1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8],
  "x_data": [[1.5, 1.7, 1.9, 2.1, 2.3, 2.5, 2.7, 2.9, 3.1, 3.3]],
  "entity_ids": [1, 1, 1, 1, 1, 2, 2, 2, 2, 2],
  "time_periods": [1, 2, 3, 4, 5, 1, 2, 3, 4, 5],
  "model_type": "diff_gmm",
  "lags": 1,
  "output_format": "json"
}
```

## 4. 数据格式验证要点

### 通用规则
1. **数据维度一致性**: 所有相关数据的观测数量必须相同
2. **数据类型**: 必须为数值类型
3. **数据完整性**: 不能有空值或缺失值

### 联立方程模型特殊要求
- 因变量数据是二维列表，每个子列表代表一个方程
- 自变量和工具变量是二维列表，每个子列表代表一个观测
- 所有数据的观测数量必须严格一致

### 动态面板数据特殊要求
- 自变量数据是二维列表，每个子列表代表一个自变量的完整时间序列
- 个体和时间标识符必须与因变量观测数量一致
- 面板数据必须平衡（每个个体有相同数量的时间点）

## 5. 常见错误及解决方案

### 错误: "自变量的观测数量必须与因变量相同"
**原因**: 数据维度不匹配
**解决方案**: 检查所有数据的观测数量是否一致

### 错误: "所有数据序列的长度必须一致"
**原因**: 动态面板数据中某个自变量的观测数量与因变量不同
**解决方案**: 确保每个自变量的时间序列长度与因变量相同

### 错误: "输入数据不能为空"
**原因**: 数据为空或格式错误
**解决方案**: 提供有效的数据或检查文件路径

## 6. 最佳实践

1. **使用文件输入**: 对于复杂数据，建议使用CSV文件格式
2. **数据预处理**: 在调用工具前确保数据格式正确
3. **逐步测试**: 先用小样本数据测试，确认格式正确后再使用完整数据
4. **检查维度**: 始终验证所有相关数据的观测数量是否一致

通过遵循这些指南，可以确保MCP工具的正确调用和稳定运行。