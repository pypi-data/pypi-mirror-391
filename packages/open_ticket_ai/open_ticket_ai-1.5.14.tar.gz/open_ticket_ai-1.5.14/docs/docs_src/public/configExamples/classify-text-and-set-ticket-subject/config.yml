open_ticket_ai:
  api_version: '>=1.0.0'
  plugins: []
  infrastructure:
    logging:
      level: DEBUG
      log_to_file: false
      format:
        message_format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        date_format: '%Y-%m-%d %H:%M:%S'
  services:
    jinja_default:
      use: base:JinjaRenderer
      injects: {}
      params: {}
    otobo_znuny:
      use: otobo-znuny:OTOBOZnunyTicketSystemService
      injects: {}
      params:
        password: '{{ get_env(''OTAI_E2E_OTOBO_PASSWORD'') }}'
        base_url: http://3.66.72.29/otobo/nph-genericinterface.pl
        username: open_ticket_ai
        webservice_name: OpenTicketAI
        operation_urls:
          TicketCreate: ticket-create
          TicketSearch: ticket-search
          TicketGet: ticket-get
          TicketUpdate: ticket-update
    hf_local:
      use: hf-local:HFClassificationService
      injects: {}
      params:
        api_token: null
  orchestrator:
    use: base:SimpleSequentialOrchestrator
    injects: {}
    params:
      orchestrator_sleep: PT5S
      steps:
      - use: base:SimpleSequentialRunner
        injects: {}
        params:
          'on':
            use: base:IntervalTrigger
            injects: {}
            params:
              interval: PT0.1S
            id: interval_trigger
          run:
            use: base:CompositePipe
            injects: {}
            params:
              steps:
              - use: base:ClassificationPipe
                injects:
                  classification_service: hf_local
                params:
                  text: I absolutely love this product. It works perfectly and I would
                    recommend it to everyone.
                  model_name: finiteautomata/bertweet-base-sentiment-analysis
                id: classify
              - use: base:UpdateTicketPipe
                injects:
                  ticket_system: otobo_znuny
                params:
                  ticket_id: '1311'
                  updated_ticket:
                    subject: '{{ get_pipe_result(''classify'', ''label'') }};{{ get_pipe_result(''classify'',
                      ''confidence'') }}'
                id: set-subject-to-label-score
            id: classify-and-update-subject
        id: runner
    id: orchestrator
