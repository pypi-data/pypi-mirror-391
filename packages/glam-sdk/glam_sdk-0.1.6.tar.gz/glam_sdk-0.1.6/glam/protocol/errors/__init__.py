'''
    This code was AUTOGENERATED using the codama library.
    Please DO NOT EDIT THIS FILE, instead use visitors
    to add features, then rerun codama to update it.
    @see https://github.com/codama-idl/codama
'''

import typing
import re
from solders.transaction_status import (
    InstructionErrorCustom,
    TransactionErrorInstructionError,
)
from solders.pubkey import Pubkey as SolPubkey
from solana.rpc.core import RPCException
from solders.rpc.errors import SendTransactionPreflightFailureMessage
from anchorpy.error import extract_code_and_logs

from . import glamProtocol
from ..program_id import GLAM_PROTOCOL_PROGRAM_ADDRESS

error_re = re.compile(r"Program (\w+) failed: custom program error: (\w+)")

def from_tx_error(
    error: RPCException,
) -> typing.Union[glamProtocol.CustomError, None]:
    err_info = error.args[0]
    extracted = extract_code_and_logs(err_info, GLAM_PROTOCOL_PROGRAM_ADDRESS)
    if extracted is None:
        return None
    return glamProtocol.from_code(extracted[0])
