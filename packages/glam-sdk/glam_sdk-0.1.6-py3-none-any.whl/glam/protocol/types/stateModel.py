'''
    This code was AUTOGENERATED using the codama library.
    Please DO NOT EDIT THIS FILE, instead use visitors
    to add features, then rerun codama to update it.
    @see https://github.com/codama-idl/codama
'''

import borsh_construct as borsh
import typing
from anchorpy.borsh_extension import BorshPubkey
from construct import Construct, Container, GreedyBytes
from dataclasses import dataclass
from solders.pubkey import Pubkey as SolPubkey
from . import accountType, createdModel, delegateAcl, integrationAcl
from ..shared import FixedSizeBytes

class StateModelJSON(typing.TypedDict):
    accountType: typing.Optional[accountType.AccountTypeJSON]
    name: typing.Optional[list[int]]
    uri: typing.Optional[str]
    enabled: typing.Optional[bool]
    assets: typing.Optional[list[str]]
    created: typing.Optional[createdModel.CreatedModelJSON]
    owner: typing.Optional[str]
    portfolioManagerName: typing.Optional[list[int]]
    borrowable: typing.Optional[list[str]]
    timelockDuration: typing.Optional[int]
    integrationAcls: typing.Optional[list[integrationAcl.IntegrationAclJSON]]
    delegateAcls: typing.Optional[list[delegateAcl.DelegateAclJSON]]

@dataclass
class StateModel:
    layout: typing.ClassVar = borsh.CStruct(
        "accountType" /borsh.Option(accountType.layout),
        "name" /borsh.Option(borsh.U8[32]),
        "uri" /borsh.Option(borsh.String),
        "enabled" /borsh.Option(borsh.Bool),
        "assets" /borsh.Option(borsh.Vec(typing.cast(Construct, BorshPubkey))),
        "created" /borsh.Option(createdModel.CreatedModel.layout),
        "owner" /borsh.Option(BorshPubkey),
        "portfolioManagerName" /borsh.Option(borsh.U8[32]),
        "borrowable" /borsh.Option(borsh.Vec(typing.cast(Construct, BorshPubkey))),
        "timelockDuration" /borsh.Option(borsh.U32),
        "integrationAcls" /borsh.Option(borsh.Vec(typing.cast(Construct, integrationAcl.IntegrationAcl.layout))),
        "delegateAcls" /borsh.Option(borsh.Vec(typing.cast(Construct, delegateAcl.DelegateAcl.layout))),
        )
    #fields
    accountType: typing.Optional[accountType.AccountTypeKind]
    name: typing.Optional[bytes]
    uri: typing.Optional[str]
    enabled: typing.Optional[bool]
    assets: typing.Optional[list[SolPubkey]]
    created: typing.Optional[createdModel.CreatedModel]
    owner: typing.Optional[SolPubkey]
    portfolioManagerName: typing.Optional[bytes]
    borrowable: typing.Optional[list[SolPubkey]]
    timelockDuration: typing.Optional[int]
    integrationAcls: typing.Optional[list[integrationAcl.IntegrationAcl]]
    delegateAcls: typing.Optional[list[delegateAcl.DelegateAcl]]
    
    @classmethod
    def from_decoded(cls, obj: Container) -> "StateModel":
        return cls(
        accountType=(None if obj["accountType"] is None else accountType.from_decoded(obj["accountType"])),
        name=(None if obj["name"] is None else obj["name"]),
        uri=(None if obj["uri"] is None else obj["uri"]),
        enabled=(None if obj["enabled"] is None else obj["enabled"]),
        assets=(None if obj["assets"] is None else obj["assets"]),
        created=(None if obj["created"] is None else createdModel.CreatedModel.from_decoded(obj["created"])),
        owner=(None if obj["owner"] is None else obj["owner"]),
        portfolioManagerName=(None if obj["portfolioManagerName"] is None else obj["portfolioManagerName"]),
        borrowable=(None if obj["borrowable"] is None else obj["borrowable"]),
        timelockDuration=(None if obj["timelockDuration"] is None else obj["timelockDuration"]),
        integrationAcls=(None if obj["integrationAcls"] is None else list(map(lambda item:integrationAcl.IntegrationAcl.from_decoded(item),obj["integrationAcls"]))),
        delegateAcls=(None if obj["delegateAcls"] is None else list(map(lambda item:delegateAcl.DelegateAcl.from_decoded(item),obj["delegateAcls"]))),
        )

    def to_encodable(self) -> dict[str, typing.Any]:
        return {
                "accountType": (None if self.accountType is None else self.accountType.to_encodable()),
                "name": self.name,
                "uri": self.uri,
                "enabled": self.enabled,
                "assets": self.assets,
                "created": (None if self.created is None else self.created.to_encodable()),
                "owner": self.owner,
                "portfolioManagerName": self.portfolioManagerName,
                "borrowable": self.borrowable,
                "timelockDuration": self.timelockDuration,
                "integrationAcls": self.integrationAcls,
                "delegateAcls": self.delegateAcls,
                }

    def to_json(self) -> StateModelJSON:
        return {
                "accountType": (None if self.accountType is None else self.accountType.to_json()),
                "name": (None if self.name is None else list(self.name)),
                "uri": (None if self.uri is None else self.uri),
                "enabled": (None if self.enabled is None else self.enabled),
                "assets": (None if self.assets is None else list(map(lambda item:str(item),self.assets))),
                "created": (None if self.created is None else self.created.to_json()),
                "owner": (None if self.owner is None else str(self.owner)),
                "portfolioManagerName": (None if self.portfolioManagerName is None else list(self.portfolioManagerName)),
                "borrowable": (None if self.borrowable is None else list(map(lambda item:str(item),self.borrowable))),
                "timelockDuration": (None if self.timelockDuration is None else self.timelockDuration),
                "integrationAcls": (None if self.integrationAcls is None else list(map(lambda item:item.to_json(),self.integrationAcls))),
                "delegateAcls": (None if self.delegateAcls is None else list(map(lambda item:item.to_json(),self.delegateAcls))),
                }

    @classmethod
    def from_json(cls, obj: StateModelJSON) -> "StateModel":
        return cls(
                accountType=(None if obj["accountType"] is None else accountType.from_json(obj["accountType"])),
                name=(None if obj["name"] is None else bytes(obj["name"])),
                uri=(None if obj["uri"] is None else obj["uri"]),
                enabled=(None if obj["enabled"] is None else obj["enabled"]),
                assets=(None if obj["assets"] is None else list(map(lambda item:SolPubkey.from_string(item),obj["assets"]))),
                created=(None if obj["created"] is None else createdModel.CreatedModel.from_json(obj["created"])),
                owner=(None if obj["owner"] is None else SolPubkey.from_string(obj["owner"])),
                portfolioManagerName=(None if obj["portfolioManagerName"] is None else bytes(obj["portfolioManagerName"])),
                borrowable=(None if obj["borrowable"] is None else list(map(lambda item:SolPubkey.from_string(item),obj["borrowable"]))),
                timelockDuration=(None if obj["timelockDuration"] is None else obj["timelockDuration"]),
                integrationAcls=(None if obj["integrationAcls"] is None else list(map(lambda item:integrationAcl.IntegrationAcl.from_json(item),obj["integrationAcls"]))),
                delegateAcls=(None if obj["delegateAcls"] is None else list(map(lambda item:delegateAcl.DelegateAcl.from_json(item),obj["delegateAcls"]))),
        )







