{
  "$defs": {
    "AssessmentRule": {
      "description": "Individual assessment outcome with condition.",
      "properties": {
        "outcome": {
          "description": "Assessment outcome, e.g., 'PASS', 'FAIL', 'A', 'F'",
          "title": "Outcome",
          "type": "string"
        },
        "condition": {
          "description": "Condition to evaluate against the metric value",
          "enum": [
            "equal_to",
            "greater_than",
            "less_than",
            "greater_equal",
            "less_equal",
            "all_true",
            "any_false",
            "count_equals"
          ],
          "title": "Condition",
          "type": "string"
        },
        "threshold": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "number"
            },
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Threshold value for comparison conditions",
          "title": "Threshold"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Human-readable description for this assessment outcome",
          "title": "Description"
        }
      },
      "required": [
        "outcome",
        "condition"
      ],
      "title": "AssessmentRule",
      "type": "object"
    },
    "ScoreCardFilter": {
      "description": "Defines which test results an indicator applies to.",
      "properties": {
        "test_id": {
          "description": "Test id to filter by, e.g., 'run_mock_on_compatible_sut'",
          "title": "Test Id",
          "type": "string"
        }
      },
      "required": [
        "test_id"
      ],
      "title": "ScoreCardFilter",
      "type": "object"
    },
    "ScoreCardIndicator": {
      "description": "Individual score card indicator with filtering and assessment.",
      "properties": {
        "id": {
          "description": "A unique, human-readable ID (up to 32 characters) for this score card indicator. Can include lowercase letters (a–z), digits (0–9) and underscore (_).",
          "pattern": "^[0-9a-z_]{1,32}$",
          "title": "Id",
          "type": "string"
        },
        "name": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Human-readable name for this score card indicator",
          "title": "Name"
        },
        "apply_to": {
          "$ref": "#/$defs/ScoreCardFilter",
          "description": "Filter criteria for which test results this indicator applies to"
        },
        "metric": {
          "description": "Path to metric within test_results object. Supports dot notation for nested objects ('vulnerability_stats.Toxicity.overall_pass_rate'), and bracket notation for keys with dots ('probe_results[\"encoding.InjectHex\"][\"encoding.DecodeMatch\"].passed')",
          "title": "Metric",
          "type": "string"
        },
        "assessment": {
          "description": "List of assessment rules to evaluate against the metric",
          "items": {
            "$ref": "#/$defs/AssessmentRule"
          },
          "title": "Assessment",
          "type": "array"
        }
      },
      "required": [
        "id",
        "apply_to",
        "metric",
        "assessment"
      ],
      "title": "ScoreCardIndicator",
      "type": "object"
    }
  },
  "description": "Complete grading score card configuration.",
  "properties": {
    "score_card_name": {
      "description": "Name of the grading score card",
      "title": "Score Card Name",
      "type": "string"
    },
    "indicators": {
      "description": "List of score card indicators to evaluate",
      "items": {
        "$ref": "#/$defs/ScoreCardIndicator"
      },
      "title": "Indicators",
      "type": "array"
    }
  },
  "required": [
    "score_card_name",
    "indicators"
  ],
  "title": "ASQI ScoreCard",
  "type": "object",
  "$schema": "https://json-schema.org/draft/2020-12/schema"
}