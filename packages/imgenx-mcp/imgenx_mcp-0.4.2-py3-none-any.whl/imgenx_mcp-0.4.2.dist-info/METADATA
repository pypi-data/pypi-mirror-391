Metadata-Version: 2.4
Name: imgenx-mcp
Version: 0.4.2
Summary: AI Image/Video Generation MCP Server with OSS Upload - Powered by Doubao API
Project-URL: Homepage, https://github.com/helios123/imgenx-mcp
Project-URL: Repository, https://github.com/helios123/imgenx-mcp
Project-URL: Issues, https://github.com/helios123/imgenx-mcp/issues
Project-URL: Documentation, https://github.com/helios123/imgenx-mcp/blob/main/README.md
Author-email: helios123 <your-email@example.com>
License: MIT
License-File: LICENSE
Keywords: ai,aliyun,doubao,image-generation,mcp,oss,video-generation
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.10
Requires-Dist: fastmcp>=2.12.4
Requires-Dist: oss2>=2.19.1
Requires-Dist: pillow>=12.0.0
Requires-Dist: python-dotenv>=1.1.1
Requires-Dist: requests>=2.25.0
Requires-Dist: volcengine-python-sdk[ark]>=4.0.22
Description-Content-Type: text/markdown

<div align="center">
  <img src="logo.jpg" alt="ImgenX MCP Server Logo" width="800" height="400">

  [![Version](https://img.shields.io/badge/Version-0.4.1-brightgreen.svg)](https://github.com/helios123/imgenx-mcp/releases)
  [![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/downloads/)
  [![MCP](https://img.shields.io/badge/MCP-Compatible-green.svg)](https://modelcontextprotocol.io/)
  [![License](https://img.shields.io/badge/License-MIT-yellow.svg)](#è®¸å¯è¯)

**ä¸€ç«™å¼ AI å›¾ç‰‡/è§†é¢‘ç”Ÿæˆä¸å¤„ç†å¥—ä»¶ï¼Œæ”¯æŒæ–‡æœ¬/å›¾ç”Ÿå›¾ã€æ–‡æœ¬/å›¾ç”Ÿè§†é¢‘ã€å›¾ç‰‡åˆ†æä¸å¸¸ç”¨ç¼–è¾‘ï¼ˆè£å‰ªã€ç¼©æ”¾ã€è½¬æ¢ã€è°ƒå‚ï¼‰ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ°é˜¿é‡Œäº‘ OSS å¹¶è¿”å›æ°¸ä¹… CDN URLã€‚å¯ä½œä¸ºå‘½ä»¤è¡Œå·¥å…·æˆ– MCP Server ä½¿ç”¨**
</div>

https://github.com/user-attachments/assets/92749d6f-727e-4874-a008-6ded8b4d9e7b

## åŠŸèƒ½ç‰¹æ€§

- **æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡**: æ ¹æ®æ–‡æœ¬æè¿°ç”Ÿæˆå›¾ç‰‡ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ° OSS å¹¶è¿”å›æ°¸ä¹… CDN URL â­
- **å›¾ç‰‡ç”Ÿæˆå›¾ç‰‡**: åŸºäºè¾“å…¥å›¾ç‰‡å’Œæ–‡æœ¬æè¿°ç”Ÿæˆæ–°å›¾ç‰‡ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ° OSS â­
- **æ–‡æœ¬/å›¾ç‰‡ç”Ÿæˆè§†é¢‘**: æ”¯æŒæç¤ºè¯ç”Ÿæˆè§†é¢‘ï¼Œæˆ–åŸºäºé¦–å°¾å¸§ç”Ÿæˆè§†é¢‘ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ° OSS â­
- **å›¾ç‰‡å¤„ç†å·¥å…·**: æä¾›å®Œæ•´çš„å›¾ç‰‡å¤„ç†åŠŸèƒ½
  - **å›¾ç‰‡ä¿¡æ¯è·å–**: æŸ¥çœ‹å›¾ç‰‡æ ¼å¼ã€å°ºå¯¸ã€æ¨¡å¼ç­‰ä¿¡æ¯
  - **å›¾ç‰‡è£å‰ª**: æŒ‰æŒ‡å®šåŒºåŸŸè£å‰ªå›¾ç‰‡ï¼ˆæ”¯æŒå°æ•°æ¯”ä¾‹åæ ‡ï¼‰
  - **å°ºå¯¸è°ƒæ•´**: è°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œæ”¯æŒä¿æŒå®½é«˜æ¯”
  - **æ ¼å¼è½¬æ¢**: æ”¯æŒ PNGã€JPEGã€JPGã€WEBP æ ¼å¼è½¬æ¢
  - **å›¾åƒè°ƒæ•´**: è°ƒæ•´äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦
  - **å›¾ç‰‡ç²˜è´´**: å°†å›¾ç‰‡ç²˜è´´åˆ°èƒŒæ™¯å›¾ç‰‡çš„æŒ‡å®šä½ç½®
- **å›¾ç‰‡ç†è§£ä¸åˆ†æ**: åŸºäºè§†è§‰æ¨¡å‹åˆ†æå›¾ç‰‡å†…å®¹ï¼Œè¾“å‡ºç»“æ„åŒ–æˆ–æ–‡æœ¬ç»“æœ
- **â˜ï¸ è‡ªåŠ¨ OSS ä¸Šä¼ **: ç”Ÿæˆå›¾ç‰‡/è§†é¢‘åè‡ªåŠ¨ä¸Šä¼ åˆ°é˜¿é‡Œäº‘ OSSï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ â­
  - æ°¸ä¹…æœ‰æ•ˆçš„ CDN URLï¼Œæ— éœ€æ‹…å¿ƒä¸´æ—¶é“¾æ¥è¿‡æœŸ
  - è‡ªåŠ¨ä¸‹è½½å¹¶ä¸Šä¼ ï¼Œæ— éœ€æœ¬åœ°å­˜å‚¨
  - æ”¯æŒè‡ªå®šä¹‰ä¸šåŠ¡ç›®å½•ï¼ˆimagesã€videos ç­‰ï¼‰
  - æ™ºèƒ½å‘½åï¼š`{ä¸šåŠ¡ç›®å½•}/{å¹´æœˆ}/{æ—¶é—´æˆ³}_{UUID}.{æ‰©å±•å}`
- **å¤šç§åˆ†è¾¨ç‡æ”¯æŒ**: æ”¯æŒ 1Kã€2Kã€4K åˆ†è¾¨ç‡ä»¥åŠå¤šç§è‡ªå®šä¹‰åƒç´ å°ºå¯¸
- **æ’ä»¶åŒ–æ¶æ„**: åŸºäºå·¥å‚æ¨¡å¼è®¾è®¡ï¼Œæ”¯æŒæ‰©å±•æ–°çš„å›¾ç‰‡ç”ŸæˆæœåŠ¡æä¾›å•†
- **MCP åè®®æ”¯æŒ**: å…¼å®¹ Model Context Protocol æ ‡å‡†

## å½“å‰æ”¯æŒçš„æœåŠ¡æä¾›å•†

- **è±†åŒ… (Doubao)**: åŸºäºç«å±±å¼•æ“çš„å›¾ç‰‡ç”ŸæˆæœåŠ¡

## å®‰è£…

### é…ç½®ç¯å¢ƒå˜é‡

```bash
# å›¾ç‰‡è§†é¢‘ç”Ÿæˆæ¨¡å‹é…ç½®
export IMGENX_IMAGE_MODEL="doubao:doubao-seedream-4-0-250828"   # å›¾ç‰‡ç”Ÿæˆæ¨¡å‹
export IMGENX_VIDEO_MODEL="doubao:doubao-seedance-1-0-pro-fast-251015" # è§†é¢‘ç”Ÿæˆæ¨¡å‹ï¼ˆå¯é€‰ï¼‰
export IMGENX_ANALYZER_MODEL="doubao:doubao-seed-1-6-vision-250815"   # å›¾ç‰‡åˆ†ææ¨¡å‹ï¼ˆå¯é€‰ï¼‰
export IMGENX_API_KEY="your_api_key"

# é˜¿é‡Œäº‘ OSS é…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºæ–‡ä»¶ä¸Šä¼ ï¼‰
export OSS_ACCESS_KEY_ID="your_oss_access_key_id"
export OSS_ACCESS_KEY_SECRET="your_oss_access_key_secret"
export OSS_BUCKET="your_bucket_name"
export OSS_ENDPOINT="oss-cn-shanghai.aliyuncs.com"
export OSS_CDN_URL="https://your-cdn-domain.com/"
```
æˆ–å†™å…¥ .env æ–‡ä»¶ä¸­

### å®‰è£…æ­¥éª¤

#### æ–¹å¼ä¸€ï¼špip å®‰è£…ï¼ˆæ¨èï¼‰

```bash
pip install imgenx-mcp
```

#### æ–¹å¼äºŒï¼šä»æºç å®‰è£…
```bash
git clone https://github.com/helios123/imgenx-mcp.git
cd imgenx-mcp
pip install -e .
```

## ä½¿ç”¨æ–¹æ³•

### ä½œä¸ºå‘½ä»¤è¡Œè¿è¡Œ

```
# ç”Ÿæˆå›¾ç‰‡ï¼ˆæ–‡æœ¬æˆ–å›¾ç”Ÿå›¾ï¼‰
imgenx image "ä¸€åªåœ¨äº‘ä¸Šé£ç¿”çš„çŒ«"
imgenx image "ä¸€åªåœ¨äº‘ä¸Šé£ç¿”çš„çŒ«" --size 2K
imgenx image "ä¸€åªåœ¨äº‘ä¸Šé£ç¿”çš„çŒ«" --size 2048x2048 --output test.jpg
imgenx image "ä¸€åªåœ¨äº‘ä¸Šé£ç¿”çš„çŒ«" --images test.jpg --size 2048x2048 --output out_dir/

# ç”Ÿæˆè§†é¢‘ï¼ˆæ–‡æœ¬æˆ–åŸºäºé¦–å°¾å¸§ï¼‰
imgenx video "ä¸€ä¸ªäººåœ¨è¿åŠ¨" --resolution 720p --ratio 16:9 --duration 5 --output video.mp4
imgenx video "ä¸€ä¸ªäººåœ¨è¿åŠ¨" --first_frame logo.jpg --resolution 720p --ratio 16:9 --duration 5 --output video.mp4
```

### ä½œä¸º MCP æœåŠ¡å™¨è¿è¡Œ

#### æ ‡å‡†è¾“å…¥è¾“å‡ºæ¨¡å¼ (stdio) - æ¨è

**é…ç½®æ–‡ä»¶ä½ç½®ï¼š**
- **Windows**: `%APPDATA%\Claude\claude_desktop_config.json`
- **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
- **Linux**: `~/.config/Claude/claude_desktop_config.json`

**é…ç½®ç¤ºä¾‹ï¼ˆä½¿ç”¨ uvxï¼Œæ— éœ€å®‰è£…ï¼‰ï¼š**
```json
{
  "mcpServers": {
    "imgenx": {
      "command": "uvx",
      "args": ["imgenx-mcp"],
      "env": {
        "IMGENX_IMAGE_MODEL": "doubao:doubao-seedream-4-0-250828",
        "IMGENX_VIDEO_MODEL": "doubao:doubao-seedance-1-0-pro-fast-251015",
        "IMGENX_ANALYZER_MODEL": "doubao:doubao-seed-1-6-vision-250815",
        "IMGENX_API_KEY": "your_api_key_here",
        "OSS_ACCESS_KEY_ID": "your_oss_key",
        "OSS_ACCESS_KEY_SECRET": "your_oss_secret",
        "OSS_BUCKET": "your_bucket",
        "OSS_ENDPOINT": "oss-cn-shanghai.aliyuncs.com",
        "OSS_CDN_URL": "https://your-cdn.com/"
      },
      "timeout": 600
    }
  }
}
```

**é…ç½®ç¤ºä¾‹ï¼ˆä½¿ç”¨å·²å®‰è£…çš„åŒ…ï¼‰ï¼š**
```json
{
  "mcpServers": {
    "imgenx": {
      "command": "python",
      "args": ["-m", "imgenx.main"],
      "env": {
        "IMGENX_IMAGE_MODEL": "doubao:doubao-seedream-4-0-250828",
        "IMGENX_API_KEY": "your_api_key_here"
      },
      "timeout": 600
    }
  }
}
```

**é…ç½®åé‡å¯ Claude Desktop å³å¯ä½¿ç”¨ã€‚**

#### HTTP æœåŠ¡å™¨æ¨¡å¼
```bash
imgenx server --transport streamable-http --host 0.0.0.0 --port 8000
imgenx server --transport streamable-http --no_tools text_to_video image_to_video  # ç¦ç”¨è§†é¢‘ç”Ÿæˆå·¥å…·
```

```json
{
  "mcpServers": {
    "imgenx-mcp": {
      "url": "http://127.0.0.1:8000/mcp",
      "headers": {
        "IMGENX_IMAGE_MODEL": "doubao:doubao-seedream-4-0-250828",
        "IMGENX_VIDEO_MODEL": "doubao:doubao-seedance-1-0-pro-fast-251015",
        "IMGENX_ANALYZER_MODEL": "doubao:doubao-seed-1-6-vision-250815",
        "IMGENX_API_KEY": "api-key"
      },
      "timeout": 600
    }
  }
}
```

### å¯ç”¨å·¥å…·ï¼ˆ11 ä¸ªï¼‰

#### 1. text_to_image
æ ¹æ®æ–‡æœ¬æè¿°ç”Ÿæˆå›¾ç‰‡ï¼Œ**è‡ªåŠ¨ä¸Šä¼ åˆ° OSS** å¹¶è¿”å›æ°¸ä¹… CDN URLã€‚

#### 2. image_to_image
åŸºäºè¾“å…¥å›¾ç‰‡å’Œæ–‡æœ¬æè¿°ç”Ÿæˆæ–°å›¾ç‰‡ï¼Œ**è‡ªåŠ¨ä¸Šä¼ åˆ° OSS** å¹¶è¿”å›æ°¸ä¹… CDN URLã€‚

#### 3. text_to_video
æ ¹æ®æ–‡æœ¬æç¤ºç”Ÿæˆè§†é¢‘ï¼Œ**è‡ªåŠ¨ä¸Šä¼ åˆ° OSS** å¹¶è¿”å›æ°¸ä¹… CDN URLã€‚

#### 4. image_to_video
åŸºäºé¦–å¸§ä¸å¯é€‰å°¾å¸§ç”Ÿæˆè§†é¢‘ï¼Œ**è‡ªåŠ¨ä¸Šä¼ åˆ° OSS** å¹¶è¿”å›æ°¸ä¹… CDN URLã€‚

#### 5. analyze_image
åˆ†æå›¾ç‰‡å†…å®¹ï¼Œè¿”å›ç»“æ„åŒ–æˆ–æ–‡æœ¬ç»“æœã€‚

#### 6. get_image_info
è·å–å›¾ç‰‡ä¿¡æ¯ï¼ˆæ ¼å¼ã€å°ºå¯¸ã€æ¨¡å¼ç­‰ï¼‰ã€‚

#### 7. crop_image
è£å‰ªå›¾ç‰‡ï¼ˆæ”¯æŒå°æ•°æ¯”ä¾‹åæ ‡ï¼‰ã€‚

#### 8. resize_image
è°ƒæ•´å›¾ç‰‡å°ºå¯¸ï¼ˆæ”¯æŒä¿æŒå®½é«˜æ¯”ï¼‰ã€‚

#### 9. convert_image
è½¬æ¢å›¾ç‰‡æ ¼å¼ï¼ˆPNGã€JPEGã€JPGã€WEBPï¼‰ã€‚

#### 10. adjust_image
è°ƒæ•´å›¾ç‰‡çš„äº®åº¦ã€å¯¹æ¯”åº¦å’Œé¥±å’Œåº¦ã€‚

#### 11. paste_image
å°†å›¾ç‰‡ç²˜è´´åˆ°èƒŒæ™¯å›¾ç‰‡çš„æŒ‡å®šä½ç½®ã€‚

## é¡¹ç›®ç»“æ„

```
imgenx-mcp-server/
â”œâ”€â”€ imgenx/
â”‚   â”œâ”€â”€ server.py                  # MCP æœåŠ¡å™¨ä¸»æ–‡ä»¶ï¼ˆå·¥å…·å®šä¹‰ä¸è¿è¡Œï¼‰
â”‚   â”œâ”€â”€ factory.py                 # é¢„æµ‹å™¨å·¥å‚ï¼ˆå›¾ç‰‡/è§†é¢‘/åˆ†æï¼‰
â”‚   â”œâ”€â”€ operator.py                # å›¾ç‰‡å¤„ç†æ“ä½œæ¨¡å—
â”‚   â”œâ”€â”€ main.py                    # CLI å…¥å£ï¼ˆimgenxï¼‰
â”‚   â”œâ”€â”€ script.py                  # å‘½ä»¤è¡Œç”Ÿæˆå›¾ç‰‡/è§†é¢‘è„šæœ¬
â”‚   â””â”€â”€ predictor/
â”‚       â”œâ”€â”€ base/
â”‚       â”‚   â”œâ”€â”€ base_image_generator.py   # åŸºç¡€å›¾ç‰‡ç”Ÿæˆå™¨æ¥å£
â”‚       â”‚   â”œâ”€â”€ base_video_generator.py   # åŸºç¡€è§†é¢‘ç”Ÿæˆå™¨æ¥å£
â”‚       â”‚   â””â”€â”€ base_image_analyzer.py    # åŸºç¡€å›¾ç‰‡åˆ†æå™¨æ¥å£
â”‚       â””â”€â”€ generators/
â”‚           â”œâ”€â”€ doubao_image_generator.py   # è±†åŒ…å›¾ç‰‡ç”Ÿæˆå™¨å®ç°
â”‚           â”œâ”€â”€ doubao_video_generator.py   # è±†åŒ…è§†é¢‘ç”Ÿæˆå™¨å®ç°
â”‚           â””â”€â”€ doubao_image_analyzer.py    # è±†åŒ…å›¾ç‰‡åˆ†æå™¨å®ç°
â”œâ”€â”€ pyproject.toml                 # é¡¹ç›®é…ç½®ï¼ˆå…¥å£è„šæœ¬ç­‰ï¼‰
â”œâ”€â”€ uv.lock                        # ä¾èµ–é”ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
```

## æ‰©å±•æ–°çš„æœåŠ¡æä¾›å•†

è¦æ‰©å±•æ–°çš„æœåŠ¡æä¾›å•†ï¼š

1. åœ¨ `imgenx/predictor/generators/` ç›®å½•ä¸‹åˆ›å»ºå®ç°æ–‡ä»¶ï¼Œå‘½åè§„èŒƒï¼š
   - å›¾ç‰‡ç”Ÿæˆå™¨ï¼š`{provider}_image_generator.py`
   - è§†é¢‘ç”Ÿæˆå™¨ï¼ˆå¯é€‰ï¼‰ï¼š`{provider}_video_generator.py`
   - å›¾ç‰‡åˆ†æå™¨ï¼ˆå¯é€‰ï¼‰ï¼š`{provider}_image_analyzer.py`

2. å®ç° `BaseImageGenerator` æ¥å£ï¼š
```python
from typing import List, Dict
from imgenx.predictor.base.base_image_generator import BaseImageGenerator

class ProviderImageGenerator(BaseImageGenerator):
    def __init__(self, model: str, api_key: str):
        self.model = model
        self.api_key = api_key
        # å…¶ä»–åˆå§‹åŒ–ä»£ç 
    
    def text_to_image(self, prompt: str, size: str) -> List[Dict[str, str]]:
        # å®ç°æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡é€»è¾‘
        # è¿”å›æ ¼å¼: [{"url": "å›¾ç‰‡URL"}]
        pass
    
    def image_to_image(self, prompt: str, images: List[str], size: str) -> List[Dict[str, str]]:
        # å®ç°å›¾ç‰‡ç”Ÿæˆå›¾ç‰‡é€»è¾‘ï¼ˆå¯é€‰ï¼‰
        # è¿”å›æ ¼å¼: [{"url": "å›¾ç‰‡URL"}]
        pass
```

3. å·¥å‚ç±»ä¼šè‡ªåŠ¨å‘ç°å¹¶åŠ è½½æ–°çš„å®ç°ï¼ˆåŸºäºæ–‡ä»¶åï¼‰ï¼Œæ¨¡å‹å­—ç¬¦ä¸²éœ€ä¸º `provider:model` æ ¼å¼ï¼Œä¾‹å¦‚ï¼š`doubao:doubao-seedream-4-0-250828`

## ä¾èµ–é¡¹

- `fastmcp>=2.12.4`: MCP åè®®å®ç°
- `python-dotenv>=1.1.1`: ç¯å¢ƒå˜é‡åŠ è½½
- `volcengine-python-sdk[ark]>=4.0.22`: ç«å±±å¼•æ“ SDKï¼ˆè±†åŒ…æœåŠ¡ï¼‰
- `requests>=2.25.0`: HTTP è¯·æ±‚åº“ï¼ˆç”¨äºå›¾ç‰‡ä¸‹è½½ï¼‰
- `pillow>=12.0.0`: å›¾ç‰‡å¤„ç†åº“ï¼ˆç”¨äºå›¾ç‰‡ç¼–è¾‘æ“ä½œï¼‰
- `oss2>=2.19.1`: é˜¿é‡Œäº‘ OSS SDKï¼ˆç”¨äºæ–‡ä»¶ä¸Šä¼ ï¼‰

## ä½¿ç”¨ç¤ºä¾‹

### åœ¨ Claude Desktop ä¸­ä½¿ç”¨

é…ç½®å®Œæˆåï¼Œåœ¨ Claude ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªç„¶è¯­è¨€ï¼š

```
ç”Ÿæˆä¸€åªå°çŒ«åœ¨å¤©ä¸Šé£çš„å›¾ç‰‡
```

Claude ä¼šè‡ªåŠ¨è°ƒç”¨ `text_to_image` å·¥å…·ï¼Œç”Ÿæˆå›¾ç‰‡å¹¶è‡ªåŠ¨ä¸Šä¼ åˆ° OSSï¼Œè¿”å›æ°¸ä¹… CDN URLã€‚

```
ç”Ÿæˆä¸€ä¸ªæ—¥è½æµ·æ»©çš„è§†é¢‘ï¼Œ5ç§’ï¼Œ1080p
```

Claude ä¼šè‡ªåŠ¨è°ƒç”¨ `text_to_video` å·¥å…·ï¼Œç”Ÿæˆè§†é¢‘å¹¶è‡ªåŠ¨ä¸Šä¼ åˆ° OSSï¼Œè¿”å›æ°¸ä¹… CDN URLã€‚

## éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨

### å‡†å¤‡å·¥ä½œ

1. **æœåŠ¡å™¨è¦æ±‚**
   - Ubuntu 20.04+ / CentOS 7+ / Debian 10+
   - Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬
   - è‡³å°‘ 1GB å†…å­˜
   - å¼€æ”¾ç«¯å£ï¼ˆå¦‚éœ€ HTTP æ¨¡å¼ï¼‰

2. **è·å–æœåŠ¡å™¨è®¿é—®æƒé™**
   ```bash
   ssh root@your-server-ip
   ```

### å®‰è£…æ­¥éª¤

#### 1. å®‰è£… Python 3.10+

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install -y python3.10 python3.10-venv python3-pip
```

**CentOS/RHEL:**
```bash
sudo yum install -y python3.10 python3-pip
```

#### 2. åˆ›å»ºå·¥ä½œç›®å½•

```bash
mkdir -p /opt/imgenx-mcp
cd /opt/imgenx-mcp
```

#### 3. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…

```bash
python3.10 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install imgenx-mcp
```

#### 4. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š
```bash
nano /opt/imgenx-mcp/.env
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆæ›¿æ¢ä¸ºæ‚¨çš„çœŸå®å‡­è¯ï¼‰ï¼š
```bash
# å›¾ç‰‡è§†é¢‘ç”Ÿæˆæ¨¡å‹é…ç½®
IMGENX_IMAGE_MODEL=doubao:doubao-seedream-4-0-250828
IMGENX_VIDEO_MODEL=doubao:doubao-seedance-1-0-pro-fast-251015
IMGENX_ANALYZER_MODEL=doubao:doubao-seed-1-6-vision-250815
IMGENX_API_KEY=your_doubao_api_key_here

# é˜¿é‡Œäº‘ OSS é…ç½®
OSS_ACCESS_KEY_ID=your_oss_access_key_id
OSS_ACCESS_KEY_SECRET=your_oss_access_key_secret
OSS_BUCKET=your_bucket_name
OSS_ENDPOINT=oss-cn-shanghai.aliyuncs.com
OSS_CDN_URL=https://your-cdn-domain.com/
```

ä¿å­˜å¹¶é€€å‡ºï¼ˆCtrl+X, Y, Enterï¼‰ã€‚

#### 5. æµ‹è¯•æœåŠ¡

```bash
source venv/bin/activate
cd /opt/imgenx-mcp
source .env
python -m imgenx.main image "æµ‹è¯•å›¾ç‰‡ç”Ÿæˆ" --size 1K --output test.jpg
```

å¦‚æœæˆåŠŸç”Ÿæˆå›¾ç‰‡ï¼Œè¯´æ˜é…ç½®æ­£ç¡®ã€‚

### éƒ¨ç½²ä¸º HTTP æœåŠ¡å™¨ï¼ˆå¯é€‰ï¼‰

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ systemd æœåŠ¡

1. **åˆ›å»º systemd æœåŠ¡æ–‡ä»¶**

```bash
sudo nano /etc/systemd/system/imgenx-mcp.service
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
```ini
[Unit]
Description=ImgenX MCP HTTP Server
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/imgenx-mcp
Environment="PATH=/opt/imgenx-mcp/venv/bin"
EnvironmentFile=/opt/imgenx-mcp/.env
ExecStart=/opt/imgenx-mcp/venv/bin/python -m imgenx.main server --transport streamable-http --host 0.0.0.0 --port 8000
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

2. **å¯åŠ¨æœåŠ¡**

```bash
sudo systemctl daemon-reload
sudo systemctl enable imgenx-mcp
sudo systemctl start imgenx-mcp
```

3. **æŸ¥çœ‹çŠ¶æ€**

```bash
sudo systemctl status imgenx-mcp
```

4. **æŸ¥çœ‹æ—¥å¿—**

```bash
sudo journalctl -u imgenx-mcp -f
```

#### æ–¹å¼äºŒï¼šä½¿ç”¨ screen æˆ– tmux

```bash
# å®‰è£… screen
sudo apt install screen  # Ubuntu/Debian
sudo yum install screen  # CentOS/RHEL

# åˆ›å»ºæ–°ä¼šè¯
screen -S imgenx-mcp

# å¯åŠ¨æœåŠ¡
cd /opt/imgenx-mcp
source venv/bin/activate
source .env
python -m imgenx.main server --transport streamable-http --host 0.0.0.0 --port 8000

# æŒ‰ Ctrl+A, D é€€å‡ºä¼šè¯ï¼ˆæœåŠ¡ç»§ç»­è¿è¡Œï¼‰
# é‡æ–°è¿æ¥: screen -r imgenx-mcp
```

### é…ç½®é˜²ç«å¢™ï¼ˆå¦‚éœ€è¿œç¨‹è®¿é—®ï¼‰

**Ubuntu/Debian (ufw):**
```bash
sudo ufw allow 8000/tcp
sudo ufw reload
```

**CentOS/RHEL (firewalld):**
```bash
sudo firewall-cmd --permanent --add-port=8000/tcp
sudo firewall-cmd --reload
```

### åœ¨ Claude Desktop ä¸­è¿æ¥

æ›´æ–° Claude Desktop é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨æœåŠ¡å™¨ IPï¼š

```json
{
  "mcpServers": {
    "imgenx-mcp": {
      "url": "http://your-server-ip:8000/mcp",
      "headers": {
        "IMGENX_IMAGE_MODEL": "doubao:doubao-seedream-4-0-250828",
        "IMGENX_VIDEO_MODEL": "doubao:doubao-seedance-1-0-pro-fast-251015",
        "IMGENX_ANALYZER_MODEL": "doubao:doubao-seed-1-6-vision-250815",
        "IMGENX_API_KEY": "your_api_key_here"
      },
      "timeout": 600
    }
  }
}
```

**æ³¨æ„**: å¦‚æœä½¿ç”¨ HTTP æ¨¡å¼ï¼Œç¯å¢ƒå˜é‡é€šè¿‡ `headers` ä¼ é€’ï¼ŒæœåŠ¡å™¨ä¸Šçš„ `.env` æ–‡ä»¶ä¸ä¼šç”Ÿæ•ˆã€‚å»ºè®®æœåŠ¡å™¨é…ç½® `.env` å¹¶åœ¨ headers ä¸­çœç•¥è¿™äº›é…ç½®ã€‚

### ä½¿ç”¨ Nginx åå‘ä»£ç†ï¼ˆæ¨èï¼‰

å¦‚æœéœ€è¦ HTTPS æˆ–è‡ªå®šä¹‰åŸŸåï¼š

1. **å®‰è£… Nginx**

```bash
sudo apt install nginx  # Ubuntu/Debian
sudo yum install nginx  # CentOS/RHEL
```

2. **é…ç½® Nginx**

```bash
sudo nano /etc/nginx/sites-available/imgenx-mcp
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location /mcp {
        proxy_pass http://127.0.0.1:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_read_timeout 600s;
    }
}
```

3. **å¯ç”¨é…ç½®å¹¶é‡å¯**

```bash
sudo ln -s /etc/nginx/sites-available/imgenx-mcp /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

4. **é…ç½® SSL (å¯é€‰ï¼Œä½¿ç”¨ Let's Encrypt)**

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

### ç»´æŠ¤å‘½ä»¤

```bash
# åœæ­¢æœåŠ¡
sudo systemctl stop imgenx-mcp

# é‡å¯æœåŠ¡
sudo systemctl restart imgenx-mcp

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u imgenx-mcp -n 100

# æ›´æ–°ç‰ˆæœ¬
cd /opt/imgenx-mcp
source venv/bin/activate
pip install --upgrade imgenx-mcp
sudo systemctl restart imgenx-mcp
```

## æ›´æ–°æ—¥å¿—

### v0.4.1 (å½“å‰ç‰ˆæœ¬)

#### ğŸ› Bug ä¿®å¤
- **ç±»å‹éªŒè¯é”™è¯¯ä¿®å¤**: ä¿®å¤ OSS ä¸Šä¼ è¿”å›å€¼ç±»å‹é”™è¯¯ï¼ˆç§»é™¤æ•´æ•° status å­—æ®µï¼‰
- ç¡®ä¿æ‰€æœ‰è¿”å›å€¼ç¬¦åˆ `Dict[str, str]` ç±»å‹è¦æ±‚
- ä¿®å¤ MCP å·¥å…·è°ƒç”¨æ—¶çš„ç±»å‹éªŒè¯é—®é¢˜

#### ğŸ”’ å®‰å…¨æ›´æ–°
- æ¸…ç† Git å†å²ä¸­çš„æ•æ„Ÿä¿¡æ¯
- æ‰€æœ‰é…ç½®ç¤ºä¾‹ä½¿ç”¨å ä½ç¬¦
- ç”¨æˆ·éœ€ç§ä¸‹é…ç½®çœŸå®å‡­è¯

### v0.4.0

#### â­ é‡å¤§æ›´æ–°ï¼šè‡ªåŠ¨ OSS ä¸Šä¼ 
- **æ— æ„Ÿä¸Šä¼ **: å›¾ç‰‡/è§†é¢‘ç”Ÿæˆåè‡ªåŠ¨ä¸Šä¼ åˆ° OSSï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
- **ä¸€æ­¥åˆ°ä½**: ç›´æ¥è¿”å›æ°¸ä¹… CDN URLï¼Œæ— éœ€ä¸´æ—¶é“¾æ¥
- **ç®€åŒ–å·¥å…·**: åˆ é™¤ `download`ã€`upload_to_oss`ã€`download_and_upload_to_oss` å·¥å…·
- **å·¥å…·æ•°é‡**: ä» 14 ä¸ªç²¾ç®€åˆ° 11 ä¸ª

#### ğŸ“Š API å˜åŒ–
- `text_to_image` / `image_to_image` è¿”å›æ ¼å¼ï¼š
  ```python
  [{'cdn_url': 'https://...', 'oss_url': 'https://...', 'object_key': 'images/...'}]
  ```
- `text_to_video` / `image_to_video` è¿”å›æ ¼å¼ï¼š
  ```python
  {'cdn_url': 'https://...', 'oss_url': 'https://...', 'object_key': 'videos/...'}
  ```

#### ğŸ¯ ç”¨æˆ·ä½“éªŒæå‡
- âœ… æ— éœ€å¤šæ¬¡æ“ä½œï¼Œä¸€æ­¥å®Œæˆ
- âœ… ç«‹å³è·å¾—æ°¸ä¹… URL
- âœ… è‡ªåŠ¨åŒ–æµç¨‹ï¼Œå‡å°‘ç­‰å¾…æ—¶é—´

### v0.3.0

#### æ–°å¢åŠŸèƒ½
- **â˜ï¸ é˜¿é‡Œäº‘ OSS ä¸Šä¼ **: æ–°å¢ `upload_to_oss` å’Œ `download_and_upload_to_oss` å·¥å…·
- **CDN åŠ é€Ÿæ”¯æŒ**: ä¸Šä¼ åè‡ªåŠ¨è¿”å› CDN åŠ é€Ÿåœ°å€
- **å®Œæ•´å·¥ä½œæµ**: ç”Ÿæˆå›¾ç‰‡/è§†é¢‘ -> ä¸Šä¼  OSS -> è·å– CDN URL

#### æ€§èƒ½ä¼˜åŒ–
- ç§»é™¤ä¸å¿…è¦çš„æ–‡ä»¶éªŒè¯æ­¥éª¤ï¼Œæå‡ä¸Šä¼ é€Ÿåº¦çº¦ 35%
- ä¼˜åŒ–æ–‡ä»¶ä¸Šä¼ æµç¨‹ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚

### v0.2.3

#### æ–°å¢åŠŸèƒ½
- **å›¾ç‰‡ç²˜è´´**: æ–°å¢ `paste_image` å·¥å…·ï¼Œæ”¯æŒå°†å›¾ç‰‡ç²˜è´´åˆ°èƒŒæ™¯å›¾ç‰‡çš„æŒ‡å®šä½ç½®
- **å·¥å…·æ§åˆ¶**: æ–°å¢ `--no_tools` å‚æ•°ï¼Œæ”¯æŒåœ¨è¿è¡Œ MCP æœåŠ¡å™¨æ—¶ç¦ç”¨ç‰¹å®šå·¥å…·

#### åŠŸèƒ½ä¼˜åŒ–
- å®Œå–„å›¾ç‰‡å¤„ç†å·¥å…·é›†ï¼Œå¢å¼ºå›¾ç‰‡ç¼–è¾‘èƒ½åŠ›

### v0.2.0

#### æ–°å¢åŠŸèƒ½
- **è§†é¢‘ç”Ÿæˆ**: æ”¯æŒ `text_to_video` ä¸ `image_to_video` ä¸¤ç§æ–¹å¼
- **å›¾ç‰‡åˆ†æ**: æ–°å¢ `analyze_image` å·¥å…·ï¼Œæ”¯æŒè§†è§‰æ¨¡å‹åˆ†æ
- **å›¾ç‰‡å¤„ç†å·¥å…·é›†å®Œå–„**: `get_image_info`ã€`crop_image`ï¼ˆæ¯”ä¾‹åæ ‡ï¼‰ã€`resize_image`ã€`convert_image`ã€`adjust_image`

#### æŠ€æœ¯æ”¹è¿›
- å·¥å‚æ¨¡å¼ç»Ÿä¸€å›¾ç‰‡/è§†é¢‘/åˆ†æä¸‰ç±»é¢„æµ‹å™¨çš„å‘ç°ä¸åŠ è½½
- ç¯å¢ƒå˜é‡åˆ†ç¦»ä¸º `IMGENX_IMAGE_MODEL`ã€`IMGENX_VIDEO_MODEL`ã€`IMGENX_ANALYZER_MODEL`
- MCP å·¥å…·é›†æ‰©å±•ï¼ŒHTTP æœåŠ¡å™¨æä¾› `/health`ã€`/healthy` å¥åº·æ£€æŸ¥è·¯ç”±
- æ”¯æŒæœ¬åœ°æ–‡ä»¶ä¸ URL ä¸¤ç§å›¾ç‰‡è¾“å…¥æ–¹å¼ï¼›ä¸‹è½½å·¥å…·ç»Ÿä¸€å›¾ç‰‡/è§†é¢‘

## è®¸å¯è¯

æœ¬é¡¹ç›®çš„è®¸å¯è¯ä¿¡æ¯è¯·æŸ¥çœ‹é¡¹ç›®ä»“åº“ã€‚

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

## è”ç³»æ–¹å¼

- GitHub: [@helios123](https://github.com/helios123)
- Issues: [æäº¤é—®é¢˜](https://github.com/helios123/imgenx-mcp/issues)
- åŸä½œè€… Email: zhangslwork@yeah.net
