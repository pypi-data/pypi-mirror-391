# # https://docs.readthedocs.io/en/stable/config-file/v2.html
# version: 2
# build:
#   os: ubuntu-20.04
#   tools:
#     python: "3.10"
# sphinx:
#   configuration: docs/conf.py
#   # disable this for more lenient docs builds
#   fail_on_warning: true
# python:
#   install:
#     - method: pip
#       path: .
#       extra_requirements:
#         - doc

# .readthedocs.yaml
#
# 方案：只用 UV，不用 MOCKING
# 目标：解决 'pip' 太慢导致的 15 分钟构建超时问题

version: 2

build:
  os: "ubuntu-20.04"
  tools:
    python: "3.10"
  jobs:
    # pre_install: 在环境中安装 uv 本身
    pre_install:
      - "pip install uv"
      - "uv --version"

    # post_install: 使用 uv 来极速安装所有依赖
    post_install:
      # 'uv pip install --upgrade --no-cache .[doc]' is an alternative to `uv pip sync`
      - "uv pip install --upgrade --no-cache .[doc]"
      - 'python -c "import scmagnify"'
      # 如果你更想尝试 sync（从 pyproject.toml 安装所有依赖与 extras），可以替换为：
      # - "uv pip sync --all-extras --no-cache"

# (可选) 你的 Sphinx 配置路径
sphinx:
  configuration: "docs/conf.py"

python:
  # 1. 禁用 RTD 默认的、缓慢的 'pip install'
  install: []
