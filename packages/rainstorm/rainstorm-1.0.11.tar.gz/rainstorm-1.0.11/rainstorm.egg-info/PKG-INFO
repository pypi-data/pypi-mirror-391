Metadata-Version: 2.4
Name: rainstorm
Version: 1.0.11
Summary: Real & Artificial Intelligence for Neuroscience ‚Äì Simple Tracker for Object Recognition Memory
Home-page: https://github.com/sdhers/RAINSTORM
Author: Santiago D'hers
Author-email: sdhers@fbmc.fcen.uba.ar
License: MIT
Classifier: Programming Language :: Python :: 3.9
Classifier: Operating System :: OS Independent
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Intended Audience :: Science/Research
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: h5py==3.12.1
Requires-Dist: keras==2.10.0
Requires-Dist: keyboard==0.13.5
Requires-Dist: matplotlib==3.9.3
Requires-Dist: numpy==1.25.2
Requires-Dist: opencv-python==4.10.0.84
Requires-Dist: pandas==2.0.3
Requires-Dist: plotly==5.24.1
Requires-Dist: PyYAML==6.0.2
Requires-Dist: ruamel.yaml==0.17.21
Requires-Dist: scikit-learn==1.6.0
Requires-Dist: scipy==1.13.1
Requires-Dist: seaborn==0.13.2
Requires-Dist: tables==3.9.2
Requires-Dist: tensorflow==2.10.1
Requires-Dist: tqdm==4.67.1
Requires-Dist: customtkinter==5.2.2
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license
Dynamic: license-file
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

<div align="center">

# üåßÔ∏è **RAINSTORM** üåßÔ∏è

### Real & Artificial Intelligence for Neuroscience ‚Äì Simple Tracker for Object Recognition Memory

**A complete toolkit for analyzing rodent exploratory behavior in object recognition tasks.**

![RAINSTORM Logo](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739037/logo_pn9c3j.png)

</div>

**RAINSTORM** is a comprehensive Python toolkit for analyzing rodent exploratory behavior üê≠. Transform pose-estimation data (e.g., from DeepLabCut or SLEAP) into meaningful behavioral insights through an intuitive workflow that spans from manual annotation to AI-powered automation.

---

## Table of Contents üìã

* [Features ‚ú®](#features-)
* [Installation üíæ](#installation-)
* [Usage üíª](#usage-)
    - [Video Handling üé•](#video-handling-)
    - [RAINSTORM Behavioral Labeler ‚úçÔ∏è](#the-rainstorm-pipeline-)
    - [The RAINSTORM Pipeline üî¨](#the-rainstorm-pipeline-)
* [Citation üìú](#citation-)
* [Contributing ü§ù](#contributing-)
* [Contact üì´](#contact-)

---

## Features ‚ú®

* **üéØ Frame-by-Frame Behavioral Labeling:** A versatile tool for precise manual annotation, it generates training data for your AI models.
* **üîß Pre & Post-DLC Data Processing:** Align video points, clean tracking glitches, and interpolate data for smooth and reliable analysis.
* **üìê Geometric Analysis:** Automatically identify object exploration using distance and angle metrics.
* **üßä Immobility Detection:** Label freezing behavior based on motion, a key indicator in memory studies.
* **‚öôÔ∏è AI-Powered Automatic Labeling:** Train and deploy neural networks (including LSTMs) to automatically detect complex exploration patterns.
* **üìä Visual Label Comparison:** Easily compare manual, geometric, and AI-generated labels with intuitive visualizations.

---

## Installation üíæ

### Prerequisites

First, ensure you have the following software installed on your system.

* [Miniconda](https://docs.conda.io/projects/miniconda/en/latest/miniconda-install.html) (or Anaconda)
* [Visual Studio Code](https://code.visualstudio.com/Download)
* [Git](https://git-scm.com/downloads)

> [!TIP]
> **First Time Setup**: During Miniconda installation, select **"Add Conda to PATH"** for easier terminal access. Restart your computer after installation to ensure all components are properly configured.

### Setup Steps

1.  **Clone the Repository**

    Open a terminal (or Miniconda Prompt) and run the following command.
    ```bash
    git clone https://github.com/sdhers/rainstorm.git
    ```
    This will create a `rainstorm` folder in your current directory.

2.  **Set Up the Conda Environment**

    Navigate into the cloned directory and create the dedicated environment from the provided file:
    ```bash
    cd rainstorm
    conda env create -f rainstorm_venv.yml
    ```
    Once the environment is ready, you can activate it by running `conda activate rainstorm`.

3.  **Launch VS Code & Select Kernel**

    Launch VS Code from the terminal:
    ```bash
    code .
    ```
    In VS Code, ensure the Python extension is installed:
    * Go to the Extensions view (`Ctrl+Shift+X` or `Cmd+Shift+X` on macOS).
    * Search for "Python" and install the official extension from Microsoft.

    Open a Jupyter notebook (e.g., `2a-Prepare_positions.ipynb`).
    * When prompted to select a kernel, choose the `rainstorm` Conda environment from the list of `Python Environments`.

You are all set! You can now run the notebooks to explore the RAINSTORM workflow.

---

## Usage üíª

RAINSTORM provides a comprehensive workflow through 7 interactive Jupyter notebooks, plus standalone GUI tools for video processing and behavioral labeling.

Transform your data from raw videos to publication-ready results through our intuitive 7-step workflow:

| Step   | Notebook                      | Purpose                    | Output                            |
| ------ | ----------------------------- | -------------------------- | --------------------------------- |
| **0**  | `0-Video_handling.ipynb`      | üé• Prepare videos          | Trimmed, cropped, aligned videos  |
| **1**  | `1-Behavioral_labeler.ipynb`  | ‚úçÔ∏è Manual annotation       | Frame-by-frame behavioral labels  |
| **2a** | `2a-Prepare_positions.ipynb`  | üßπ Clean tracking data     | Filtered, smoothed position files |
| **2b** | `2b-Geometric_analysis.ipynb` | üìê Geometric detection     | Rule-based behavioral labels      |
| **3a** | `3a-Create_models.ipynb`      | ü§ñ Train AI models         | Custom neural networks            |
| **3b** | `3b-Automatic_analysis.ipynb` | üß† AI-powered labeling     | Automated behavioral detection    |
| **4**  | `4-Seize_labels.ipynb`        | üìä Results & visualization | Personalized plots & analyses        |


---

### Video Handling üé•

We offer a quick and easy way to prepare videos for pose estimation and behavioral analysis.

**Open the file `0-Video_handling.ipynb`**

1.  **Run the Video Handling app**
    This app allows you to:
    * Trim the video to the desired length.
    * Crop the video to the desired size.
    * Align videos based on two manually selected points (very useful when batch processing videos with ROIs).
2.  **Run the Draw ROIs app**
    This app allows you to:
    * Draw ROIs and points on the video.
    * Select a distance for scaling.

> [!TIP]
> **Running DLC on Colab**: Use our DeepLabCut pretrained model on Google Colab to process your aligned videos:
> 1. Copy this [Google Drive Folder](https://drive.google.com/drive/folders/1EwL5dtJNvogaXlIKm5NzLYlX--ZpAdxK?usp=sharing) in your own Google Drive.
> 2. Add your own data to the "videos" folder.
> 3. Open the Colab file and follow the instructions to run the model on your data.

---

### RAINSTORM Behavioral Labeler ‚úçÔ∏è

For precise, frame-by-frame annotation, use the **RAINSTORM Behavioral Labeler**.

**Open and run the file `1-Behavioral_labeler.ipynb`**

1.  **Select the video you want to label.**

2.  **(Optional) Load a previous labeling `.csv` file.**
    * This allows you to pick up where you left off.

3.  **Select the behaviors to label and their keys.**
    * Enter the behaviors you want to score (e.g., `exp_1`, `exp_2`, `freezing`, `grooming`, etc...).

> [!WARNING]
> Keys should be unique, single characters, and different from the fixed control keys: (Quit: `q`, Zoom In: `+`, Zoom Out: `-`, Timeline toogle: `t`)

4.  **Start Labeling!**
    After pressing 'Start Labeling', the video will load, and you can begin annotating frame by frame using the keys you defined.

---

### The RAINSTORM Pipeline üî¨

#### `2a-Prepare_positions.ipynb`

üßπ **Process and clean bodypart position data.**

* Filters out frames with low tracking likelihood from DeepLabCut.
* Interpolates and smooths data to correct glitches.
* **Output:** Clean `.csv` files ready for analysis.

![1-Prepare_positions](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739035/1-Prepare_positions_bzjvy5.png)

---

#### `2b-Geometric_analysis.ipynb`

üìê **Perform geometric labeling of exploration and freezing.**

* Applies a simple geometric rule for exploration:
    * Distance to object < `2.5 cm`
    * Angle towards object < `45¬∞`
* Identifies freezing behavior based on lack of movement.

![2-Geometric_analysis](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739035/2-Geometric_analysis_ow6p8d.png)

---

#### `3a-Create_Models.ipynb`

‚öôÔ∏è **Train AI models for automatic behavioral labeling.**

* Uses your manually labeled data to train TensorFlow models.
    ![4-Evaluate_models_b](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739037/4-Evaluate_models_b_gvc4ft.png)
* Includes an LSTM network (a **wide** model) that considers temporal sequences for higher accuracy.
    ![3-Create_Models](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739036/3-Create_models_mxpp0t.png)
* Evaluates model performance against human labelers using Principal Components Analysis (PCA).
    ![4-Evaluate_models_a](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739037/4-Evaluate_models_a_cui7nl.png)

---

#### `3b-Automatic_analysis.ipynb`

üß† **Automate labeling with your trained AI model.**

* Applies your best-performing model to label unseen datasets.
* Generates comparative visualizations (like polar graphs) to contrast manual, geometric, and AI-driven labels.

![6-Compare_Labels](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739037/6-Compare_labels_pyf9ov.png)

---

#### `4-Seize_Labels.ipynb`

üìä **Extract, summarize, and visualize your final data.**

* Calculates key metrics like Discrimination Index.
* Generates publication-ready plots to compare behavior across different experimental groups and sessions.

![7-Seize_Labels_ts](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739037/7-Seize_labels_ts_bsrwyz.png)

---

## Citation üìú

If you use RAINSTORM in your research, please cite our work:

D'hers, S., et al. (2025). RAINSTORM: Automated Analysis of Mouse Exploratory Behavior using Artificial Neural Networks. _Current Protocols_. https://doi.org/10.1002/cpz1.70171

All video recordings were obtained within the [Molecular Neurobiology Lab](https://ifibyne.exactas.uba.ar/grupo-feld/) at IFIBYNE (UBA - CONICET).

---

## Contributing ü§ù

We welcome contributions from the community! Here's how you can help:

### **üêõ Report Issues**

- Found a bug? [Open an issue](https://github.com/sdhers/rainstorm/issues)
- Include your Python version, OS, and a minimal example

### **üí° Suggest Features**

- Have an idea? [Start a discussion](https://github.com/sdhers/rainstorm/discussions)
- Describe your use case and proposed solution

### **üîß Submit Code**

- Fork the repository and create a feature branch
- Follow our coding standards and add tests
- Submit a pull request with a clear description

### **üìö Improve Documentation**

- Fix typos, clarify instructions, add examples
- Documentation improvements are always appreciated!

---

## Contact üì´

For research collaborations and academic inquiries:

- **Email**: sdhers@fbmc.fcen.uba.ar
- **Institution**: Facultad de Ciencias Exactas y Naturales, Universidad de Buenos Aires

### **üåü Stay Updated**

- ‚≠ê **Star** this repository to stay notified of updates
- üëÄ **Watch** for new releases and features
- üê¶ Follow development progress and announcements

---

_Thanks for exploring RAINSTORM!_

![mouse_exploring](https://res.cloudinary.com/ddj6ndshz/image/upload/v1761739038/mouse_exploring_nhdroe.gif)

---
