{
  "loop": "Archive Snapshot",
  "description": "Simplified Archive Snapshot flow creating comprehensive project snapshot after Chapter 3 milestone. Shows TU open, artifact collection, manifest generation, integrity verification, packaging, and archive cataloging.",
  "messages": [
    {
      "step": 1,
      "description": "Showrunner opens Archive Snapshot TU",
      "envelope": {
        "protocol": {
          "name": "qf-protocol",
          "version": "1.0.0"
        },
        "id": "urn:uuid:as-tu-open-001",
        "time": "2025-11-06T11:30:00Z",
        "sender": {
          "role": "SR",
          "agent": "human:alice"
        },
        "receiver": {
          "role": "broadcast"
        },
        "intent": "tu.open",
        "context": {
          "hot_cold": "cold",
          "tu": "TU-2025-11-06-SR03",
          "snapshot": "Cold @ 2025-11-05",
          "loop": "Archive Snapshot"
        },
        "safety": {
          "player_safe": false,
          "spoilers": "allowed"
        },
        "payload": {
          "type": "tu_brief",
          "data": {
            "id": "TU-2025-11-06-SR03",
            "opened": "2025-11-06",
            "owner_a": "SR",
            "responsible_r": ["SR", "BB"],
            "loop": "Archive Snapshot",
            "slice": "Create comprehensive snapshot of project state after Chapter 3 milestone",
            "snapshot_context": "Cold @ 2025-11-05",
            "awake": ["SR", "BB", "GK"],
            "dormant": ["AD", "IL", "AuD", "AuP", "TR", "PN", "RS", "PW", "SS", "LW", "CC", "ST"],
            "press": ["Integrity", "Determinism"],
            "pre_gate_risks": [],
            "inputs": [
              "Cold snapshot @ 2025-11-05 (all merged artifacts)",
              "Hot snapshot @ 2025-11-06 (active TUs)",
              "All TU records, Gatecheck reports, Hook cards",
              "Schema files and tool versions"
            ],
            "deliverables": [
              "Archive package with complete project state",
              "Manifest with checksums",
              "Archive index entry"
            ],
            "bars_green": ["Integrity"],
            "merge_view": "Archive stored; no merge to Cold (archival only)",
            "timebox": "60 min",
            "gatecheck": "Integrity verification by Gatekeeper",
            "linkage": "Chapter 3 project state preserved; restoration tested"
          }
        },
        "refs": [],
        "correlation_id": "corr-archive-chapter3-2025-11-06",
        "reply_to": null
      }
    },
    {
      "step": 2,
      "description": "Book Binder collects artifacts and generates manifest",
      "envelope": {
        "protocol": {
          "name": "qf-protocol",
          "version": "1.0.0"
        },
        "id": "urn:uuid:as-manifest-001",
        "time": "2025-11-06T11:50:00Z",
        "sender": {
          "role": "BB",
          "agent": "bot:binder-v2"
        },
        "receiver": {
          "role": "SR"
        },
        "intent": "archive.manifest",
        "context": {
          "hot_cold": "cold",
          "tu": "TU-2025-11-06-SR03",
          "snapshot": "Cold @ 2025-11-05",
          "loop": "Archive Snapshot"
        },
        "safety": {
          "player_safe": false,
          "spoilers": "allowed"
        },
        "payload": {
          "type": "tu_brief",
          "data": {
            "manifest": {
              "snapshot_ids": {
                "cold": "Cold @ 2025-11-05",
                "hot": "Hot @ 2025-11-06"
              },
              "artifacts_collected": {
                "manuscript_sections": 18,
                "canon_packs": 5,
                "codex_entries": 12,
                "hook_cards": 23,
                "tu_briefs": 15,
                "gatecheck_reports": 12,
                "style_addenda": 2,
                "art_plans": 1,
                "audio_plans": 1,
                "language_packs": 1,
                "view_logs": 3
              },
              "schema_versions": {
                "hook_card": "0.2.0",
                "tu_brief": "0.2.0",
                "gatecheck_report": "0.2.0"
              },
              "checksums": "SHA-256 for all files",
              "total_files": 73
            }
          }
        },
        "refs": ["TU-2025-11-06-SR03"],
        "correlation_id": "corr-archive-chapter3-2025-11-06",
        "reply_to": "urn:uuid:as-tu-open-001"
      }
    },
    {
      "step": 3,
      "description": "Gatekeeper verifies archive integrity",
      "envelope": {
        "protocol": {
          "name": "qf-protocol",
          "version": "1.0.0"
        },
        "id": "urn:uuid:as-gk-verify-001",
        "time": "2025-11-06T12:00:00Z",
        "sender": {
          "role": "GK",
          "agent": "bot:gk-validator"
        },
        "receiver": {
          "role": "SR"
        },
        "intent": "archive.verify",
        "context": {
          "hot_cold": "cold",
          "tu": "TU-2025-11-06-SR03",
          "snapshot": "Cold @ 2025-11-05",
          "loop": "Archive Snapshot"
        },
        "safety": {
          "player_safe": false,
          "spoilers": "allowed"
        },
        "payload": {
          "type": "ack",
          "data": {
            "message": "Archive integrity verified; all checksums valid; critical artifacts present (15 TUs, 12 gatechecks, 23 hooks); manifest completeness confirmed; restoration instructions testable"
          }
        },
        "refs": ["TU-2025-11-06-SR03"],
        "correlation_id": "corr-archive-chapter3-2025-11-06",
        "reply_to": "urn:uuid:as-manifest-001"
      }
    },
    {
      "step": 4,
      "description": "Book Binder packages and stores archive",
      "envelope": {
        "protocol": {
          "name": "qf-protocol",
          "version": "1.0.0"
        },
        "id": "urn:uuid:as-package-001",
        "time": "2025-11-06T12:10:00Z",
        "sender": {
          "role": "BB",
          "agent": "bot:binder-v2"
        },
        "receiver": {
          "role": "SR"
        },
        "intent": "archive.package",
        "context": {
          "hot_cold": "cold",
          "tu": "TU-2025-11-06-SR03",
          "snapshot": "Cold @ 2025-11-05",
          "loop": "Archive Snapshot"
        },
        "safety": {
          "player_safe": false,
          "spoilers": "allowed"
        },
        "payload": {
          "type": "tu_brief",
          "data": {
            "archive_package": {
              "filename": "questfoundry-chapter3-2025-11-05.tar.gz",
              "size_mb": 42,
              "checksum_sha256": "a7f8d3c2e1b9f4a6c8e2d1f3b5a7c9e4d2f1a3b5c7e9d4f2a1b3c5e7f9d4a2b1",
              "storage_locations": [
                "/archives/local/questfoundry-chapter3-2025-11-05.tar.gz",
                "s3://questfoundry-archives/chapter3-2025-11-05.tar.gz",
                "/backup/offline/questfoundry-chapter3-2025-11-05.tar.gz"
              ],
              "restoration_tested": "yes"
            }
          }
        },
        "refs": ["TU-2025-11-06-SR03"],
        "correlation_id": "corr-archive-chapter3-2025-11-06",
        "reply_to": "urn:uuid:as-gk-verify-001"
      }
    },
    {
      "step": 5,
      "description": "Showrunner catalogs archive and notifies team",
      "envelope": {
        "protocol": {
          "name": "qf-protocol",
          "version": "1.0.0"
        },
        "id": "urn:uuid:as-catalog-001",
        "time": "2025-11-06T12:20:00Z",
        "sender": {
          "role": "SR",
          "agent": "human:alice"
        },
        "receiver": {
          "role": "broadcast"
        },
        "intent": "tu.update",
        "context": {
          "hot_cold": "cold",
          "tu": "TU-2025-11-06-SR03",
          "snapshot": "Cold @ 2025-11-05",
          "loop": "Archive Snapshot"
        },
        "safety": {
          "player_safe": false,
          "spoilers": "allowed"
        },
        "payload": {
          "type": "tu_brief",
          "data": {
            "id": "TU-2025-11-06-SR03",
            "deliverables": [
              "Archive package: questfoundry-chapter3-2025-11-05.tar.gz (42 MB, 73 files)",
              "Archive stored in 3 locations: local, cloud (S3), offline backup",
              "Archive index entry cataloged with snapshot IDs and restoration status"
            ],
            "linkage": "Chapter 3 project state archived; restoration tested; team notified of archive location; recovery contact: SR"
          }
        },
        "refs": ["TU-2025-11-06-SR03"],
        "correlation_id": "corr-archive-chapter3-2025-11-06",
        "reply_to": null
      }
    }
  ]
}
