"use strict";(self.webpackChunkjupyterlab_markdown_insert_content_extension=self.webpackChunkjupyterlab_markdown_insert_content_extension||[]).push([[509],{509:(t,e,o)=>{o.r(e),o.d(e,{default:()=>u});var n,r=o(544),c=o(762),i=o(560);function s(t){return t.replace(/Â¶+$/,"").trim().replace(/\s+/g,"-")}function a(t,e){const o=[],n=t.split("\n");let r=!1;for(const t of n){if(t.match(/^```/)||t.match(/^~~~/)){r=!r;continue}if(r)continue;const n=t.match(/^(#{1,6})\s+(.+)$/);if(n){const t=n[1].length;if(t>e)continue;const r=n[2].trim(),c=s(r);o.push({text:r,level:t,id:c})}}return o}function l(t,e){const o=[];for(const e of t){const t=`${"  ".repeat(Math.max(0,e.level-1))}- [${e.text}](#${e.id})`;o.push(t)}return`${e?`${e}\n\n`:""}${o.join("\n")}\n\n`}!function(t){t.insertTOC="markdown-insert:insert-toc"}(n||(n={}));const d={id:"jupyterlab_markdown_insert_content_extension:plugin",description:"Jupyterlab extension to automatically insert content into markdown - such as TOC, bibliography, list of figures etc.",autoStart:!0,optional:[r.IEditorTracker,c.INotebookTracker,i.ISettingRegistry],activate:(t,e,o,r)=>{console.log("JupyterLab extension jupyterlab_markdown_insert_content_extension is activated!");let c={tocCaption:"## Table of Contents",tocMaxLevel:3};r&&r.load(d.id).then(t=>{const e=()=>{c.tocCaption=t.get("tocCaption").composite,c.tocMaxLevel=t.get("tocMaxLevel").composite};e(),t.changed.connect(e)}).catch(t=>{console.error("Failed to load settings for markdown-insert-content:",t)}),t.commands.addCommand(n.insertTOC,{label:"Insert Table of Contents",caption:"Insert a table of contents at the cursor position",execute:()=>{(null==o?void 0:o.currentWidget)?function(t,e){const o=t.currentWidget;if(!o)return void console.warn("No active notebook");const n=o.content,r=n.activeCell;if(!r||"markdown"!==r.model.type)return void console.warn("Active cell is not a markdown cell");const c=r.editor,i=r.model;let s="";for(let t=0;t<n.model.cells.length;t++){const e=n.model.cells.get(t);"markdown"===e.type&&(s+=e.sharedModel.getSource()+"\n\n")}const d=a(s,e.tocMaxLevel);if(0===d.length)return void console.warn("No headings found in notebook");const u=l(d,e.tocCaption),f=c.getCursorPosition(),m=c.getOffsetAt(f),p=i.sharedModel.getSource();i.sharedModel.setSource(p.slice(0,m)+u+p.slice(m))}(o,c):(null==e?void 0:e.currentWidget)?function(t,e){const o=t.currentWidget;if(!o)return void console.warn("No active file editor");const n=o.content.editor,r=o.content.model,c=a(r.sharedModel.getSource(),e.tocMaxLevel);if(0===c.length)return void console.warn("No headings found in document");const i=l(c,e.tocCaption),s=n.getCursorPosition(),d=n.getOffsetAt(s);r.sharedModel.updateSource(d,d,i)}(e,c):console.warn("No active markdown editor or notebook")}}),e&&t.contextMenu.addItem({command:n.insertTOC,selector:".jp-FileEditor",rank:10}),o&&t.contextMenu.addItem({command:n.insertTOC,selector:".jp-Notebook .jp-MarkdownCell",rank:10})}},u=d}}]);