# This file was auto-generated by Fern from our API Definition.

import datetime as dt
import typing

import pydantic
import typing_extensions
from ..core.pydantic_utilities import IS_PYDANTIC_V2, UniversalBaseModel
from ..core.serialization import FieldMetadata
from .chain_token_invoice import ChainTokenInvoice
from .fiat_details import FiatDetails
from .invoice_status import InvoiceStatus
from .last_transaction import LastTransaction


class Invoice(UniversalBaseModel):
    id: str = pydantic.Field()
    """
    Invoice UUID
    """

    order_id: typing_extensions.Annotated[str, FieldMetadata(alias="orderId")] = pydantic.Field()
    """
    id in the client's system (specified when creating an invoice)
    """

    description: typing.Optional[str] = pydantic.Field(default=None)
    """
    Description, shown on the payment page
    """

    amount: typing.Optional[str] = pydantic.Field(default=None)
    """
    Amount in USD, even if the invoice was created in another currency
    """

    payed_amount: typing_extensions.Annotated[str, FieldMetadata(alias="payedAmount")] = pydantic.Field()
    """
    Amount paid in USD
    """

    fee_included: typing_extensions.Annotated[bool, FieldMetadata(alias="feeIncluded")] = pydantic.Field()
    """
    If the option is enabled, the service fee will be added to the amount
    """

    accuracy: str = pydantic.Field()
    """
    What deviation from amount should still be marked COMPLETE. From 0 to 0.05 where 0.05 is 5%
    """

    discount: typing.Optional[str] = pydantic.Field(default=None)
    """
    DEPRECATED
    """

    fee_rate: typing_extensions.Annotated[str, FieldMetadata(alias="feeRate")] = pydantic.Field()
    """
    What fraction of the actual payment amount will be debited as a service fee. For example, 0.02 is 2%
    """

    created_at: typing_extensions.Annotated[dt.datetime, FieldMetadata(alias="createdAt")] = pydantic.Field()
    """
    Invoice creation date in ISO 8601 format
    """

    expired_at: typing_extensions.Annotated[dt.datetime, FieldMetadata(alias="expiredAt")] = pydantic.Field()
    """
    Invoice expiration date in ISO 8601 format
    """

    status: InvoiceStatus = pydantic.Field()
    """
    Current invoice status
    """

    url: str = pydantic.Field()
    """
    Payment link
    """

    addresses: typing.List[ChainTokenInvoice] = pydantic.Field()
    """
    Wallet addresses for payment
    """

    fiat_details: typing_extensions.Annotated[
        typing.List[typing.Optional[FiatDetails]], FieldMetadata(alias="FiatDetails")
    ] = pydantic.Field()
    """
    Payment details in fiat (if applicable)
    """

    last_transaction: typing_extensions.Annotated[
        typing.Optional[LastTransaction], FieldMetadata(alias="lastTransaction")
    ] = pydantic.Field(default=None)
    """
    Last transaction on invoice
    """

    url_success: typing_extensions.Annotated[typing.Optional[str], FieldMetadata(alias="urlSuccess")] = pydantic.Field(
        default=None
    )
    """
    Redirect after successful payment
    """

    url_return: typing_extensions.Annotated[typing.Optional[str], FieldMetadata(alias="urlReturn")] = pydantic.Field(
        default=None
    )
    """
    Redirect after failure (canceled or expired)
    """

    original_expired_at: typing_extensions.Annotated[
        typing.Optional[dt.datetime], FieldMetadata(alias="originalExpiredAt")
    ] = pydantic.Field(default=None)
    """
    When an invoice is prolonged, the original expiredAt is recorded here
    """

    canceled_at: typing_extensions.Annotated[typing.Optional[dt.datetime], FieldMetadata(alias="canceledAt")] = (
        pydantic.Field(default=None)
    )
    """
    Invoice cancellation date in ISO 8601 format
    """

    support_link: typing_extensions.Annotated[typing.Optional[str], FieldMetadata(alias="supportLink")] = (
        pydantic.Field(default=None)
    )
    """
    Merchant support link
    """

    merchant_amount: typing_extensions.Annotated[str, FieldMetadata(alias="merchantAmount")] = pydantic.Field()
    """
    Amount to be credited to the merchant, after deducting the commission
    """

    if IS_PYDANTIC_V2:
        model_config: typing.ClassVar[pydantic.ConfigDict] = pydantic.ConfigDict(extra="allow", frozen=True)  # type: ignore # Pydantic v2
    else:

        class Config:
            frozen = True
            smart_union = True
            extra = pydantic.Extra.allow
