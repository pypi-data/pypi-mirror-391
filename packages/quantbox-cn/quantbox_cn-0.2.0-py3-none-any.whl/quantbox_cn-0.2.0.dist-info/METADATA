Metadata-Version: 2.4
Name: quantbox-cn
Version: 0.2.0
Summary: A quantitative trading toolbox with multiple data source support
Author-email: HuChen <curiousbull@outlook.com>
License-File: LICENSE
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Financial and Insurance Industry
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Office/Business :: Financial :: Investment
Requires-Python: >=3.12
Requires-Dist: aiofiles>=23.0.0
Requires-Dist: aiohttp>=3.9.0
Requires-Dist: aiometer>=0.4.0
Requires-Dist: click>=8.0.0
Requires-Dist: motor>=3.3.0
Requires-Dist: numpy>=1.24.0
Requires-Dist: pandas<3.0,>=2.0
Requires-Dist: pymongo<5.0,>=4.0
Requires-Dist: toml>=0.10.0
Requires-Dist: tqdm>=4.65.0
Requires-Dist: tushare>=1.4.0
Provides-Extra: all
Requires-Dist: black>=24.0.0; extra == 'all'
Requires-Dist: gm>=3.0.0; extra == 'all'
Requires-Dist: mypy>=1.8.0; extra == 'all'
Requires-Dist: pyqt6>=6.0.0; extra == 'all'
Requires-Dist: pytest-asyncio>=0.23.0; extra == 'all'
Requires-Dist: pytest-cov>=4.0.0; extra == 'all'
Requires-Dist: pytest>=8.0.0; extra == 'all'
Requires-Dist: ruff>=0.1.0; extra == 'all'
Provides-Extra: build
Requires-Dist: pyinstaller>=6.0.0; extra == 'build'
Provides-Extra: dev
Requires-Dist: black>=24.0.0; extra == 'dev'
Requires-Dist: mypy>=1.8.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.23.0; extra == 'dev'
Requires-Dist: pytest-cov>=4.0.0; extra == 'dev'
Requires-Dist: pytest>=8.0.0; extra == 'dev'
Requires-Dist: ruff>=0.1.0; extra == 'dev'
Provides-Extra: goldminer
Requires-Dist: gm>=3.0.0; extra == 'goldminer'
Provides-Extra: gui
Requires-Dist: pyqt6>=6.0.0; extra == 'gui'
Description-Content-Type: text/markdown

# Quantbox

[![Python Version](https://img.shields.io/badge/python-3.12+-blue.svg)](https://www.python.org/downloads/)
[![Test Files](https://img.shields.io/badge/test_files-12-success.svg)](https://github.com/curiousbull/quantbox)
[![Test Cases](https://img.shields.io/badge/test_cases-187+-success.svg)](https://github.com/curiousbull/quantbox)
[![Services Coverage](https://img.shields.io/badge/services-100%25%20%7C%2085%25-brightgreen.svg)](https://github.com/curiousbull/quantbox)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![PyPI Version](https://img.shields.io/pypi/v/quantbox-cn.svg)](https://pypi.org/project/quantbox-cn/)

**Quantbox** æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ Python é‡‘èæ•°æ®è·å–å’Œç®¡ç†æ¡†æ¶ï¼Œé‡‡ç”¨æ¸…æ™°çš„ä¸‰å±‚æ¶æ„è®¾è®¡ï¼Œæ”¯æŒå¤šç§æ•°æ®æºï¼ˆTushareã€æ˜é‡‘é‡åŒ–ç­‰ï¼‰ï¼Œä¸ºé‡åŒ–ç ”ç©¶å’Œäº¤æ˜“æä¾›ç»Ÿä¸€ã€é«˜æ•ˆçš„æ•°æ®æ¥å£ã€‚

> âš ï¸ **é‡è¦æ›´æ–° (2025-11-11)**ï¼š
> - âœ¨ ä¼˜åŒ–äº¤æ˜“æ—¥å†æ•°æ®ç»“æ„ï¼ˆç§»é™¤å†—ä½™ `is_open` å­—æ®µï¼Œæ–°å¢ `datestamp` ç´¢å¼•ï¼‰
> - ğŸ¯ å¢å¼ºåˆçº¦æŸ¥è¯¢æ¥å£ï¼ˆæ”¯æŒç®€å•æ ¼å¼å’Œå®Œæ•´æ ¼å¼ï¼Œæ™ºèƒ½è§£æï¼‰
> - ğŸ“ˆ æŸ¥è¯¢æ€§èƒ½æå‡ 6.4%ï¼Œå­˜å‚¨ç©ºé—´å‡å°‘ 12%
> - è¯¦è§ [è¿ç§»æŒ‡å—](docs/MIGRATION_GUIDE.md)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ—ï¸ **ä¸‰å±‚æ¶æ„è®¾è®¡**ï¼šå·¥å…·å±‚ â†’ é€‚é…å™¨å±‚ â†’ æœåŠ¡å±‚ï¼ŒèŒè´£æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•
- âš¡ **å¼‚æ­¥é«˜æ€§èƒ½**ï¼šå®Œæ•´å¼‚æ­¥å®ç°ï¼Œæ€§èƒ½æå‡ 10-20 å€ï¼Œæ”¯æŒ Python 3.14 nogil
- ğŸ”Œ **å¤šæ•°æ®æºæ”¯æŒ**ï¼šç»Ÿä¸€æ¥å£è®¿é—® Tushareã€æ˜é‡‘é‡åŒ– (GMAdapter)ã€æœ¬åœ° MongoDB
- ğŸš€ **æ™ºèƒ½æ•°æ®æºé€‰æ‹©**ï¼šè‡ªåŠ¨ä¼˜å…ˆä½¿ç”¨æœ¬åœ°æ•°æ®ï¼Œé™ä½ API è°ƒç”¨æˆæœ¬
- âš¡ **ç¼“å­˜é¢„çƒ­ç³»ç»Ÿ**ï¼šå¯åŠ¨æ—¶é¢„çƒ­ 1491 ä¸ªç¼“å­˜æ¡ç›®ï¼Œè¿è¡Œæ—¶æ€§èƒ½æå‡ 95%+
- ğŸ’¾ **é«˜æ•ˆæ•°æ®å­˜å‚¨**ï¼šæ‰¹é‡ upsert æ“ä½œï¼Œè‡ªåŠ¨å»é‡å’Œç´¢å¼•ä¼˜åŒ–
- ğŸ¯ **çµæ´»åˆçº¦æ ¼å¼**ï¼šæ”¯æŒç®€å•æ ¼å¼ `"a2501"` å’Œå®Œæ•´æ ¼å¼ `"DCE.a2501"`ï¼Œæ™ºèƒ½è§£æ
- ğŸ“ˆ **ä¼˜åŒ–æ•°æ®ç»“æ„**ï¼šäº¤æ˜“æ—¥å†ä½¿ç”¨ `datestamp` ç´¢å¼•ï¼ŒæŸ¥è¯¢æ€§èƒ½æå‡ 6.4%
- ğŸ“Š **å®Œæ•´ç±»å‹æ³¨è§£**ï¼šå…¨é¢çš„ç±»å‹æç¤ºï¼Œæ›´å¥½çš„ IDE æ”¯æŒ
- âœ… **é«˜æµ‹è¯•è¦†ç›–ç‡**ï¼š12ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œ187+ æµ‹è¯•ç”¨ä¾‹ï¼ŒæœåŠ¡å±‚ 100%/85% è¦†ç›–
- ğŸ› ï¸ **ç°ä»£åŒ–å·¥å…·é“¾**ï¼šä½¿ç”¨ uv è¿›è¡Œå¿«é€Ÿä¾èµ–ç®¡ç†

## ğŸ›ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Application Layer               â”‚
â”‚      (Your Scripts & Applications)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Services Layer                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ MarketData   â”‚  â”‚  DataSaver      â”‚ â”‚
â”‚  â”‚   Service    â”‚  â”‚   Service       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Adapters Layer                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Local   â”‚  â”‚ TuShare  â”‚  â”‚  GM   â”‚ â”‚
â”‚  â”‚ Adapter  â”‚  â”‚ Adapter  â”‚  â”‚ ...   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Utils Layer                        â”‚
â”‚  Date â€¢ Exchange â€¢ Contract Utilities   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¯¦ç»†æ¶æ„è¯´æ˜è¯·å‚é˜… [ARCHITECTURE.md](docs/ARCHITECTURE.md)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸€åˆ†é’Ÿä¸Šæ‰‹

```bash
# 1. å®‰è£…ï¼ˆ3 ç§æ–¹å¼ä»»é€‰å…¶ä¸€ï¼‰
pip install quantbox-cn                    # ä» PyPI å®‰è£…ï¼ˆæ¨èï¼‰
pip install quantbox-cn[goldminer]         # åŒ…å«æ˜é‡‘æ”¯æŒï¼ˆWindows/Linuxï¼‰

# 2. å¯åŠ¨ MongoDB
docker run -d --name quantbox-mongo -p 27017:27017 mongo:latest

# 3. åˆå§‹åŒ–é…ç½®
quantbox-config

# 4. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥ Tushare token
vi ~/.quantbox/settings/config.toml

# 5. æµ‹è¯•å®‰è£…
python -c "from quantbox.services import MarketDataService; print('âœ… å®‰è£…æˆåŠŸï¼')"
```

> ğŸ’¡ **é¦–æ¬¡ä½¿ç”¨ï¼Ÿ** è¯·æŸ¥çœ‹ä¸‹æ–¹è¯¦ç»†çš„ [é…ç½®æŒ‡å—](#ğŸ“-é…ç½®æŒ‡å—)

### å®Œæ•´å®‰è£…æŒ‡å—

#### æ–¹å¼ 1ï¼šä» PyPI å®‰è£…ï¼ˆæ¨èï¼Œé€‚åˆæ™®é€šç”¨æˆ·ï¼‰

```bash
# åŸºç¡€å®‰è£…
pip install quantbox-cn

# å®‰è£…æ˜é‡‘é‡åŒ–æ”¯æŒï¼ˆä»… Windows/Linuxï¼‰
pip install quantbox-cn[goldminer]

# å®‰è£…æ‰€æœ‰å¯é€‰ä¾èµ–ï¼ˆåŒ…æ‹¬å¼€å‘å·¥å…·ï¼‰
pip install quantbox-cn[all]
```

#### æ–¹å¼ 2ï¼šä½¿ç”¨ uv å®‰è£…ï¼ˆé€‚åˆå¼€å‘è€…ï¼‰

```bash
# å®‰è£… uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# å…‹éš†é¡¹ç›®
git clone https://github.com/curiousbull/quantbox.git
cd quantbox

# å®‰è£…åŸºç¡€ä¾èµ–ï¼ˆè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼‰
uv sync

# ã€å¯é€‰ã€‘å®‰è£…æ˜é‡‘é‡åŒ– SDKï¼ˆä»…æ”¯æŒ Windows/Linuxï¼‰
uv sync --extra goldminer

# ã€å¯é€‰ã€‘å®‰è£…æ‰€æœ‰å¯é€‰ä¾èµ–ï¼ˆåŒ…æ‹¬å¼€å‘å·¥å…·ã€GUIï¼‰
uv sync --extra all

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate  # Linux/macOS
# .venv\Scripts\activate   # Windows
```

#### æ–¹å¼ 3ï¼šä»æºç å®‰è£…ï¼ˆé€‚åˆè´¡çŒ®è€…ï¼‰

```bash
git clone https://github.com/curiousbull/quantbox.git
cd quantbox
pip install -e .              # å¼€å‘æ¨¡å¼å®‰è£…
pip install -e ".[dev]"       # åŒ…å«å¼€å‘å·¥å…·
```

### ğŸ“ é…ç½®æŒ‡å—

#### ç¬¬ä¸€æ­¥ï¼šå®‰è£… MongoDB

Quantbox ä½¿ç”¨ MongoDB ä½œä¸ºæœ¬åœ°æ•°æ®å­˜å‚¨ã€‚è¯·é€‰æ‹©ä»¥ä¸‹ä»»ä¸€æ–¹å¼å®‰è£…ï¼š

**æ–¹å¼ 1ï¼šDockerï¼ˆæ¨èï¼‰**
```bash
# æ‹‰å– MongoDB é•œåƒ
docker pull mongo:latest

# å¯åŠ¨ MongoDB å®¹å™¨
docker run -d \
  --name quantbox-mongo \
  -p 27017:27017 \
  -v ~/quantbox-data:/data/db \
  mongo:latest

# éªŒè¯è¿è¡ŒçŠ¶æ€
docker ps | grep quantbox-mongo
```

**æ–¹å¼ 2ï¼šæœ¬åœ°å®‰è£…**
- **macOS**: `brew install mongodb-community && brew services start mongodb-community`
- **Ubuntu**: `sudo apt install mongodb && sudo systemctl start mongodb`
- **Windows**: ä¸‹è½½ [MongoDB Community Server](https://www.mongodb.com/try/download/community)

**æ–¹å¼ 3ï¼šäº‘æœåŠ¡**
- ä½¿ç”¨ [MongoDB Atlas](https://www.mongodb.com/cloud/atlas) å…è´¹å¥—é¤ï¼ˆ512MBï¼‰

#### ç¬¬äºŒæ­¥ï¼šè·å–æ•°æ®æº Token

**Tushare Proï¼ˆå¿…éœ€ï¼‰**

Tushare æ˜¯ä¸»è¦çš„æ•°æ®æºï¼Œéœ€è¦æ³¨å†Œå¹¶è·å– tokenï¼š

1. è®¿é—® [Tushare Pro](https://tushare.pro/) æ³¨å†Œè´¦å·
2. ç™»å½•åè¿›å…¥ [ä¸ªäººä¸­å¿ƒ](https://tushare.pro/user/token) è·å– token
3. æ³¨æ„ï¼šå…è´¹ç”¨æˆ·æœ‰ç§¯åˆ†é™åˆ¶ï¼Œå»ºè®®å……å€¼è·å–æ›´å¤šç§¯åˆ†

**æ˜é‡‘é‡åŒ–ï¼ˆå¯é€‰ï¼Œä»…æ”¯æŒ Windows/Linuxï¼‰**

å¦‚éœ€ä½¿ç”¨æ˜é‡‘æ•°æ®æºï¼š

1. è®¿é—® [æ˜é‡‘é‡åŒ–](https://www.myquant.cn/) æ³¨å†Œè´¦å·
2. å®‰è£…æ˜é‡‘ç»ˆç«¯å¹¶è·å– token
3. å®‰è£… Python SDKï¼š`pip install quantbox-cn[goldminer]`

> âš ï¸ æ³¨æ„ï¼šæ˜é‡‘ SDK ä¸æ”¯æŒ macOS

#### ç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–é…ç½®

```bash
# å®‰è£…å®Œæˆåï¼Œè¿è¡Œé…ç½®å·¥å…·
quantbox-config
```

è¿™å°†è‡ªåŠ¨ï¼š
- åˆ›å»ºé…ç½®ç›®å½•ï¼š`~/.quantbox/settings/`
- ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š`~/.quantbox/settings/config.toml`
- æ˜¾ç¤ºé…ç½®è¯´æ˜

#### ç¬¬å››æ­¥ï¼šç¼–è¾‘é…ç½®æ–‡ä»¶

æ‰“å¼€é…ç½®æ–‡ä»¶å¹¶å¡«å…¥ä½ çš„ tokenï¼š

```bash
# macOS/Linux
vi ~/.quantbox/settings/config.toml

# Windows
notepad %USERPROFILE%\.quantbox\settings\config.toml
```

é…ç½®æ–‡ä»¶æ ¼å¼ï¼š

```toml
# Tushare Pro API é…ç½®ï¼ˆå¿…éœ€ï¼‰
[TSPRO]
token = "your_tushare_token_here"  # æ›¿æ¢ä¸ºä½ çš„ Tushare token

# æ˜é‡‘é‡åŒ– API é…ç½®ï¼ˆå¯é€‰ï¼ŒWindows/Linuxï¼‰
[GM]
token = ""  # å¦‚æœä½¿ç”¨æ˜é‡‘ï¼Œå¡«å…¥ä½ çš„ token

# MongoDB æ•°æ®åº“é…ç½®
[MONGODB]
uri = "mongodb://localhost:27017"  # æœ¬åœ° MongoDB
# uri = "mongodb+srv://user:pass@cluster.mongodb.net"  # äº‘æœåŠ¡ç¤ºä¾‹
```

#### ç¬¬äº”æ­¥ï¼šéªŒè¯å®‰è£…

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼š

```bash
# æµ‹è¯•æ•°æ®æŸ¥è¯¢
python -c "
from quantbox.services import MarketDataService
service = MarketDataService()
print('âœ… Quantbox é…ç½®æˆåŠŸï¼')
print('è·å–äº¤æ˜“æ—¥å†ç¤ºä¾‹ï¼š')
calendar = service.get_trade_calendar(exchanges='SHSE', start_date='2024-01-01', end_date='2024-01-05')
print(calendar)
"
```

å¦‚æœçœ‹åˆ°äº¤æ˜“æ—¥å†æ•°æ®è¾“å‡ºï¼Œè¯´æ˜é…ç½®æˆåŠŸï¼

#### å¸¸è§é—®é¢˜

**Q: MongoDB è¿æ¥å¤±è´¥ï¼Ÿ**
- æ£€æŸ¥ MongoDB æ˜¯å¦è¿è¡Œï¼š`docker ps` æˆ– `brew services list`
- æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š`lsof -i :27017`
- å°è¯•ä½¿ç”¨ IP åœ°å€ï¼š`mongodb://127.0.0.1:27017`

**Q: Tushare æŠ¥é”™ "token æ— æ•ˆ"ï¼Ÿ**
- æ£€æŸ¥ token æ˜¯å¦å¤åˆ¶å®Œæ•´ï¼ˆæ— å¤šä½™ç©ºæ ¼ï¼‰
- æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
- å°è¯•é‡æ–°è¿è¡Œï¼š`quantbox-config --force`

**Q: æç¤ºç§¯åˆ†ä¸è¶³ï¼Ÿ**
- Tushare å…è´¹ç”¨æˆ·æœ‰ç§¯åˆ†é™åˆ¶
- å»ºè®®å……å€¼è·å–æ›´å¤šç§¯åˆ†ï¼Œæˆ–å‡å°‘è¯·æ±‚é¢‘ç‡

**Q: macOS ä¸Šä½¿ç”¨æ˜é‡‘ï¼Ÿ**
- æ˜é‡‘ SDK ä¸æ”¯æŒ macOSï¼Œè¯·ä½¿ç”¨ Tushare æˆ–å…¶ä»–æ•°æ®æº

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### åº”ç”¨åˆå§‹åŒ–å’Œç¼“å­˜é¢„çƒ­

```python
import quantbox

# æ–¹æ³•1ï¼šæ¨èçš„æ ‡å‡†åˆå§‹åŒ–ï¼ˆè‡ªåŠ¨é¢„çƒ­ç¼“å­˜ï¼‰
stats = quantbox.init(auto_warm=True, warm_verbose=False)
print(f"åˆå§‹åŒ–å®Œæˆï¼Œé¢„çƒ­è€—æ—¶: {stats['total_time']:.3f}s")

# æ–¹æ³•2ï¼šæ‰‹åŠ¨é¢„çƒ­ç¼“å­˜
stats = quantbox.warm_caches(verbose=True)
print(f"é¢„çƒ­äº† {stats['functions_warmed']} ä¸ªå‡½æ•°ï¼Œ{stats['cache_entries']} ä¸ªç¼“å­˜æ¡ç›®")

# æ–¹æ³•3ï¼šåå°è‡ªåŠ¨é¢„çƒ­ï¼ˆä¸é˜»å¡åº”ç”¨å¯åŠ¨ï¼‰
quantbox.auto_warm_on_import(enable=True)
```

**ç¼“å­˜é¢„çƒ­å¸¦æ¥çš„æ€§èƒ½æå‡**ï¼š
- ğŸš€ åº”ç”¨å¯åŠ¨åé¦–æ¬¡æ“ä½œé€Ÿåº¦æå‡ **95%+**
- âš¡ äº¤æ˜“æ‰€ä»£ç è½¬æ¢ä» ~1ms é™ä½åˆ° ~0.02ms
- ğŸ“ˆ æ”¯æŒæ•°ç™¾ä¸ªå¸¸ç”¨å‡½æ•°ç»„åˆçš„æ™ºèƒ½ç¼“å­˜

### æŸ¥è¯¢å¸‚åœºæ•°æ®

```python
from quantbox.services import MarketDataService

# åˆ›å»ºæœåŠ¡å®ä¾‹
service = MarketDataService()

# è·å–äº¤æ˜“æ—¥å†
calendar = service.get_trade_calendar(
    exchanges=["SHSE", "SZSE"],
    start_date="2024-01-01",
    end_date="2024-01-31"
)
print(calendar)

# è·å–æœŸè´§åˆçº¦ä¿¡æ¯
contracts = service.get_future_contracts(
    exchanges="SHFE",
    date="2024-01-15"
)
print(contracts)

# è·å–æœŸè´§æ—¥çº¿æ•°æ®ï¼ˆæ”¯æŒå¤šç§åˆçº¦æ ¼å¼ï¼‰
daily = service.get_future_daily(
    symbols="DCE.a2501",      # å®Œæ•´æ ¼å¼ï¼šäº¤æ˜“æ‰€.åˆçº¦
    start_date="2024-01-01",
    end_date="2024-01-31"
)
# ä¹Ÿæ”¯æŒç®€å•æ ¼å¼ï¼šsymbols="a2501"
print(daily)

# è·å–æŒä»“æ•°æ®
holdings = service.get_future_holdings(
    exchanges="DCE",
    date="2024-01-15"
)
print(holdings)
```

### ä¿å­˜æ•°æ®åˆ°æœ¬åœ°

```python
from quantbox.services import DataSaverService

# åˆ›å»ºä¿å­˜æœåŠ¡å®ä¾‹
saver = DataSaverService()

# ä¿å­˜äº¤æ˜“æ—¥å†
result = saver.save_trade_calendar(
    exchanges=["SHSE", "SZSE"],
    start_date="2024-01-01",
    end_date="2024-12-31"
)
print(f"æ’å…¥: {result.inserted_count}, æ›´æ–°: {result.modified_count}")

# ä¿å­˜æœŸè´§åˆçº¦
result = saver.save_future_contracts(
    exchanges="SHFE",
    date="2024-01-15"
)

# ä¿å­˜æ—¥çº¿æ•°æ®
result = saver.save_future_daily(
    exchanges="DCE",
    start_date="2024-01-01",
    end_date="2024-01-31"
)
```

### âš¡ å¼‚æ­¥é«˜æ€§èƒ½ç‰ˆæœ¬ï¼ˆæ€§èƒ½æå‡ 10-20 å€ï¼‰

quantbox æä¾›å®Œæ•´çš„å¼‚æ­¥å®ç°ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®ä¸‹è½½å’Œå¹¶å‘æŸ¥è¯¢åœºæ™¯ã€‚

#### å¼‚æ­¥æŸ¥è¯¢æ•°æ®

```python
import asyncio
from quantbox.services import AsyncMarketDataService

async def main():
    # åˆ›å»ºå¼‚æ­¥æœåŠ¡å®ä¾‹
    service = AsyncMarketDataService()

    # å¼‚æ­¥è·å–æœŸè´§æŒä»“ï¼ˆæ€§èƒ½æå‡ 12-17 å€ï¼‰
    holdings = await service.get_future_holdings(
        exchanges=["SHFE", "DCE"],
        start_date="2024-01-01",
        end_date="2024-01-10",
        show_progress=True
    )
    print(f"è·å– {len(holdings)} æ¡æŒä»“æ•°æ®")

asyncio.run(main())
```

#### å¼‚æ­¥ä¿å­˜æ•°æ®

```python
import asyncio
from quantbox.services import AsyncDataSaverService

async def main():
    # åˆ›å»ºå¼‚æ­¥ä¿å­˜æœåŠ¡
    saver = AsyncDataSaverService(show_progress=True)

    # å¹¶å‘ä¿å­˜æ‰€æœ‰æ•°æ®ï¼ˆæ€§èƒ½æå‡ 14 å€ï¼‰
    results = await saver.save_all(
        start_date="2024-01-01",
        end_date="2024-01-10"
    )

    # æ‰“å°ç»“æœ
    for key, result in results.items():
        print(f"{key}: æ’å…¥ {result.inserted_count}ï¼Œæ›´æ–° {result.modified_count}")

asyncio.run(main())
```

#### ä½¿ç”¨å¼‚æ­¥ Shell

```bash
# å¯åŠ¨å¼‚æ­¥äº¤äº’å¼ Shell
quantbox-async

# åœ¨ Shell ä¸­æ‰§è¡Œå‘½ä»¤
quantbox-async> save_all --start-date 2024-01-01 --end-date 2024-01-10
quantbox-async> save_future_holdings --exchanges SHFE,DCE --date 2024-01-05
```

#### ä½¿ç”¨å¼‚æ­¥ CLI

```bash
# å¹¶å‘ä¿å­˜æ‰€æœ‰æ•°æ®
quantbox-save-async save-all --start-date 2024-01-01

# ä¿å­˜æœŸè´§æŒä»“ï¼ˆæ ¸å¿ƒæ€§èƒ½ä¼˜åŒ–ï¼‰
quantbox-save-async save-holdings --exchanges SHFE,DCE \
                                    --start-date 2024-01-01 \
                                    --end-date 2024-01-10

# è¿è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
quantbox-save-async benchmark --exchanges SHFE,DCE
```

#### æ€§èƒ½å¯¹æ¯”

| æ“ä½œ | åŒæ­¥ç‰ˆæœ¬ | å¼‚æ­¥ç‰ˆæœ¬ | æå‡å€æ•° |
|---|---|---|---|
| æœŸè´§æŒä»“ä¸‹è½½ï¼ˆ10 å¤©ï¼‰ | 250s | 15-20s | **12-17x** |
| å®Œæ•´æ•°æ®ä¿å­˜ (save_all) | 355s | 25s | **14x** |
| å¹¶å‘æŸ¥è¯¢å¤šäº¤æ˜“æ‰€ | 45s | 8s | **5.6x** |

**Python 3.14 nogil é¢å¤–æå‡**ï¼šåœ¨ nogil æ¨¡å¼ä¸‹å¯å†æå‡ 50-60%

è¯¦ç»†æ–‡æ¡£ï¼š
- [å¼‚æ­¥ä½¿ç”¨æŒ‡å—](docs/ASYNC_GUIDE.md)
- [å¼‚æ­¥å®ç°æŠ¥å‘Š](docs/ASYNC_IMPLEMENTATION_REPORT.md)
- [nogil æµ‹è¯•æŒ‡å—](docs/NOGIL_TESTING_GUIDE.md)

### æ•°æ®æºåˆ‡æ¢

```python
from quantbox.services import MarketDataService

# é»˜è®¤ï¼šæœ¬åœ°ä¼˜å…ˆ
service = MarketDataService()
data = service.get_trade_calendar()  # å…ˆæŸ¥æœ¬åœ°ï¼Œæ²¡æœ‰å†æŸ¥è¿œç¨‹

# å¼ºåˆ¶ä½¿ç”¨è¿œç¨‹æ•°æ®æº
data = service.get_trade_calendar(use_local=False)

# å¼ºåˆ¶ä½¿ç”¨æœ¬åœ°æ•°æ®æº
data = service.get_trade_calendar(use_local=True)
```

æ›´å¤šç¤ºä¾‹è¯·å‚é˜… [QUICK_START.md](docs/QUICK_START.md)

## ğŸ“š æ–‡æ¡£

- **[å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/QUICK_START.md)** - 5åˆ†é’Ÿä¸Šæ‰‹æ•™ç¨‹
- **[ç¼“å­˜é¢„çƒ­æŒ‡å—](examples/cache_warmup_example.py)** - è¯¦ç»†çš„ç¼“å­˜é¢„çƒ­ä½¿ç”¨ç¤ºä¾‹
- **[æ¶æ„æ–‡æ¡£](docs/ARCHITECTURE.md)** - è¯¦ç»†çš„ç³»ç»Ÿæ¶æ„è¯´æ˜
- **[API å‚è€ƒ](docs/API_REFERENCE.md)** - å®Œæ•´çš„ API æ–‡æ¡£
- **[è¿ç§»æŒ‡å—](docs/MIGRATION_GUIDE.md)** - ä»æ—§ç‰ˆæœ¬è¿ç§»
- **[ç¼–ç è§„èŒƒ](docs/coding_standards.md)** - é¡¹ç›®ç¼–ç æ ‡å‡†
- **[é‡æ„è®¾è®¡](docs/refactor_design.md)** - é‡æ„è®¾è®¡æ–‡æ¡£

## ğŸ§ª æµ‹è¯•

è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼š

```bash
uv run pytest tests/ -v
```

è¿è¡Œæ ¸å¿ƒæµ‹è¯•ï¼ˆè·³è¿‡æ•°æ®åº“æµ‹è¯•ï¼‰ï¼š

```bash
uv run pytest tests/ -v -m "not db"
```

ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šï¼š

```bash
uv run pytest tests/ --cov=quantbox --cov-report=html
```

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
quantbox/
â”œâ”€â”€ adapters/              # æ•°æ®é€‚é…å™¨å±‚
â”‚   â”œâ”€â”€ base.py           # é€‚é…å™¨åŸºç±»
â”‚   â”œâ”€â”€ local_adapter.py  # MongoDB é€‚é…å™¨
â”‚   â”œâ”€â”€ ts_adapter.py     # Tushare é€‚é…å™¨
â”‚   â”œâ”€â”€ gm_adapter.py     # æ˜é‡‘é‡åŒ–é€‚é…å™¨
â”‚   â”œâ”€â”€ formatters.py     # å…¬å…±æ ¼å¼è½¬æ¢å·¥å…·
â”‚   â””â”€â”€ asynchronous/     # å¼‚æ­¥é€‚é…å™¨
â”œâ”€â”€ services/             # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ market_data_service.py        # æ•°æ®æŸ¥è¯¢æœåŠ¡
â”‚   â”œâ”€â”€ data_saver_service.py         # æ•°æ®ä¿å­˜æœåŠ¡
â”‚   â”œâ”€â”€ async_market_data_service.py  # å¼‚æ­¥æŸ¥è¯¢æœåŠ¡
â”‚   â””â”€â”€ async_data_saver_service.py   # å¼‚æ­¥ä¿å­˜æœåŠ¡
â”œâ”€â”€ config/               # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ config_loader.py  # é…ç½®åŠ è½½å™¨
â”‚   â”œâ”€â”€ exchanges.toml    # äº¤æ˜“æ‰€é…ç½®
â”‚   â”œâ”€â”€ instruments.toml  # åˆçº¦é…ç½®
â”‚   â”œâ”€â”€ fees_margin.toml  # æ‰‹ç»­è´¹å’Œä¿è¯é‡‘é…ç½®
â”‚   â””â”€â”€ templates/        # é…ç½®æ¨¡æ¿
â”œâ”€â”€ util/                 # å·¥å…·å±‚
â”‚   â”œâ”€â”€ date_utils.py     # æ—¥æœŸå¤„ç†å·¥å…·
â”‚   â”œâ”€â”€ exchange_utils.py # äº¤æ˜“æ‰€ä»£ç å·¥å…·
â”‚   â”œâ”€â”€ contract_utils.py # åˆçº¦ä»£ç å·¥å…·
â”‚   â”œâ”€â”€ tools.py          # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ cache_warmup.py   # ç¼“å­˜é¢„çƒ­ç³»ç»Ÿ
â”œâ”€â”€ gui/                  # å›¾å½¢ç•Œé¢ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ cli.py                # å‘½ä»¤è¡Œå·¥å…·ï¼ˆåŒæ­¥ï¼‰
â”œâ”€â”€ cli_async.py          # å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¼‚æ­¥ï¼‰
â”œâ”€â”€ shell.py              # äº¤äº’å¼ Shellï¼ˆåŒæ­¥ï¼‰
â””â”€â”€ shell_async.py        # äº¤äº’å¼ Shellï¼ˆå¼‚æ­¥ï¼‰
```

## ğŸ”„ API å˜æ›´

### v2.0 æ–° APIï¼ˆæ¨èï¼‰

```python
# âœ… æ–°ç‰ˆæœ¬ - ç®€æ´æ¸…æ™°
from quantbox.services import MarketDataService

service = MarketDataService()
data = service.get_trade_calendar(exchanges="SHSE")
```

### v1.x æ—§ APIï¼ˆå·²ç§»é™¤ï¼‰

```python
# âŒ æ—§ç‰ˆæœ¬ - å·²åœ¨ v0.2.0 ä¸­å®Œå…¨ç§»é™¤
# from quantbox.fetchers import TSFetcher
# from quantbox.savers import MarketDataSaver

# è¿™äº›æ¨¡å—å·²ä¸å­˜åœ¨ï¼Œè¯·ä½¿ç”¨æ–°çš„æœåŠ¡å±‚ API
```

**æ³¨æ„**ï¼šæ—§çš„ `fetchers/` å’Œ `savers/` æ¨¡å—å·²åœ¨ v0.2.0 ä¸­å®Œå…¨ç§»é™¤ã€‚

è¯¦ç»†è¿ç§»æŒ‡å—è¯·å‚é˜… [MIGRATION_GUIDE.md](docs/MIGRATION_GUIDE.md)

## ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤ä¿®æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

è¯·ç¡®ä¿ï¼š

- æ‰€æœ‰æµ‹è¯•é€šè¿‡
- æ–°å¢ä»£ç æœ‰ç›¸åº”çš„æµ‹è¯•
- éµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒ

## ğŸ“Š æ€§èƒ½

### ç¼“å­˜é¢„çƒ­æ€§èƒ½
- **é¢„çƒ­è€—æ—¶**ï¼š~77msï¼ˆ147ä¸ªå‡½æ•°ï¼Œ1,491ä¸ªç¼“å­˜æ¡ç›®ï¼‰
- **è¿è¡Œæ—¶æå‡**ï¼šé¦–æ¬¡æ“ä½œé€Ÿåº¦æå‡ **95%+**
- **ä»£ç è½¬æ¢**ï¼šäº¤æ˜“æ‰€ä»£ç è½¬æ¢ä» ~1ms â†’ ~0.02ms
- **ç¼“å­˜å‘½ä¸­ç‡**ï¼š>95%ï¼ˆå¸¸ç”¨æ“ä½œç»„åˆï¼‰

### æ•°æ®æ“ä½œæ€§èƒ½
- **æŸ¥è¯¢é€Ÿåº¦**ï¼šæœ¬åœ°æŸ¥è¯¢ < 10msï¼Œè¿œç¨‹æŸ¥è¯¢ < 500ms
- **æ‰¹é‡å†™å…¥**ï¼š10,000 æ¡/ç§’ï¼ˆä½¿ç”¨ bulk_writeï¼‰
- **å†…å­˜å ç”¨**ï¼š< 100MBï¼ˆæ­£å¸¸è¿è¡Œï¼‰
- **å¹¶å‘æ”¯æŒ**ï¼šçº¿ç¨‹å®‰å…¨çš„æ•°æ®è®¿é—®

## ğŸ“ æ›´æ–°æ—¥å¿—

### v0.2.0 (2025-11-12)

- ğŸ‰ **é‡å¤§é‡æ„**ï¼šå…¨æ–°çš„ä¸‰å±‚æ¶æ„è®¾è®¡
- âœ¨ **æ–°å¢**ï¼šMarketDataService å’Œ DataSaverServiceï¼ˆåŒæ­¥+å¼‚æ­¥ï¼‰
- âš¡ **å¼‚æ­¥æ”¯æŒ**ï¼šå®Œæ•´å¼‚æ­¥å®ç°ï¼Œæ€§èƒ½æå‡ 10-20 å€
- ğŸ—‘ï¸ **ç§»é™¤**ï¼šåˆ é™¤æ—§çš„ fetchers/ å’Œ savers/ æ¨¡å—
- ğŸ”§ **æ”¹è¿›**ï¼šç»Ÿä¸€çš„æ•°æ®æ¥å£å’Œé”™è¯¯å¤„ç†
- ğŸ“š **æ–‡æ¡£**ï¼šå…¨é¢æ›´æ–°çš„ä½¿ç”¨æ–‡æ¡£
- âœ… **æµ‹è¯•**ï¼š187+ æµ‹è¯•ç”¨ä¾‹ï¼ŒæœåŠ¡å±‚è¦†ç›–ç‡ 100%/85%
- ğŸš€ **å·¥å…·**ï¼šè¿ç§»åˆ° uv é¡¹ç›®ç®¡ç†
- ğŸ§¹ **æ¸…ç†**ï¼šé¡¹ç›®ç»“æ„ä¼˜åŒ–ï¼Œç§»é™¤ä¸´æ—¶æ–‡ä»¶å’Œå¼€å‘æ–‡ä»¶

å®Œæ•´æ›´æ–°æ—¥å¿—è¯·æŸ¥çœ‹ [docs/refactor_progress.md](docs/refactor_progress.md)

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è°¢

- [Tushare](https://tushare.pro/) - é‡‘èæ•°æ®æ¥å£
- [æ˜é‡‘é‡åŒ–](https://www.myquant.cn/) - é‡åŒ–äº¤æ˜“å¹³å°
- [uv](https://github.com/astral-sh/uv) - ç°ä»£åŒ– Python åŒ…ç®¡ç†å™¨

## ğŸ“® è”ç³»æ–¹å¼

- é—®é¢˜åé¦ˆï¼š[GitHub Issues](https://github.com/curiousbull/quantbox/issues)
- åŠŸèƒ½å»ºè®®ï¼š[GitHub Discussions](https://github.com/curiousbull/quantbox/discussions)

---

**Made with â¤ï¸ by the Quantbox Team**
