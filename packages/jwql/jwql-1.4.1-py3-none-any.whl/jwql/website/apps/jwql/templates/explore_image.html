{% extends "base.html" %}

{% block preamble %}

	<title>Explore {{ inst }} Image - JWQL</title>

{% endblock %}

{% block content %}

    <main role="main" class="container">
    	<!-- Show fits file name -->
        <h2>Explore Mode </h2>
    	<h3>{{ file_root }}_{{ filetype }}.fits</h3>
        <p>
            <a class="btn btn-primary my-2 mx-2" role="button" href={{ url('jwql:view_image', args=[inst, file_root]) }}>View Image</a>
            <a class="btn btn-primary my-2 mx-2" role="button" href={{ url('jwql:archive_thumb_per_obs', args=[inst, file_root[2:7], file_root[7:10]]) }}> View Proposal</a>
            <a class="btn btn-primary my-2 mx-2" role="button" href="https://mast.stsci.edu/api/v0.1/Download/file?uri=mast%3AJWST%2Fproduct%2F{{ file_root }}_{{ filetype }}.fits">Download File</a>
	    </p>
        <p id="help"></p>

		<div class="row">
            <!-- Display the image -->
    	    <div class="col-xl-9">
                <iframe id="quickview" height="650px" width="800px" src="https://jwqlquickview.stsci.edu?file={{file_path | safe}}"></iframe>
            </div>
        </div>

        <!-- Display the anomaly form -->
        <div class="col-xl-3 text-left">
                <!--Load the file search form from the view-->
                <div class="anomaly_form">
                    <h5>Submit Anomaly</h5>
                    <form action="" method="post">
                        <!--Show any errors from a previous form submission-->
                        {% if anomaly_form.errors %}
                            <fieldset>
                                {% for field in anomaly_form %}
                                    {% for error in field.errors %}
                                        <div class="alert alert-danger">
                                            <strong>{{ error|escape }}</strong>
                                        </div>
                                    {% endfor %}
                                {% endfor %}
                            </fieldset>
                        {% endif %}

                        <!--Django Cross-Site Request Forgery magic-->
                        {{ csrf_input }}

                        <!--Show the field forms-->
                        {% for field in anomaly_form %}
                            {% for subwidget in field.subwidgets %}
                                <li class="anomaly_choice">{{subwidget}}</li>
                            {% endfor %}
                        {% endfor %}
                        <h5>Comments</h5>
                        {{ comment_form.comment }}
                        <button class="btn btn-primary" type="submit">Submit</button>
                    </form>
                </div>
            </div>

    </main>
    <script>explore_image_update_enable_options('{{ extension_ints }}', '{{ extension_groups }}');</script>
    <script>update_explore_image_page('{{inst}}', '{{file_root}}', '{{filetype}}', '{{base_url}}');</script>

{% endblock %}
