from ..response import ResponseModel

from typing import Any, Literal
from ..http import HttpClient
from httpx._types import HeaderTypes

from ..schemas.asset_datapoint_query import AssetDatapointQuerySchema
from ..schemas.datapoint_period import DatapointPeriodSchema
from ..schemas.value_datapoint_object import ValueDatapointObjectSchema

################################################################
# This file is auto-generated by the openapi_generator script. #
################################################################


class AssetDatapoint:
    __client: HttpClient

    def __init__(self, client: HttpClient):
        self.__client = client

    async def get_datapoint_export(self, headers: HeaderTypes | None = None) -> ResponseModel[Any]:
        """
        Retrieve a datapoint export of an asset attribute

        Possible responses:

          200 - default response
          {'application/zip': {}}

        """
        response = await self.__client.get(
            path='/asset/datapoint/export',
            headers=headers
        )

        response.raise_for_status()

        return ResponseModel(
            status_code=response.status_code,
            content=response.json(),
            response=response
        )

    async def get_datapoint_period(self, headers: HeaderTypes | None = None) -> ResponseModel[DatapointPeriodSchema]:
        """
        Retrieve a datapoint period of an asset attribute

        Possible responses:

          200 - default response
          {'application/json': {'schema': {'$ref': '#/components/schemas/DatapointPeriod'}}}

        """
        response = await self.__client.get(
            path='/asset/datapoint/periods',
            headers=headers
        )

        response.raise_for_status()

        return ResponseModel(
            status_code=response.status_code,
            content=DatapointPeriodSchema.model_construct(**response.json()),
            response=response
        )

    async def get_datapoints(self, asset_id: str, attribute_name: str, asset_datapoint_query_schema: AssetDatapointQuerySchema, headers: HeaderTypes | None = None) -> ResponseModel[list[ValueDatapointObjectSchema]]:
        """
        Retrieve the historical datapoints of an asset attribute

        Possible responses:

          200 - default response
          {'application/json': {'schema': {'type': 'array', 'items': {'$ref': '#/components/schemas/ValueDatapointObject'}}}}

        """
        response = await self.__client.post(
            path=f'/asset/datapoint/{asset_id}/{attribute_name}',
            json=asset_datapoint_query_schema.model_dump(),
            headers=headers
        )

        response.raise_for_status()

        return ResponseModel(
            status_code=response.status_code,
            content=[ValueDatapointObjectSchema.model_construct(**response) for response in response.json()],
            response=response
        )
