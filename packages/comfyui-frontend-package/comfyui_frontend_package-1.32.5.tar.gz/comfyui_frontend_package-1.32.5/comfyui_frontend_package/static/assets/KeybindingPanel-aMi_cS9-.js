var L=Object.defineProperty;var o=(v,d)=>L(v,"name",{value:d,configurable:!0});import{defineComponent as N,computed as S,openBlock as m,createElementBlock as g,Fragment as M,renderList as R,createVNode as n,unref as t,withCtx as l,createTextVNode as V,toDisplayString as w,createCommentVNode as A,ref as p,watchEffect as G,resolveDirective as J,createBlock as $,createElementVNode as K,withModifiers as Q,withDirectives as W}from"vue";import{F as X}from"./vendor-primevue-BTSUBtd4.js";import f from"primevue/button";import h from"primevue/column";import Y from"primevue/datatable";import Z from"primevue/dialog";import P from"primevue/inputtext";import ee from"primevue/message";import U from"primevue/tag";import{useToast as ie}from"primevue/usetoast";import{useI18n as te}from"vue-i18n";import{aT as ne,o as oe,n as le,cw as ae,cy as re,bS as se,bT as de,d as me}from"./index-BYfAAqfw.js";import{u as ue}from"./keybindingService-CNs8gfRc.js";import"@primevue/themes";import"@primevue/themes/aura";import"./vendor-other-ISwNJJIx.js";import"./vendor-vue-CEZOemkk.js";import"primevue/config";import"primevue/confirmationservice";import"primevue/toastservice";import"primevue/tooltip";import"primevue/checkbox";import"primevue/divider";import"primevue/scrollpanel";import"primevue/card";import"primevue/listbox";import"primevue/skeleton";import"primevue/multiselect";import"primevue/select";import"primevue/progressbar";import"primevue/floatlabel";import"@primevue/forms";import"@primevue/forms/resolvers/zod";import"primevue/password";import"primevue/progressspinner";import"primevue/inputnumber";import"primevue/tabpanels";import"primevue/tabs";import"primevue/iconfield";import"primevue/inputicon";import"primevue/badge";import"primevue/chip";import"primevue/tabpanel";import"primevue/toggleswitch";import"primevue/colorpicker";import"primevue/radiobutton";import"primevue/knob";import"primevue/slider";import"primevue/panel";import"primevue/tabmenu";import"primevue/popover";import"primevue/tab";import"primevue/tablist";import"primevue";import"./vendor-xterm-DV1MVhAx.js";import"primevue/galleria";import"primevue/contextmenu";import"primevue/tree";import"primevue/toolbar";import"primevue/selectbutton";import"primevue/confirmpopup";import"primevue/useconfirm";import"primevue/confirmdialog";import"primevue/autocomplete";import"primevue/dropdown";import"./vendor-tiptap-BnS5itOe.js";import"primevue/blockui";const pe={key:0,class:"px-2"},ce=N({__name:"KeyComboDisplay",props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(v){const d=S(()=>v.keyCombo.getKeySequences());return(a,c)=>(m(),g("span",null,[(m(!0),g(M,null,R(d.value,(C,k)=>(m(),g(M,{key:k},[n(t(U),{severity:a.isModified?"info":"secondary"},{default:l(()=>[V(w(C),1)]),_:2},1032,["severity"]),k<d.value.length-1?(m(),g("span",pe,"+")):A("",!0)],64))),128))]))}}),be={class:"actions invisible flex flex-row"},ye=["title"],fe={key:1},ge={class:"overflow-hidden text-ellipsis"},ve=N({__name:"KeybindingPanel",setup(v){const d=p({global:{value:"",matchMode:X.CONTAINS}}),a=ne(),c=ue(),C=oe(),{t:k}=te(),D=S(()=>Object.values(C.commands).map(e=>({id:e.id,label:k(`commands.${le(e.id)}.label`,e.label??""),keybinding:a.getKeybindingByCommandId(e.id),source:e.source}))),x=p(null),b=p(!1),s=p(null),u=p(null),I=p(null),y=S(()=>!u.value||u.value.keybinding?.combo?.equals(s.value)||!s.value?null:a.getKeybinding(s.value));function T(e){u.value=e,s.value=e.keybinding?e.keybinding.combo:null,b.value=!0}o(T,"editKeybinding"),G(()=>{b.value&&setTimeout(()=>{I.value?.$el?.focus()},300)});async function F(e){e.keybinding&&(a.unsetKeybinding(e.keybinding),await c.persistUserKeybindings())}o(F,"removeKeybinding");async function O(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case"Escape":_();return;case"Enter":await B();return}const r=se.fromEvent(e);s.value=r}o(O,"captureKeybinding");function _(){b.value=!1,u.value=null,s.value=null}o(_,"cancelEdit");async function B(){u.value&&s.value&&a.updateKeybindingOnCommand(new de({commandId:u.value.id,combo:s.value}))&&await c.persistUserKeybindings(),_()}o(B,"saveKeybinding");async function q(e){a.resetKeybindingForCommand(e.id)?await c.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}o(q,"resetKeybinding");const j=ie();async function z(){a.resetAllKeybindings(),await c.persistUserKeybindings(),j.add({severity:"info",summary:"Info",detail:"All keybindings reset",life:3e3})}return o(z,"resetAllKeybindings"),(e,r)=>{const H=J("tooltip");return m(),$(ae,{value:"Keybinding",class:"keybinding-panel"},{header:l(()=>[n(re,{modelValue:d.value.global.value,"onUpdate:modelValue":r[0]||(r[0]=i=>d.value.global.value=i),placeholder:e.$t("g.searchKeybindings")+"..."},null,8,["modelValue","placeholder"])]),default:l(()=>[n(t(Y),{selection:x.value,"onUpdate:selection":r[1]||(r[1]=i=>x.value=i),value:D.value,"global-filter-fields":["id","label"],filters:d.value,"selection-mode":"single","striped-rows":"",pt:{header:"px-0"},onRowDblclick:r[2]||(r[2]=i=>T(i.data))},{default:l(()=>[n(t(h),{field:"actions",header:""},{body:l(i=>[K("div",be,[n(t(f),{icon:"pi pi-pencil",class:"p-button-text",onClick:o(E=>T(i.data),"onClick")},null,8,["onClick"]),n(t(f),{icon:"pi pi-replay",class:"p-button-text p-button-warn",disabled:!t(a).isCommandKeybindingModified(i.data.id),onClick:o(E=>q(i.data),"onClick")},null,8,["disabled","onClick"]),n(t(f),{icon:"pi pi-trash",class:"p-button-text p-button-danger",disabled:!i.data.keybinding,onClick:o(E=>F(i.data),"onClick")},null,8,["disabled","onClick"])])]),_:1}),n(t(h),{field:"id",header:e.$t("g.command"),sortable:"",class:"max-w-64 2xl:max-w-full"},{body:l(i=>[K("div",{class:"truncate",title:i.data.id},w(i.data.label),9,ye)]),_:1},8,["header"]),n(t(h),{field:"keybinding",header:e.$t("g.keybinding")},{body:l(i=>[i.data.keybinding?(m(),$(ce,{key:0,"key-combo":i.data.keybinding.combo,"is-modified":t(a).isCommandKeybindingModified(i.data.id)},null,8,["key-combo","is-modified"])):(m(),g("span",fe,"-"))]),_:1},8,["header"]),n(t(h),{field:"source",header:e.$t("g.source")},{body:l(i=>[K("span",ge,w(i.data.source||"-"),1)]),_:1},8,["header"])]),_:1},8,["selection","value","filters"]),n(t(Z),{visible:b.value,"onUpdate:visible":r[3]||(r[3]=i=>b.value=i),class:"min-w-96",modal:"",header:u.value?.label,onHide:_},{footer:l(()=>[n(t(f),{label:y.value?"Overwrite":"Save",icon:y.value?"pi pi-pencil":"pi pi-check",severity:y.value?"warn":void 0,autofocus:"",onClick:B},null,8,["label","icon","severity"])]),default:l(()=>[K("div",null,[n(t(P),{ref_key:"keybindingInput",ref:I,class:"mb-2 text-center","model-value":s.value?.toString()??"",placeholder:e.$t("g.pressKeysForNewBinding"),autocomplete:"off",fluid:"",onKeydown:Q(O,["stop","prevent"])},null,8,["model-value","placeholder"]),y.value?(m(),$(t(ee),{key:0,severity:"warn"},{default:l(()=>[V(w(e.$t("g.keybindingAlreadyExists"))+" ",1),n(t(U),{severity:"secondary",value:y.value.commandId},null,8,["value"])]),_:1})):A("",!0)])]),_:1},8,["visible","header"]),W(n(t(f),{class:"mt-4",label:e.$t("g.resetAll"),icon:"pi pi-replay",severity:"danger",fluid:"",text:"",onClick:z},null,8,["label"]),[[H,e.$t("g.resetAllKeybindingsTooltip")]])]),_:1})}}}),Ni=me(ve,[["__scopeId","data-v-04308f44"]]);export{Ni as default};
//# sourceMappingURL=KeybindingPanel-aMi_cS9-.js.map
