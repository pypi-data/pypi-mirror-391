{"version":3,"file":"WidgetInputNumber-DNmIzExt.js","sources":["../../src/renderer/extensions/vueNodes/widgets/composables/useNumberWidgetButtonPt.ts","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberInput.vue","../../src/components/ui/slider/Slider.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumberSlider.vue","../../src/renderer/extensions/vueNodes/widgets/components/WidgetInputNumber.vue"],"sourcesContent":["const sharedButtonClasses =\n  '!inline-flex !items-center !justify-center !border-0 bg-transparent text-inherit transition-colors duration-150 ease-in-out ' +\n  'hover:bg-node-component-surface-hovered active:bg-node-component-surface-selected' +\n  'disabled:bg-node-component-disabled disabled:text-node-icon-disabled disabled:cursor-not-allowed'\n\nexport function useNumberWidgetButtonPt(options?: {\n  roundedLeft?: boolean\n  roundedRight?: boolean\n}) {\n  const { roundedLeft = false, roundedRight = false } = options ?? {}\n\n  const increment = `${sharedButtonClasses}${roundedRight ? ' !rounded-r-lg' : ''}`\n  const decrement = `${sharedButtonClasses}${roundedLeft ? ' !rounded-l-lg' : ''}`\n\n  return {\n    incrementButton: {\n      class: increment.trim()\n    },\n    decrementButton: {\n      class: decrement.trim()\n    }\n  }\n}\n","<script setup lang=\"ts\">\nimport InputNumber from 'primevue/inputnumber'\nimport { computed } from 'vue'\n\nimport { useNumberWidgetValue } from '@/composables/graph/useWidgetValue'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  INPUT_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { useNumberWidgetButtonPt } from '../composables/useNumberWidgetButtonPt'\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<number>\n  modelValue: number\n}>()\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: number]\n}>()\n\nconst { localValue, onChange } = useNumberWidgetValue(\n  props.widget,\n  props.modelValue,\n  emit\n)\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(props.widget.options, INPUT_EXCLUDED_PROPS)\n)\n\n// Get the precision value for proper number formatting\nconst precision = computed(() => {\n  const p = props.widget.options?.precision\n  // Treat negative or non-numeric precision as undefined\n  return typeof p === 'number' && p >= 0 ? p : undefined\n})\n\n// Calculate the step value based on precision or widget options\nconst stepValue = computed(() => {\n  // Use step2 (correct input spec value) instead of step (legacy 10x value)\n  if (props.widget.options?.step2 !== undefined) {\n    return Number(props.widget.options.step2)\n  }\n  // Otherwise, derive from precision\n  if (precision.value !== undefined) {\n    if (precision.value === 0) {\n      return 1\n    }\n    // For precision > 0, step = 1 / (10^precision)\n    // precision 1 → 0.1, precision 2 → 0.01, etc.\n    return Number((1 / Math.pow(10, precision.value)).toFixed(precision.value))\n  }\n  // Default to 'any' for unrestricted stepping\n  return 0\n})\n\n// Disable grouping separators by default unless explicitly enabled by the node author\nconst useGrouping = computed(() => {\n  return props.widget.options?.useGrouping === true\n})\n\n// Check if increment/decrement buttons should be disabled due to precision limits\nconst buttonsDisabled = computed(() => {\n  const currentValue = localValue.value ?? 0\n  return (\n    !Number.isFinite(currentValue) ||\n    Math.abs(currentValue) > Number.MAX_SAFE_INTEGER\n  )\n})\n\nconst buttonTooltip = computed(() => {\n  if (buttonsDisabled.value) {\n    return 'Increment/decrement disabled: value exceeds JavaScript precision limit (±2^53)'\n  }\n  return null\n})\n\nconst inputNumberPt = useNumberWidgetButtonPt({\n  roundedLeft: true,\n  roundedRight: true\n})\n</script>\n\n<template>\n  <WidgetLayoutField :widget>\n    <div v-tooltip=\"buttonTooltip\">\n      <InputNumber\n        v-model=\"localValue\"\n        v-bind=\"filteredProps\"\n        button-layout=\"horizontal\"\n        size=\"small\"\n        :step=\"stepValue\"\n        :use-grouping=\"useGrouping\"\n        :class=\"cn(WidgetInputBaseClass, 'w-full text-xs')\"\n        :aria-label=\"widget.name\"\n        :show-buttons=\"!buttonsDisabled\"\n        :pt=\"inputNumberPt\"\n        @update:model-value=\"onChange\"\n      >\n        <template #incrementicon>\n          <span\n            class=\"pi pi-plus text-sm text-component-node-foreground-secondary\"\n          />\n        </template>\n        <template #decrementicon>\n          <span\n            class=\"pi pi-minus text-sm text-component-node-foreground-secondary\"\n          />\n        </template>\n      </InputNumber>\n    </div>\n  </WidgetLayoutField>\n</template>\n\n<style scoped>\n:deep(.p-inputnumber-input) {\n  background-color: transparent;\n  border: 1px solid var(--component-node-border);\n  border-top: transparent;\n  border-bottom: transparent;\n  height: 1.625rem;\n  margin: 1px 0;\n  box-shadow: none;\n}\n\n:deep(.p-inputnumber-button.p-disabled .pi),\n:deep(.p-inputnumber-button.p-disabled .p-icon) {\n  color: var(--color-node-icon-disabled) !important;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { reactiveOmit } from '@vueuse/core'\nimport type { SliderRootEmits, SliderRootProps } from 'reka-ui'\nimport {\n  SliderRange,\n  SliderRoot,\n  SliderThumb,\n  SliderTrack,\n  useForwardPropsEmits\n} from 'reka-ui'\nimport { ref } from 'vue'\nimport type { HTMLAttributes } from 'vue'\n\nimport { cn } from '@/utils/tailwindUtil'\n\nconst props = defineProps<\n  SliderRootProps & { class?: HTMLAttributes['class'] }\n>()\n\nconst pressed = ref(false)\nconst setPressed = (val: boolean) => {\n  pressed.value = val\n}\n\nconst emits = defineEmits<SliderRootEmits>()\n\nconst delegatedProps = reactiveOmit(props, 'class')\n\nconst forwarded = useForwardPropsEmits(delegatedProps, emits)\n</script>\n\n<template>\n  <SliderRoot\n    v-slot=\"{ modelValue }\"\n    data-slot=\"slider\"\n    :class=\"\n      cn(\n        'relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50',\n        'data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col',\n        props.class\n      )\n    \"\n    v-bind=\"forwarded\"\n    @slide-start=\"() => setPressed(true)\"\n    @slide-move=\"() => setPressed(true)\"\n    @slide-end=\"() => setPressed(false)\"\n  >\n    <SliderTrack\n      data-slot=\"slider-track\"\n      :class=\"\n        cn(\n          'bg-node-stroke relative grow overflow-hidden rounded-full',\n          'cursor-pointer overflow-visible',\n          `before:absolute before:-inset-2 before:block before:bg-transparent`,\n          'data-[orientation=horizontal]:h-0.5 data-[orientation=horizontal]:w-full',\n          'data-[orientation=vertical]:h-full data-[orientation=vertical]:w-0.5'\n        )\n      \"\n    >\n      <SliderRange\n        data-slot=\"slider-range\"\n        class=\"absolute bg-node-component-surface-highlight data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full\"\n      />\n    </SliderTrack>\n\n    <SliderThumb\n      v-for=\"(_, key) in modelValue\"\n      :key=\"key\"\n      data-slot=\"slider-thumb\"\n      :class=\"\n        cn(\n          'bg-node-component-surface-highlight ring-node-component-surface-selected block size-3.5 shrink-0 rounded-full shadow-sm transition-[color,box-shadow]',\n          'cursor-grab',\n          'before:absolute before:-inset-1 before:block before:bg-transparent before:rounded-full',\n          'hover:ring-2 focus-visible:ring-2 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50',\n          { 'cursor-grabbing': pressed }\n        )\n      \"\n    />\n  </SliderRoot>\n</template>\n","<template>\n  <WidgetLayoutField :widget=\"widget\">\n    <div\n      :class=\"\n        cn(WidgetInputBaseClass, 'flex items-center gap-2 w-full pl-4 pr-2')\n      \"\n    >\n      <Slider\n        :model-value=\"[localValue]\"\n        v-bind=\"filteredProps\"\n        class=\"flex-grow text-xs\"\n        :step=\"stepValue\"\n        :aria-label=\"widget.name\"\n        @update:model-value=\"updateLocalValue\"\n      />\n      <InputNumber\n        :key=\"timesEmptied\"\n        :model-value=\"localValue\"\n        v-bind=\"filteredProps\"\n        :step=\"stepValue\"\n        :min-fraction-digits=\"precision\"\n        :max-fraction-digits=\"precision\"\n        :aria-label=\"widget.name\"\n        size=\"small\"\n        pt:pc-input-text:root=\"min-w-full bg-transparent border-none text-center\"\n        class=\"w-16\"\n        :show-buttons=\"!buttonsDisabled\"\n        :pt=\"sliderNumberPt\"\n        @update:model-value=\"handleNumberInputUpdate\"\n      />\n    </div>\n  </WidgetLayoutField>\n</template>\n\n<script setup lang=\"ts\">\nimport InputNumber from 'primevue/inputnumber'\nimport { computed, ref } from 'vue'\n\nimport Slider from '@/components/ui/slider/Slider.vue'\nimport { useNumberWidgetValue } from '@/composables/graph/useWidgetValue'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  STANDARD_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { useNumberWidgetButtonPt } from '../composables/useNumberWidgetButtonPt'\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst { widget, modelValue } = defineProps<{\n  widget: SimplifiedWidget<number>\n  modelValue: number\n}>()\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: number]\n}>()\n\n// Use the composable for consistent widget value handling\nconst { localValue, onChange } = useNumberWidgetValue(widget, modelValue, emit)\n\nconst timesEmptied = ref(0)\n\nconst updateLocalValue = (newValue: number[] | undefined): void => {\n  onChange(newValue ?? [localValue.value])\n}\n\nconst handleNumberInputUpdate = (newValue: number | undefined) => {\n  if (newValue) {\n    updateLocalValue([newValue])\n    return\n  }\n  timesEmptied.value += 1\n}\n\nconst filteredProps = computed(() =>\n  filterWidgetProps(widget.options, STANDARD_EXCLUDED_PROPS)\n)\n\n// Get the precision value for proper number formatting\nconst precision = computed(() => {\n  const p = widget.options?.precision\n  // Treat negative or non-numeric precision as undefined\n  return typeof p === 'number' && p >= 0 ? p : undefined\n})\n\n// Calculate the step value based on precision or widget options\nconst stepValue = computed(() => {\n  // Use step2 (correct input spec value) instead of step (legacy 10x value)\n  if (widget.options?.step2 !== undefined) {\n    return widget.options.step2\n  }\n\n  // Otherwise, derive from precision\n  if (precision.value === undefined) {\n    return undefined\n  }\n\n  if (precision.value === 0) {\n    return 1\n  }\n\n  // For precision > 0, step = 1 / (10^precision)\n  // precision 1 → 0.1, precision 2 → 0.01, etc.\n  return 1 / Math.pow(10, precision.value)\n})\n\nconst buttonsDisabled = computed(() => {\n  const currentValue = localValue.value ?? 0\n  return (\n    !Number.isFinite(currentValue) ||\n    Math.abs(currentValue) > Number.MAX_SAFE_INTEGER\n  )\n})\n\nconst sliderNumberPt = useNumberWidgetButtonPt({\n  roundedLeft: true,\n  roundedRight: true\n})\n</script>\n\n<style scoped>\n:deep(.p-inputnumber-button.p-disabled .pi),\n:deep(.p-inputnumber-button.p-disabled .p-icon) {\n  color: var(--color-node-icon-disabled) !important;\n}\n</style>\n","<script setup lang=\"ts\">\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\n\nimport WidgetInputNumberInput from './WidgetInputNumberInput.vue'\nimport WidgetInputNumberSlider from './WidgetInputNumberSlider.vue'\n\ndefineProps<{\n  widget: SimplifiedWidget<number>\n}>()\n\nconst modelValue = defineModel<number>({ default: 0 })\n</script>\n\n<template>\n  <component\n    :is=\"\n      widget.type === 'slider'\n        ? WidgetInputNumberSlider\n        : WidgetInputNumberInput\n    \"\n    v-model=\"modelValue\"\n    :widget=\"widget\"\n    v-bind=\"$attrs\"\n  />\n</template>\n"],"names":["sharedButtonClasses","useNumberWidgetButtonPt","options","roundedLeft","roundedRight","increment","decrement","__name","props","__props","emit","__emit","localValue","onChange","useNumberWidgetValue","filteredProps","computed","filterWidgetProps","INPUT_EXCLUDED_PROPS","precision","p","stepValue","useGrouping","buttonsDisabled","currentValue","buttonTooltip","inputNumberPt","pressed","ref","setPressed","val","emits","delegatedProps","reactiveOmit","forwarded","useForwardPropsEmits","timesEmptied","updateLocalValue","newValue","handleNumberInputUpdate","STANDARD_EXCLUDED_PROPS","sliderNumberPt","modelValue","_useModel"],"mappings":"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"}